import{j as e}from"./vendor-ui-B2jkoGl9.js";import{h as as,g as ls,H as Me,U as Se,T as $e,j as De,k as ve,L as G,l as ne,f as rs,m as Ee,n as he,o as Ce,N as ns,p as oe,P as ze,q as is,b as qe,r as os,s as Be,t as Ne,X as ce,u as cs,a as Ge,v as de,w as ds,x as Le,y as xs,S as ms,z as us,B as hs,D as ps,R as He,E as fs,G as gs,I as ke,J as bs,K as js,O as Ve,Q as Ns,V as ys}from"./vendor-other-Cih5bfBj.js";import{a}from"./vendor-react-Cc-oBOCu.js";import{a as Z,s as Fe,t as f,b as $}from"./index-CWsgMgZf.js";import"./vendor-recharts-LMBWezzC.js";const vs=[{id:"home",label:"Home",icon:Me},{id:"find",label:"Find",icon:Se},{id:"request",label:"Request",icon:De},{id:"join",label:"Join",icon:ve}],ws=[{id:"home",label:"Home",icon:Me},{id:"find",label:"Find",icon:Se},{id:"bookings",label:"Reserved",icon:$e},{id:"request",label:"Request",icon:De}],ks=[{id:"dashboard",label:"Dashboard",icon:as},{id:"settings",label:"Settings",icon:ls}];function Ss({activeView:s,onViewChange:l,userRole:t="seeker",user:o=null}){let c;return t==="provider"?c=ks:o?c=ws:c=vs,e.jsxs(e.Fragment,{children:[e.jsx("nav",{className:"fixed bottom-0 z-50 flex w-full items-center justify-around border-t border-slate-100 bg-white px-4 py-3 pb-6 shadow-[0_-4px_20px_rgba(0,0,0,0.05)] sm:hidden",children:c.map(d=>e.jsxs("button",{onClick:()=>l(d.id),className:`flex flex-col items-center gap-1 rounded-xl px-3 py-2 transition-all ${s===d.id?"text-emerald-600":"text-slate-400 hover:text-slate-600"}`,"aria-label":d.label,children:[e.jsx(d.icon,{size:20}),e.jsx("span",{className:"text-[10px] font-bold",children:d.label})]},d.id))}),e.jsx("div",{className:"fixed bottom-6 left-1/2 z-50 hidden -translate-x-1/2 sm:block",children:e.jsx("div",{className:"flex gap-1 rounded-2xl border border-slate-200 bg-white p-1.5 shadow-xl shadow-slate-200/50",children:c.map(d=>e.jsx("button",{onClick:()=>l(d.id),className:`rounded-xl px-6 py-2.5 text-[10px] font-black tracking-wider uppercase transition-all ${s===d.id?"bg-emerald-600 text-white":"text-slate-500 hover:text-emerald-600"}`,children:d.label},d.id))})})]})}function Cs({user:s,onLogout:l,onJoinClick:t,address:o,isLocating:c,onRequestLocation:d}){return e.jsx("nav",{className:"sticky top-0 z-50 w-full border-b border-slate-100/50 bg-white/70 px-4 py-3 backdrop-blur-xl sm:px-6 sm:py-4",children:e.jsxs("div",{className:"mx-auto flex max-w-6xl items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center overflow-hidden rounded-xl bg-emerald-50 shadow-lg shadow-emerald-100 sm:h-10 sm:w-10 sm:rounded-2xl",children:e.jsx("img",{src:"/icon.svg",alt:"Ramzania",className:"h-7 w-7 sm:h-8 sm:w-8"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-lg leading-none font-black tracking-tighter sm:text-xl",children:["RAMZAN",e.jsx("span",{className:"text-emerald-600",children:"IA"})]}),e.jsx("button",{onClick:d,className:"mt-0.5 flex items-center gap-1 text-[9px] font-bold tracking-wide text-slate-400 transition-colors hover:text-emerald-600",children:c?e.jsxs(e.Fragment,{children:[e.jsx(G,{size:8,className:"animate-spin"}),e.jsx("span",{children:"Locating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{size:8}),e.jsx("span",{className:"max-w-[120px] truncate sm:max-w-[180px]",children:(o==null?void 0:o.city)||(o==null?void 0:o.area)||"Set Location"})]})})]})]}),e.jsx("div",{className:"flex items-center gap-3 sm:gap-4",children:s?e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsxs("div",{className:"hidden text-right sm:block",children:[e.jsx("p",{className:"text-xs font-black text-slate-900",children:s.name}),e.jsx("p",{className:"text-[10px] font-bold text-emerald-600 uppercase",children:s.role==="provider"?"HOST":"GUEST"})]}),e.jsx("button",{onClick:l,className:"flex h-9 w-9 items-center justify-center rounded-xl border border-slate-200 bg-slate-50 text-slate-400 transition-all hover:text-red-500 sm:h-10 sm:w-10 sm:rounded-2xl","aria-label":"Logout",children:e.jsx(rs,{size:16,className:"sm:h-[18px] sm:w-[18px]"})})]}):e.jsxs("button",{onClick:t,className:"flex items-center justify-center gap-1.5 rounded-xl bg-emerald-600 px-4 py-2 text-xs font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-95 sm:gap-2 sm:rounded-2xl sm:px-5 sm:text-sm",children:[e.jsx(Ee,{size:14,className:"sm:h-4 sm:w-4"}),"Join"]})})]})})}function zs({point:s,onBook:l,compact:t=!1}){if(!s)return null;const o=d=>{const u=["th","st","nd","rd"],i=d%100;return d+(u[(i-20)%10]||u[i]||u[0])},c=s.phone?String(s.phone).replace(/\D/g,""):"";return e.jsxs("div",{className:`group relative flex flex-col overflow-hidden border border-slate-100 bg-white shadow-sm transition-all duration-500 hover:shadow-xl hover:shadow-slate-200/40 ${t?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsx("div",{className:"absolute top-0 left-0 h-1.5 w-full bg-emerald-500"}),e.jsxs("div",{className:`flex items-start justify-between ${t?"mb-3":"mb-5"}`,children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("h3",{className:`leading-tight font-black tracking-tight text-slate-950 ${t?"text-base":"text-xl"}`,children:s.name||"Unknown Point"}),e.jsx("div",{className:"mt-1.5 flex flex-wrap items-center gap-2",children:s.hasOfferings===!1?e.jsx("span",{className:"rounded-full border border-amber-100 bg-amber-50 px-2 py-0.5 text-[9px] font-black tracking-wider text-amber-600 uppercase",children:"Registered Host"}):e.jsxs(e.Fragment,{children:[s.next_available_day&&e.jsxs("span",{className:"rounded-full border border-emerald-100 bg-emerald-50 px-2 py-0.5 text-[9px] font-black tracking-wider text-emerald-600 uppercase",children:[o(s.next_available_day)," Ramzan"]}),s.next_available_date&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-bold text-slate-400",children:[e.jsx(he,{size:12,className:"text-slate-300"}),s.next_available_date]})]})})]}),e.jsx("div",{className:"flex shrink-0 flex-col items-end gap-1",children:e.jsx("span",{className:`rounded-xl font-black tracking-widest uppercase ${t?"px-2 py-0.5 text-[8px]":"px-3 py-1 text-[10px]"} ${s.price===0?"bg-emerald-500 text-white shadow-lg shadow-emerald-100":"bg-slate-900 text-white"}`,children:s.price===0?"Free":`â‚¹${s.price}`})})]}),e.jsxs("div",{className:`flex-1 border border-slate-100 bg-slate-50/50 text-slate-600 ${t?"mb-4 rounded-xl p-3 text-xs leading-relaxed":"mb-6 rounded-2xl p-4 text-sm leading-relaxed"}`,children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[e.jsx(Ce,{size:14,className:"text-emerald-500"}),s.hasOfferings===!1?e.jsx("span",{className:"text-slate-400 italic",children:"This host hasn't added offerings yet"}):s.menu_items?e.jsx("div",{className:"leading-snug font-bold text-slate-800",children:typeof s.menu_items=="string"?s.menu_items:JSON.stringify(s.menu_items)}):e.jsx("span",{className:"text-slate-400 italic",children:"Menu details available on booking"})]}),s.message&&e.jsxs("p",{className:"mt-2 border-t border-slate-100 pt-2 text-[11px] leading-relaxed font-medium text-slate-500 italic",children:['"',s.message,'"']})]}),e.jsxs("div",{className:"mb-5 flex flex-wrap items-center gap-2",children:[s.distance!==null&&s.distance!==void 0&&e.jsxs("span",{className:"flex items-center gap-1 rounded-lg border border-emerald-100 bg-emerald-50 px-2 py-1 text-[10px] font-black text-emerald-600",children:[e.jsx(ns,{size:10,fill:"currentColor"})," ",s.distance," KM"]}),s.area&&e.jsxs("span",{className:"flex items-center gap-1 rounded-lg bg-slate-100 px-2 py-1 text-[10px] font-black text-slate-500",children:[e.jsx(ne,{size:10})," ",s.area]}),s.hasOfferings===!1?e.jsxs("span",{className:"flex items-center gap-1 rounded-lg border border-amber-100 bg-amber-50 px-2 py-1 text-[10px] font-black text-amber-600",children:[e.jsx(oe,{size:10})," COMING SOON"]}):s.total_offerings?e.jsxs("span",{className:"flex items-center gap-1 rounded-lg border border-emerald-100 bg-emerald-50 px-2 py-1 text-[10px] font-black text-emerald-600",children:[e.jsx(oe,{size:10})," ",s.total_offerings," DAYS"]}):null]}),e.jsxs("div",{className:"space-y-2.5",children:[e.jsxs("div",{className:`grid gap-2 ${s.latitude&&s.longitude?"grid-cols-3":"grid-cols-2"}`,children:[e.jsxs("button",{onClick:()=>window.open(`tel:${s.phone}`),className:"flex flex-col items-center justify-center gap-1 rounded-2xl border border-slate-100 bg-white py-3 transition-all hover:bg-slate-50 active:scale-95",children:[e.jsx(ze,{size:18,className:"text-slate-400"}),e.jsx("span",{className:"text-[10px] font-black text-slate-600 uppercase",children:"Call"})]}),e.jsxs("button",{onClick:()=>window.open(`https://wa.me/${c}`),className:"flex flex-col items-center justify-center gap-1 rounded-2xl border border-emerald-100 bg-emerald-50/30 py-3 transition-all hover:bg-emerald-50 active:scale-95",children:[e.jsx(is,{size:18,className:"text-emerald-600"}),e.jsx("span",{className:"text-[10px] font-black text-emerald-600 uppercase",children:"Chat"})]}),s.latitude&&s.longitude&&e.jsxs("button",{onClick:()=>window.open(`https://www.google.com/maps/dir/?api=1&destination=${s.latitude},${s.longitude}`),className:"flex flex-col items-center justify-center gap-1 rounded-2xl border border-slate-100 bg-white py-3 transition-all hover:bg-slate-50 active:scale-95",children:[e.jsx(ne,{size:18,className:"text-slate-400"}),e.jsx("span",{className:"text-[10px] font-black text-slate-600 uppercase",children:"Map"})]})]}),e.jsxs("button",{onClick:()=>l&&l(s),disabled:!s.isBookable,className:"group/btn relative flex w-full items-center justify-center gap-2 overflow-hidden rounded-2xl bg-emerald-600 py-4 font-black text-white shadow-xl shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:bg-emerald-200 disabled:opacity-50 disabled:shadow-none",children:[e.jsx("span",{className:"relative z-10 text-xs tracking-widest uppercase",children:s.isBookable?"Reserve My Spot":s.hasOfferings===!1?"No Offerings Yet":"Info Only"}),s.isBookable&&e.jsx(qe,{size:16,className:"relative z-10 transition-transform group-hover/btn:translate-x-1"}),e.jsx("div",{className:"group-hover:animate-shine absolute -inset-full top-0 z-0 block h-full w-1/2 -skew-x-12 transform bg-gradient-to-r from-transparent to-white/10 opacity-40"})]})]})]})}function _s({time:s,compact:l=!1}){return e.jsxs("div",{className:`group relative overflow-hidden border-none bg-emerald-600 text-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-emerald-200/40 ${l?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsx(os,{size:l?60:100,className:"absolute -top-4 -right-4 text-emerald-500/30 transition-transform duration-500 group-hover:scale-110"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("span",{className:`block font-black tracking-wider text-emerald-200 uppercase ${l?"mb-1 text-[8px]":"mb-8 text-[10px]"}`,children:"Imsak (Sehar)"}),e.jsx("h4",{className:`font-black tracking-tight ${l?"text-3xl":"text-5xl"}`,children:s}),!l&&e.jsx("p",{className:"mt-1 text-sm font-medium text-emerald-100/80",children:"Stop eating and intend to fast."})]})]})}function Rs({time:s,compact:l=!1}){return e.jsxs("div",{className:`group relative overflow-hidden border-none bg-slate-950 text-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-slate-200/40 ${l?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsx(Be,{size:l?60:100,className:"absolute -top-4 -right-4 text-slate-800/50 transition-transform duration-500 group-hover:rotate-12"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("span",{className:`block font-black tracking-wider text-slate-400 uppercase ${l?"mb-1 text-[8px]":"mb-8 text-[10px]"}`,children:"Maghrib (Iftar)"}),e.jsx("h4",{className:`font-black tracking-tight ${l?"text-3xl":"text-5xl"}`,children:s}),!l&&e.jsx("p",{className:"mt-1 text-sm font-medium text-slate-400/80",children:"Break your fast with the sun's set."})]})]})}function As({timings:s,compact:l=!1}){return e.jsxs("div",{className:`grid grid-cols-2 ${l?"gap-3":"gap-4"}`,children:[e.jsx(_s,{time:s.sehar,compact:l}),e.jsx(Rs,{time:s.iftar,compact:l})]})}async function Ps(s,l){try{const o=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${l}&zoom=18&addressdetails=1`,{headers:{"Accept-Language":"en"}})).json();if(o!=null&&o.address){const{road:c,suburb:d,neighbourhood:u,city:i,town:y,village:j,state_district:n,state:b,postcode:h,county:v}=o.address;return{street:c||"",area:d||u||v||"",city:i||y||j||n||"",pincode:h||"",state:b||""}}return null}catch(t){return console.error("Reverse geocoding failed:",t),null}}function Fs({onClose:s,onSuccess:l}){const[t,o]=a.useState("CHOICE"),[c,d]=a.useState(!1),[u,i]=a.useState(""),[y,j]=a.useState(""),[n,b]=a.useState(""),[h,v]=a.useState("seeker"),[F,w]=a.useState(""),[k,_]=a.useState(""),[p,m]=a.useState(""),[x,C]=a.useState(""),[A,D]=a.useState(""),[O,q]=a.useState(""),[L,H]=a.useState(""),[V,se]=a.useState(""),[te,ae]=a.useState(""),[z,U]=a.useState(null),[K,Q]=a.useState(null),[r,P]=a.useState(!1),[I,le]=a.useState(""),[X,be]=a.useState(""),[pe,J]=a.useState(""),[R,E]=a.useState(""),[M,B]=a.useState(["","","","","",""]),[Y,je]=a.useState(""),_e=a.useRef([]),Te=a.useCallback(async()=>{if(navigator.geolocation){P(!0);try{const g=await new Promise((W,ts)=>{navigator.geolocation.getCurrentPosition(W,ts,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),{latitude:N,longitude:S}=g.coords;U(N),Q(S);const T=await Ps(N,S);T&&(q(T.street),H(T.area),se(T.city),ae(T.pincode))}catch(g){console.log("Location fetch failed:",g.message)}finally{P(!1)}}},[]);a.useEffect(()=>{t==="REGISTER"&&Te()},[t,Te]);const Ye=(g,N)=>{var W;const S=g.target.value;if(isNaN(S))return;const T=[...M];T[N]=S.slice(-1),B(T),S&&N<5&&((W=_e.current[N+1])==null||W.focus())},We=(g,N)=>{var S;g.key==="Backspace"&&!M[N]&&N>0&&((S=_e.current[N-1])==null||S.focus())},Ke=async g=>{var N,S;g.preventDefault(),i(""),d(!0);try{const T=await Z.login({email:y,password:n});if(T.success)T.token&&Fe.set("auth_token",T.token),f.success("Welcome back!",{description:`Logged in as ${T.user.name}`}),l(T.user);else{const W=T.message||"Login failed";i(W),f.error("Login Failed",{description:W})}}catch(T){const W=T.message||((S=(N=T.errors)==null?void 0:N.email)==null?void 0:S[0])||"Login failed. Please try again.";i(W),f.error("Login Failed",{description:W})}finally{d(!1)}},Xe=async g=>{var N,S;if(g.preventDefault(),i(""),k.length<6){i("Password must be at least 6 characters"),f.error("Validation Error",{description:"Password must be at least 6 characters"});return}d(!0);try{const T=await Z.register({email:F,password:k,name:p,contact:x,role:h,place_name:h==="provider"?A:null,street:O,area:L,city:V,pincode:te,latitude:z,longitude:K});if(T.success)f.success("OTP Sent!",{description:"Please check your email for the verification code"}),je("register"),B(["","","","","",""]),o("OTP");else{const W=T.message||"Registration failed";i(W),f.error("Registration Failed",{description:W})}}catch(T){const W=T.message||((S=(N=T.errors)==null?void 0:N.email)==null?void 0:S[0])||"Registration failed. Please try again.";i(W),f.error("Registration Failed",{description:W})}finally{d(!1)}},Je=async g=>{if(g.preventDefault(),i(""),!I){i("Please enter your email"),f.error("Email Required",{description:"Please enter your registered email address"});return}d(!0);try{const N=await Z.forgotPassword(I);if(N.success)f.success("OTP Sent!",{description:"Please check your email for the reset code"}),je("forgot"),B(["","","","","",""]),o("OTP");else{const S=N.message||"Failed to send OTP";i(S),f.error("Failed",{description:S})}}catch(N){const S=N.message||"Failed to send OTP. Please try again.";i(S),f.error("Failed",{description:S})}finally{d(!1)}},Ze=async()=>{const g=M.join("");if(!(g.length<6)){i(""),d(!0);try{if(Y==="register"){const N=await Z.verifyRegistrationOtp(F,g);if(N.success)N.token&&Fe.set("auth_token",N.token),f.success("Account Verified!",{description:"Welcome to Ramzania!"}),l(N.user);else{const S=N.message||"Invalid OTP";i(S),f.error("Verification Failed",{description:S})}}else if(Y==="forgot"){const N=await Z.verifyForgotPasswordOtp(I,g);if(N.success)f.success("OTP Verified!",{description:"Now set your new password"}),E(N.reset_token),o("RESET_PASSWORD");else{const S=N.message||"Invalid OTP";i(S),f.error("Verification Failed",{description:S})}}}catch(N){const S=N.message||"OTP verification failed. Please try again.";i(S),f.error("Verification Failed",{description:S})}finally{d(!1)}}},Qe=async g=>{if(g.preventDefault(),i(""),X.length<6){i("Password must be at least 6 characters"),f.error("Validation Error",{description:"Password must be at least 6 characters"});return}if(X!==pe){i("Passwords do not match"),f.error("Validation Error",{description:"Passwords do not match"});return}d(!0);try{const N=await Z.resetPassword(I,R,X,pe);if(N.success)f.success("Password Reset!",{description:"You can now login with your new password"}),o("LOGIN"),i(""),le(""),be(""),J(""),E("");else{const S=N.message||"Password reset failed";i(S),f.error("Reset Failed",{description:S})}}catch(N){const S=N.message||"Password reset failed. Please try again.";i(S),f.error("Reset Failed",{description:S})}finally{d(!1)}},es=async()=>{d(!0),i("");try{let g;if(Y==="register"?g=await Z.resendRegistrationOtp(F):g=await Z.forgotPassword(I),g.success)f.success("OTP Resent!",{description:"Please check your email for the new code"}),B(["","","","","",""]);else{const N=g.message||"Failed to resend OTP";i(N),f.error("Failed",{description:N})}}catch{const N="Failed to resend OTP. Please try again.";i(N),f.error("Failed",{description:N})}finally{d(!1)}},fe="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",re="w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",xe="flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 px-4 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",ss={CHOICE:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/icon.svg",alt:"Ramzania",className:"h-12 w-12"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black tracking-tight text-slate-900",children:"Join Ramzania"}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Your portal to community Sehar."})]})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("button",{className:xe,onClick:()=>o("LOGIN"),children:"Sign In"}),e.jsx("button",{className:"flex w-full items-center justify-center gap-2 rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-[0.98]",onClick:()=>o("REGISTER"),children:"Create Account"})]})]}),LOGIN:e.jsxs("form",{onSubmit:Ke,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>o("CHOICE"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(Ne,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Sign In"})]}),u&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:u}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"email",required:!0,placeholder:"Email address",className:fe,value:y,onChange:g=>j(g.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Password",className:fe,value:n,onChange:g=>b(g.target.value)})]}),e.jsx("button",{type:"submit",disabled:c,className:xe,children:c?e.jsx(G,{className:"animate-spin",size:18}):"Sign In"}),e.jsx("button",{type:"button",onClick:()=>o("FORGOT"),className:"w-full text-center text-[10px] font-bold tracking-wide text-slate-400 uppercase hover:text-emerald-600",children:"Forgot Password?"})]}),REGISTER:e.jsxs("form",{onSubmit:Xe,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>o("CHOICE"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(Ne,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Create Account"})]}),u&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:u}),e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{type:"button",onClick:()=>v("seeker"),className:`flex-1 rounded-lg py-2.5 text-xs font-bold transition-all ${h==="seeker"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"ðŸ½ï¸ Guest"}),e.jsx("button",{type:"button",onClick:()=>v("provider"),className:`flex-1 rounded-lg py-2.5 text-xs font-bold transition-all ${h==="provider"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"ðŸ  Host"})]}),e.jsx("p",{className:"text-[10px] font-medium text-slate-400",children:h==="seeker"?"Find & reserve Sehri near you":"Arrange Sehri for guests in your area"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"email",required:!0,placeholder:"Email address",className:re,value:F,onChange:g=>w(g.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Password (min 6 chars)",className:re,value:k,onChange:g=>_(g.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Full Name",className:re,value:p,onChange:g=>m(g.target.value)}),e.jsx("input",{type:"tel",required:!0,placeholder:"Contact Number",className:re,value:x,onChange:g=>C(g.target.value)})]}),h==="provider"&&e.jsx("input",{type:"text",required:!0,placeholder:"Place Name (e.g., Restaurant, Masjid,..)",className:re,value:A,onChange:g=>D(g.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500",children:"Address Details"}),r&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(G,{size:10,className:"animate-spin"}),"Fetching location..."]}),!r&&V&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(ne,{size:10}),"Auto-filled"]})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Street / Door No",className:re,value:O,onChange:g=>q(g.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Area / Locality",className:re,value:L,onChange:g=>H(g.target.value)}),e.jsx("input",{type:"text",required:!0,placeholder:"City",className:re,value:V,onChange:g=>se(g.target.value)})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Pincode",className:re,value:te,onChange:g=>ae(g.target.value)})]}),e.jsx("button",{type:"submit",disabled:c,className:xe,children:c?e.jsx(G,{className:"animate-spin",size:18}):"Continue â†’"})]}),FORGOT:e.jsxs("form",{onSubmit:Je,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>o("LOGIN"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(Ne,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Reset Password"})]}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Enter your email to receive a verification code."}),u&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:u}),e.jsx("input",{type:"email",required:!0,placeholder:"Registered email",className:fe,value:I,onChange:g=>le(g.target.value)}),e.jsx("button",{type:"submit",disabled:c,className:xe,children:c?e.jsx(G,{className:"animate-spin",size:18}):"Send OTP"})]}),OTP:e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>o(Y==="register"?"REGISTER":"FORGOT"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(Ne,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Verify Email"})]}),e.jsxs("p",{className:"text-sm font-medium text-slate-500",children:["Enter the 6-digit code sent to ",e.jsx("span",{className:"font-bold text-slate-700",children:Y==="register"?F:I})]}),u&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:u}),e.jsx("div",{className:"flex justify-between gap-2",children:M.map((g,N)=>e.jsx("input",{ref:S=>_e.current[N]=S,type:"text",inputMode:"numeric",maxLength:1,className:"h-12 w-full rounded-xl border border-slate-200 bg-slate-50 text-center text-lg font-bold transition-all outline-none focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",value:g,onChange:S=>Ye(S,N),onKeyDown:S=>We(S,N)},N))}),e.jsx("button",{type:"button",onClick:Ze,disabled:c||M.join("").length<6,className:xe,children:c?e.jsx(G,{className:"animate-spin",size:18}):"Verify"}),e.jsx("button",{type:"button",onClick:es,disabled:c,className:"w-full text-center text-[10px] font-bold tracking-wide text-slate-400 uppercase hover:text-emerald-600",children:"Resend Code"})]}),RESET_PASSWORD:e.jsxs("form",{onSubmit:Qe,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cs,{size:20,className:"text-emerald-600"}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"New Password"})]}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Create a new password for your account."}),u&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:u}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"password",required:!0,placeholder:"New Password (min 6 chars)",className:fe,value:X,onChange:g=>be(g.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Confirm Password",className:fe,value:pe,onChange:g=>J(g.target.value)})]}),e.jsx("button",{type:"submit",disabled:c,className:xe,children:c?e.jsx(G,{className:"animate-spin",size:18}):"Reset Password"})]})};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-slate-900/40 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-4 w-full max-w-md rounded-2xl border border-slate-100 bg-white p-6 shadow-xl sm:rounded-3xl sm:p-8",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-emerald-50 text-emerald-600",children:e.jsx(Ee,{size:20})}),e.jsx("button",{onClick:s,className:"rounded-full p-2 text-slate-300 transition-all hover:bg-slate-100 hover:text-slate-500",children:e.jsx(ce,{size:18})})]}),ss[t]]})})}const ge=s=>new Promise(l=>setTimeout(l,s)),Os=async(s={})=>{try{const l=new URLSearchParams;s.area&&l.append("area",s.area),s.place&&l.append("place",s.place);const t=l.toString(),o=`/home/offerings${t?`?${t}`:""}`,c=await $.get(o,{auth:!1});return c.success?{providers:c.providers||[],filters:c.filters||{},current_ramzan_day:c.current_ramzan_day,ramzan_start_date:c.ramzan_start_date}:{providers:Ie(),filters:{}}}catch(l){return console.error("Failed to fetch providers from API, using mock data:",l),{providers:Ie(),filters:{}}}},Ms=async(s=null,l=null)=>{try{const t=new URLSearchParams;s&&t.append("day",s),l&&t.append("date",l);const o=t.toString(),c=o?`/home/timings?${o}`:"/home/timings",d=await $.get(c,{auth:!1});return d.success?d:{success:!1,timing:null}}catch(t){return console.error("Failed to fetch Ramzan timings:",t),{success:!1,timing:null}}},Ds=async()=>{try{const s=await $.get("/home/timings/all",{auth:!1});return s.success?s.timings||[]:[]}catch(s){return console.error("Failed to fetch all Ramzan timings:",s),[]}},Es=async(s,l={})=>{try{const t=new URLSearchParams;l.lat&&t.append("lat",l.lat),l.lng&&t.append("lng",l.lng);const o=t.toString(),c=`/home/provider/${s}/offerings${o?`?${o}`:""}`,d=await $.get(c,{auth:!1});return d.success?d:{success:!1,offerings:[]}}catch(t){return console.error("Failed to fetch provider offerings:",t),{success:!1,offerings:[]}}},Ls=async(s,l)=>$.post("/bookings",{offering_id:s,quantity:l}),Ts=async()=>$.get("/bookings/my"),Is=async s=>$.post(`/bookings/${s}/cancel`),$s=async(s="all")=>{const l=s==="all"?"/bookings/provider":`/bookings/provider?status=${s}`;return $.get(l)},qs=async(s,l)=>$.put(`/bookings/${s}/status`,{status:l}),Ie=()=>[],Bs=async()=>(await ge(200),[{id:1,title:"Dua for Suhoor (Intention for Fasting)",arabic:"ÙˆÙŽØ¨ÙØµÙŽÙˆÙ’Ù…Ù ØºÙŽØ¯Ù Ù†ÙŽÙˆÙŽÙŠÙ’ØªÙ Ù…ÙÙ†Ù’ Ø´ÙŽÙ‡Ù’Ø±Ù Ø±ÙŽÙ…ÙŽØ¶ÙŽØ§Ù†ÙŽ",transliteration:"Wa bisawmi ghadin nawaitu min shahri Ramadan",english:"I intend to fast tomorrow for the month of Ramadan."},{id:2,title:"Dua for Iftar (Breaking Fast)",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ Ø¥ÙÙ†ÙÙ‘ÙŠ Ù„ÙŽÙƒÙŽ ØµÙÙ…Ù’ØªÙ ÙˆÙŽØ¨ÙÙƒÙŽ Ø¢Ù…ÙŽÙ†Ù’ØªÙ ÙˆÙŽØ¹ÙŽÙ„ÙŽÙŠÙ’ÙƒÙŽ ØªÙŽÙˆÙŽÙƒÙŽÙ‘Ù„Ù’ØªÙ ÙˆÙŽØ¹ÙŽÙ„ÙŽÙ‰ Ø±ÙØ²Ù’Ù‚ÙÙƒÙŽ Ø£ÙŽÙÙ’Ø·ÙŽØ±Ù’ØªÙ",transliteration:"Allahumma inni laka sumtu wa bika aamantu wa â€˜alayka tawakkaltu wa â€˜ala rizqika aftartu",english:"O Allah, I fasted for You, I believe in You, I trust in You, and I break my fast with Your provision."},{id:3,title:"Dua After Breaking Fast (Authentic)",arabic:"Ø°ÙŽÙ‡ÙŽØ¨ÙŽ Ø§Ù„Ø¸ÙŽÙ‘Ù…ÙŽØ£Ù ÙˆÙŽØ§Ø¨Ù’ØªÙŽÙ„ÙŽÙ‘ØªÙ Ø§Ù„Ù’Ø¹ÙØ±ÙÙˆÙ‚Ù ÙˆÙŽØ«ÙŽØ¨ÙŽØªÙŽ Ø§Ù„Ù’Ø£ÙŽØ¬Ù’Ø±Ù Ø¥ÙÙ†Ù’ Ø´ÙŽØ§Ø¡ÙŽ Ø§Ù„Ù„ÙŽÙ‘Ù‡Ù",transliteration:"Dhahaba adh-dhamaâ€™u wabtallatil â€˜urooq wa thabatal ajru in sha Allah",english:"The thirst is gone, the veins are moistened, and the reward is confirmed, if Allah wills."},{id:4,title:"Dua for Laylatul Qadr",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ Ø¥ÙÙ†ÙŽÙ‘ÙƒÙŽ Ø¹ÙŽÙÙÙˆÙŒÙ‘ ØªÙØ­ÙØ¨ÙÙ‘ Ø§Ù„Ù’Ø¹ÙŽÙÙ’ÙˆÙŽ ÙÙŽØ§Ø¹Ù’ÙÙ Ø¹ÙŽÙ†ÙÙ‘ÙŠ",transliteration:"Allahumma innaka afuwwun tuhibbul afwa faâ€™fu anni",english:"O Allah, You are Most Forgiving, and You love forgiveness; so forgive me."},{id:5,title:"Dua for Forgiveness",arabic:"Ø£ÙŽØ³Ù’ØªÙŽØºÙ’ÙÙØ±Ù Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙŽ",transliteration:"Astaghfirullah",english:"I seek forgiveness from Allah."},{id:6,title:"Dua for Mercy",arabic:"Ø±ÙŽØ¨ÙÙ‘ Ø§ØºÙ’ÙÙØ±Ù’ ÙˆÙŽØ§Ø±Ù’Ø­ÙŽÙ…Ù’ ÙˆÙŽØ£ÙŽÙ†Ù’ØªÙŽ Ø®ÙŽÙŠÙ’Ø±Ù Ø§Ù„Ø±ÙŽÙ‘Ø§Ø­ÙÙ…ÙÙŠÙ†ÙŽ",transliteration:"Rabbighfir warham wa anta khayrur rahimeen",english:"My Lord, forgive and have mercy, for You are the Best of the merciful."},{id:7,title:"Dua for Guidance",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ Ø§Ù‡Ù’Ø¯ÙÙ†ÙÙŠ ÙˆÙŽØ³ÙŽØ¯ÙÙ‘Ø¯Ù’Ù†ÙÙŠ",transliteration:"Allahumma ihdini wa saddidni",english:"O Allah, guide me and keep me steadfast."},{id:8,title:"Dua for Acceptance of Fasting",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ ØªÙŽÙ‚ÙŽØ¨ÙŽÙ‘Ù„Ù’ Ù…ÙÙ†ÙŽÙ‘Ø§ Ø¥ÙÙ†ÙŽÙ‘ÙƒÙŽ Ø£ÙŽÙ†Ù’ØªÙŽ Ø§Ù„Ø³ÙŽÙ‘Ù…ÙÙŠØ¹Ù Ø§Ù„Ù’Ø¹ÙŽÙ„ÙÙŠÙ…Ù",transliteration:"Allahumma taqabbal Ù…Ù†Ø§ innaka antas-sameeâ€™ul aleem",english:"O Allah, accept from us. Indeed, You are the All-Hearing, All-Knowing."}]),Gs=async()=>(await ge(200),[]),Hs=async(s="Chennai")=>(await ge(100),{sehar:"4:52 AM",iftar:"6:24 PM",area:s}),Vs=async(s,l)=>(await ge(1e3),{success:!0,user:{email:s,role:s.includes("admin")?"admin":"seeker",name:s.split("@")[0],token:"token-"+Date.now()}}),Us=async(s,l)=>(await ge(500),{success:!0,bookingId:`BK-${Date.now()}`,message:"Spot booked successfully!"}),Ys=async()=>{try{const s=await $.get("/home/stats",{auth:!1});return s.success?s.stats:{seekers:0,providers:0,requests:0}}catch(s){return console.error("Failed to fetch home stats:",s),{seekers:0,providers:0,requests:0}}},Ws=async()=>{try{const s=await $.get("/home/seekers",{auth:!1});return s.success?s.seekers||[]:[]}catch(s){return console.error("Failed to fetch seekers:",s),[]}},Ks=async()=>{try{const s=await $.get("/home/providers",{auth:!1});return s.success?s.providers||[]:[]}catch(s){return console.error("Failed to fetch providers:",s),[]}},Xs=async()=>{try{const s=await $.get("/home/requests",{auth:!1});return s.success?s.requests||[]:[]}catch(s){return console.error("Failed to fetch support requests:",s),[]}},ee={fetchPoints:Os,fetchDuas:Bs,fetchEvents:Gs,fetchTimings:Hs,fetchRamzanTimings:Ms,fetchAllRamzanTimings:Ds,login:Vs,bookSpot:Us,fetchHomeStats:Ys,fetchSeekers:Ws,fetchProvidersList:Ks,fetchSupportRequests:Xs};function Js({point:s,user:l,userLocation:t,onClose:o,onSuccess:c,onLoginClick:d}){const[u,i]=a.useState(!0),[y,j]=a.useState([]),[n,b]=a.useState(null),[h,v]=a.useState(null),[F,w]=a.useState(1),[k,_]=a.useState(!1);a.useEffect(()=>{(async()=>{i(!0);const C=s.provider_id||s.id,A={};t!=null&&t.lat&&(t!=null&&t.lng)&&(A.lat=t.lat,A.lng=t.lng);const D=await Es(C,A);D.success&&(b(D.provider),j(D.offerings||[])),i(!1)})()},[s,t]);const p=x=>{const C=["th","st","nd","rd"],A=x%100;return x+(C[(A-20)%10]||C[A]||C[0])},m=async()=>{if(!h){f.error("Please select a date");return}_(!0);try{const x=await Ls(h.id,F);x.success?(f.success("Spot Booked!",{description:`Booking code: ${x.booking.booking_code}`}),c==null||c(`Spot booked for ${p(h.ramzan_day)} Ramzan!`)):f.error("Booking Failed",{description:x.message})}catch(x){x.status===401?(f.error("Please login to book"),d==null||d()):f.error("Booking Failed",{description:x.message})}finally{_(!1)}};return l?e.jsx("div",{className:"fixed inset-0 z-100 flex items-end justify-center bg-slate-900/30 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-10 max-h-[90vh] w-full max-w-md overflow-hidden rounded-3xl border border-slate-100 bg-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 p-4",children:[e.jsx("h2",{className:"text-lg font-black text-slate-900",children:"Reserve Sehri"}),e.jsx("button",{onClick:o,className:"rounded-full p-2 text-slate-400 hover:bg-slate-100",children:e.jsx(ce,{size:18})})]}),e.jsxs("div",{className:"bg-emerald-50 px-4 py-3",children:[e.jsx("p",{className:"font-black text-emerald-800",children:(n==null?void 0:n.name)||s.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-emerald-600",children:[e.jsx("span",{children:(n==null?void 0:n.area)||s.area}),(n==null?void 0:n.distance)!==null&&(n==null?void 0:n.distance)!==void 0&&e.jsxs("span",{className:"flex items-center gap-0.5 rounded bg-emerald-100 px-1.5 py-0.5 text-emerald-700",children:[e.jsx(ne,{size:10})," ",n.distance," km"]})]})]}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto p-4",children:u?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(G,{size:24,className:"animate-spin text-emerald-600"})}):y.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(Ce,{size:32,className:"mx-auto mb-2 text-slate-300"}),e.jsx("p",{className:"text-sm text-slate-500",children:"No available dates"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"mb-3 text-xs font-bold text-slate-500",children:"Select a date:"}),y.map(x=>e.jsxs("button",{disabled:!x.is_bookable,onClick:()=>v(x),className:`w-full rounded-xl border p-3 text-left transition-all ${(h==null?void 0:h.id)===x.id?"border-emerald-500 bg-emerald-50 ring-2 ring-emerald-200":x.is_bookable?"border-slate-200 bg-white hover:border-emerald-300 hover:bg-emerald-50/50":"cursor-not-allowed border-slate-100 bg-slate-50 opacity-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 text-xs font-black text-emerald-700",children:p(x.ramzan_day)}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold text-slate-800",children:[x.formatted_date,e.jsxs("span",{className:"ml-1 text-[10px] font-normal text-slate-400",children:["(",x.day_name,")"]})]}),e.jsx("p",{className:"text-[10px] text-slate-500",children:x.meal_type})]})]}),e.jsxs("div",{className:"text-right",children:[(h==null?void 0:h.id)===x.id&&e.jsx(Ge,{size:16,className:"text-emerald-600"}),!h||h.id!==x.id?e.jsx("span",{className:`text-xs font-bold ${x.is_bookable?"text-emerald-600":"text-red-500"}`,children:x.is_bookable?`${x.available_slots} spots`:"Full"}):null]})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-1.5 text-[10px] text-slate-500",children:[x.timing&&e.jsxs("span",{className:"flex items-center gap-0.5 rounded bg-slate-100 px-1.5 py-0.5",children:[e.jsx(oe,{size:10})," ",x.timing]}),e.jsx("span",{className:`rounded px-1.5 py-0.5 ${x.price_type==="free"?"bg-emerald-100 text-emerald-600":"bg-amber-100 text-amber-600"}`,children:x.price_type==="free"?"Free":`â‚¹${x.price_amount}`})]}),e.jsxs("p",{className:"mt-2 text-[10px] text-slate-400 italic",children:['"',x.menu_items,'"']})]},x.id))]})}),h&&e.jsxs("div",{className:"border-t border-slate-100 bg-slate-50 p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between rounded-xl bg-white p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{size:16,className:"text-slate-400"}),e.jsx("span",{className:"text-sm font-bold text-slate-700",children:"No. of Persons"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>w(x=>Math.max(1,x-1)),className:"rounded-lg bg-slate-100 p-1.5 text-slate-600 hover:bg-slate-200",children:e.jsx(ds,{size:14})}),e.jsx("span",{className:"w-6 text-center text-sm font-black text-slate-900",children:F}),e.jsx("button",{type:"button",onClick:()=>w(x=>Math.min(h.available_slots,Math.min(10,x+1))),className:"rounded-lg bg-slate-100 p-1.5 text-slate-600 hover:bg-slate-200",children:e.jsx(Le,{size:14})})]})]}),e.jsxs("div",{className:"mb-4 flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-slate-500",children:[p(h.ramzan_day)," Ramzan â€¢ ",h.meal_type]}),e.jsx("span",{className:"font-bold text-slate-900",children:h.price_type==="free"?"Free":`â‚¹${(h.price_amount||0)*F}`})]}),e.jsx("button",{onClick:m,disabled:k,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",children:k?e.jsxs(e.Fragment,{children:[e.jsx(G,{size:16,className:"animate-spin"}),"Booking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(he,{size:16}),"Confirm Booking"]})})]})]})}):e.jsx("div",{className:"fixed inset-0 z-100 flex items-end justify-center bg-slate-900/30 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-10 w-full max-w-md rounded-3xl border border-slate-100 bg-white p-6 shadow-lg",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Book Spot"}),e.jsx("button",{onClick:o,className:"rounded-full p-2 text-slate-400 hover:bg-slate-100",children:e.jsx(ce,{size:18})})]}),e.jsxs("div",{className:"mb-6 rounded-xl bg-emerald-50 p-4",children:[e.jsx("p",{className:"font-black text-emerald-800",children:s.name}),e.jsx("p",{className:"text-xs text-emerald-600",children:s.area})]}),e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:[e.jsx(Ee,{size:32,className:"mx-auto mb-3 text-slate-400"}),e.jsx("p",{className:"font-bold text-slate-700",children:"Login Required"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Please login or register to reserve Sehri"}),e.jsx("button",{onClick:()=>{o(),d==null||d()},className:"mt-4 rounded-xl bg-emerald-600 px-6 py-2.5 text-sm font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:"Login / Register"})]})]})})}function Zs({timings:s,ramzanTiming:l,points:t,onBook:o,availableAreas:c=[],onFilterChange:d,loading:u}){const[i,y]=a.useState(""),[j,n]=a.useState(""),[b,h]=a.useState(!1),v=()=>{const p=new Date,m=new Date("2026-02-19"),x=new Date("2026-03-20");return p>=m&&p<=x},F=t.filter(p=>p.name.toLowerCase().includes(i.toLowerCase())||p.menu.toLowerCase().includes(i.toLowerCase())),w=p=>{n(p),d&&d({area:p})},k=()=>{n(""),y(""),d&&d({})},_=p=>{if(!p)return"--:--";const[m,x]=p.split(":"),C=parseInt(m),A=C>=12?"PM":"AM";return`${C%12||12}:${x} ${A}`};return e.jsxs("div",{className:"space-y-6",children:[l&&v()&&e.jsxs("section",{className:"rounded-2xl bg-gradient-to-br from-emerald-50 to-teal-50 p-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{size:16,className:"text-emerald-600"}),e.jsxs("h2",{className:"text-sm font-black tracking-tight text-slate-900",children:["Day ",l.ramzan_day," - Prayer Times"]})]}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:new Date(l.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"rounded-xl bg-white/80 p-3 text-center shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:"Sehri Ends"}),e.jsx("p",{className:"text-lg font-black text-emerald-700",children:_(l.sehar_time)})]}),e.jsxs("div",{className:"rounded-xl bg-white/80 p-3 text-center shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:"Iftar"}),e.jsx("p",{className:"text-lg font-black text-orange-600",children:_(l.iftar_time)})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2 sm:grid-cols-6",children:[{name:"Fajr",time:l.fajr},{name:"Zohar",time:l.zohar},{name:"Asar",time:l.asar},{name:"Magrib",time:l.magrib},{name:"Isha",time:l.isha},{name:"Taraweeh",time:l.taraweeh}].map(p=>e.jsxs("div",{className:"rounded-lg bg-white/60 px-2 py-1.5 text-center",children:[e.jsx("p",{className:"text-[10px] font-medium text-slate-500",children:p.name}),e.jsx("p",{className:"text-xs font-bold text-slate-700",children:_(p.time)})]},p.name))})]}),!l&&v()&&e.jsxs("section",{children:[e.jsx("h2",{className:"mb-3 text-sm font-black tracking-tight text-slate-900",children:"Today's Timings"}),e.jsx(As,{timings:s,compact:!0})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{size:16,className:"text-emerald-600"}),e.jsx("h2",{className:"text-sm font-black tracking-tight text-slate-900",children:"Sehri Locations"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"rounded-lg bg-slate-100 px-2 py-0.5 text-xs font-bold text-slate-600",children:u?"...":`${F.length} nearby`}),e.jsxs("button",{onClick:()=>h(!b),className:`flex items-center gap-1 rounded-lg px-2 py-0.5 text-xs font-bold transition-colors ${b||j?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600"}`,children:[e.jsx(xs,{size:12}),"Filter"]})]})]}),b&&e.jsxs("div",{className:"mb-4 rounded-xl border border-slate-200 bg-slate-50 p-3",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-bold text-slate-700",children:"Filter by Area"}),j&&e.jsxs("button",{onClick:k,className:"flex items-center gap-1 text-xs text-slate-500 hover:text-slate-700",children:[e.jsx(ce,{size:12})," Clear"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.length>0?c.map(p=>e.jsxs("button",{onClick:()=>w(p===j?"":p),className:`flex items-center gap-1 rounded-full px-3 py-1 text-xs font-medium transition-colors ${j===p?"bg-emerald-600 text-white":"bg-white text-slate-600 hover:bg-emerald-50"}`,children:[e.jsx(ne,{size:10}),p]},p)):e.jsx("p",{className:"text-xs text-slate-400",children:"No areas available"})})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(ms,{size:16,className:"absolute top-1/2 left-3 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search Sehri Locations...",value:i,onChange:p=>y(p.target.value),className:"w-full rounded-xl border border-slate-200 bg-white py-2.5 pr-4 pl-9 text-sm font-medium text-slate-900 placeholder:text-slate-400 focus:border-emerald-300 focus:ring-2 focus:ring-emerald-100 focus:outline-none"})]}),u?e.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:e.jsx("div",{className:"animate-pulse",children:e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Loading hosts..."})})}):F.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:F.map(p=>e.jsx(zs,{point:p,onBook:o,compact:!0},p.id))}):e.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"No Sehri found"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Try a different search term or clear filters"})]})]})]})}const Qs="ramzania_user";function et({user:s,onUserUpdate:l}){const[t,o]=a.useState({place_name:"",contact:"",alternate_contact:"",street:"",area:"",city:"",pincode:"",latitude:"",longitude:""}),[c,d]=a.useState(!1),[u,i]=a.useState({type:"",text:""}),[y,j]=a.useState(!1),[n,b]=a.useState(!1);a.useEffect(()=>{s&&o({place_name:s.place_name||"",contact:s.contact||"",alternate_contact:s.alternate_contact||"",street:s.street||"",area:s.area||"",city:s.city||"",pincode:s.pincode||"",latitude:s.latitude||"",longitude:s.longitude||""})},[s]);const h=_=>{const{name:p,value:m}=_.target;o(x=>({...x,[p]:m}))},v=a.useCallback(()=>{if(!navigator.geolocation){i({type:"error",text:"Geolocation not supported by your browser"});return}i({type:"info",text:"Getting your location..."}),navigator.geolocation.getCurrentPosition(_=>{o(p=>({...p,latitude:_.coords.latitude.toFixed(6),longitude:_.coords.longitude.toFixed(6)})),i({type:"success",text:"Location updated!"}),setTimeout(()=>i({type:"",text:""}),2e3)},_=>{i({type:"error",text:"Failed to get location: "+_.message})},{enableHighAccuracy:!0,timeout:1e4})},[]),F=()=>{const _=t.latitude||19.076,p=t.longitude||72.8777;window.open(`https://www.google.com/maps/search/?api=1&query=${_},${p}`,"_blank"),i({type:"info",text:"Copy the coordinates from Google Maps URL and paste them in the fields above"})},w=async _=>{var p,m;_.preventDefault(),d(!0),i({type:"",text:""});try{const x=await Z.updateProfile({user_id:s.id,place_name:t.place_name,contact:t.contact,alternate_contact:t.alternate_contact||null,street:t.street,area:t.area,city:t.city,pincode:t.pincode,latitude:t.latitude?parseFloat(t.latitude):null,longitude:t.longitude?parseFloat(t.longitude):null});if(x.data.success){i({type:"success",text:"Profile updated successfully!"});const C={...s,...x.data.user};localStorage.setItem(Qs,JSON.stringify(C)),l&&l(C)}else i({type:"error",text:x.data.message||"Update failed"})}catch(x){console.error("Profile update error:",x),i({type:"error",text:((m=(p=x.response)==null?void 0:p.data)==null?void 0:m.message)||"Failed to update profile"})}finally{d(!1)}},k=()=>{t.latitude&&t.longitude&&window.open(`https://www.google.com/maps?q=${t.latitude},${t.longitude}`,"_blank")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Host Settings"}),e.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Update your place details and contact information"})]}),u.text&&e.jsx("div",{className:`rounded-lg p-3 text-sm ${u.type==="success"?"border border-emerald-200 bg-emerald-50 text-emerald-700":u.type==="error"?"border border-red-200 bg-red-50 text-red-700":"border border-blue-200 bg-blue-50 text-blue-700"}`,children:u.text}),e.jsxs("form",{onSubmit:w,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Place Name"}),e.jsx("input",{type:"text",name:"place_name",value:t.place_name,onChange:h,placeholder:"e.g., Shah's Kitchen",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"This name will be shown to guests"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Primary Contact"}),e.jsx("input",{type:"tel",name:"contact",value:t.contact,onChange:h,placeholder:"+91 98765 43210",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Alternate Number"}),e.jsx("input",{type:"tel",name:"alternate_contact",value:t.alternate_contact,onChange:h,placeholder:"Optional",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Street Address"}),e.jsx("input",{type:"text",name:"street",value:t.street,onChange:h,placeholder:"Building, Street name",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Area"}),e.jsx("input",{type:"text",name:"area",value:t.area,onChange:h,placeholder:"e.g., Bandra West",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"City"}),e.jsx("input",{type:"text",name:"city",value:t.city,onChange:h,placeholder:"e.g., Mumbai",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Pincode"}),e.jsx("input",{type:"text",name:"pincode",value:t.pincode,onChange:h,placeholder:"e.g., 400050",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700",children:"Location Coordinates"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Helps guests navigate to your place"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:v,className:"rounded-lg bg-emerald-50 px-3 py-1.5 text-xs font-medium text-emerald-600 transition-colors hover:bg-emerald-100",children:"ðŸ“ Use GPS"}),e.jsx("button",{type:"button",onClick:F,className:"rounded-lg bg-blue-50 px-3 py-1.5 text-xs font-medium text-blue-600 transition-colors hover:bg-blue-100",children:"ðŸ—ºï¸ Open Maps"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-500",children:"Latitude"}),e.jsx("input",{type:"number",name:"latitude",value:t.latitude,onChange:h,placeholder:"e.g., 19.0760",step:"0.000001",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-500",children:"Longitude"}),e.jsx("input",{type:"number",name:"longitude",value:t.longitude,onChange:h,placeholder:"e.g., 72.8777",step:"0.000001",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]})]}),t.latitude&&t.longitude&&e.jsxs("button",{type:"button",onClick:k,className:"mt-3 flex w-full items-center justify-center gap-2 rounded-xl bg-slate-50 py-2 text-sm font-medium text-slate-600 transition-colors hover:bg-slate-100",children:[e.jsxs("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"View Current Location on Map"]})]}),e.jsx("button",{type:"submit",disabled:c,className:"mt-6 w-full rounded-xl bg-emerald-600 py-3 font-bold text-white transition-all hover:bg-emerald-700 focus:ring-4 focus:ring-emerald-100 disabled:cursor-not-allowed disabled:opacity-50",children:c?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})]})]})}async function st(s,l){try{const o=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${l}&zoom=18&addressdetails=1`,{headers:{"Accept-Language":"en"}})).json();if(o!=null&&o.address){const{road:c,suburb:d,neighbourhood:u,city:i,town:y,village:j,state_district:n,state:b,postcode:h,county:v}=o.address;return{street:c||"",area:d||u||v||"",city:i||y||j||n||"",pincode:h||"",state:b||""}}return null}catch(t){return console.error("Reverse geocoding failed:",t),null}}function tt({user:s,onLogin:l,onNavigate:t,onJoinClick:o}){const[c,d]=a.useState("REGISTER"),[u,i]=a.useState(!1),[y,j]=a.useState(""),[n,b]=a.useState(""),[h,v]=a.useState(""),[F,w]=a.useState(""),[k,_]=a.useState(""),[p,m]=a.useState(""),[x,C]=a.useState(""),[A,D]=a.useState(""),[O,q]=a.useState(""),[L,H]=a.useState(""),[V,se]=a.useState(null),[te,ae]=a.useState(null),[z,U]=a.useState(!1),[K,Q]=a.useState(["","","","","",""]),r=a.useRef([]),P=a.useCallback(async()=>{if(navigator.geolocation){U(!0);try{const R=await new Promise((Y,je)=>{navigator.geolocation.getCurrentPosition(Y,je,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),{latitude:E,longitude:M}=R.coords;se(E),ae(M);const B=await st(E,M);B&&(C(B.street),D(B.area),q(B.city),H(B.pincode))}catch(R){console.log("Location fetch failed:",R.message)}finally{U(!1)}}},[]);a.useEffect(()=>{s||P()},[s,P]);const I=(R,E)=>{var Y;const M=R.target.value;if(isNaN(M))return;const B=[...K];B[E]=M.slice(-1),Q(B),M&&E<5&&((Y=r.current[E+1])==null||Y.focus())},le=(R,E)=>{var M;R.key==="Backspace"&&!K[E]&&E>0&&((M=r.current[E-1])==null||M.focus())},X=async R=>{var E,M;if(R.preventDefault(),j(""),h.length<6){j("Password must be at least 6 characters"),f.error("Validation Error",{description:"Password must be at least 6 characters"});return}i(!0);try{const B=await Z.register({email:n,password:h,name:F,contact:k,role:"provider",place_name:p,street:x,area:A,city:O,pincode:L,latitude:V,longitude:te});if(B.success)f.success("OTP Sent!",{description:"Please check your email for the verification code"}),Q(["","","","","",""]),d("OTP");else{const Y=B.message||"Registration failed";j(Y),f.error("Registration Failed",{description:Y})}}catch(B){const Y=B.message||((M=(E=B.errors)==null?void 0:E.email)==null?void 0:M[0])||"Registration failed. Please try again.";j(Y),f.error("Registration Failed",{description:Y})}finally{i(!1)}},be=async()=>{const R=K.join("");if(!(R.length<6)){j(""),i(!0);try{const E=await Z.verifyRegistrationOtp(n,R);if(E.success)E.token&&Fe.set("auth_token",E.token),f.success("Account Verified!",{description:"Welcome to Ramzania!"}),l&&l(E.user);else{const M=E.message||"Invalid OTP";j(M),f.error("Verification Failed",{description:M})}}catch(E){const M=E.message||"OTP verification failed. Please try again.";j(M),f.error("Verification Failed",{description:M})}finally{i(!1)}}},pe=async()=>{i(!0),j("");try{const R=await Z.resendRegistrationOtp(n);R.success?(f.success("OTP Resent!",{description:"Please check your email for the new code"}),Q(["","","","","",""])):(j(R.message||"Failed to resend OTP"),f.error("Failed",{description:R.message}))}catch{j("Failed to resend OTP. Please try again."),f.error("Failed",{description:"Failed to resend OTP"})}finally{i(!1)}},J="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-2.5 text-sm font-medium text-slate-800 placeholder-slate-400 outline-none transition-all focus:border-emerald-500 focus:bg-white focus:ring-1 focus:ring-emerald-500";return(s==null?void 0:s.role)==="provider"?e.jsx("div",{className:"pb-8",children:e.jsxs("div",{className:"rounded-2xl border border-emerald-200 bg-emerald-50 p-6 text-center",children:[e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-emerald-100",children:e.jsx(ve,{size:28,className:"text-emerald-600"})})}),e.jsx("h2",{className:"mb-2 text-xl font-black text-emerald-700",children:"You're Already a Host!"}),e.jsx("p",{className:"mb-4 text-sm text-slate-600",children:"You're registered as a provider. Go to your dashboard to manage your Sehri offerings."}),e.jsx("button",{onClick:()=>t("dashboard"),className:"rounded-xl bg-emerald-600 px-6 py-2.5 font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:"Go to Dashboard"})]})}):c==="OTP"?e.jsxs("div",{className:"pb-8",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("div",{className:"mb-3 flex justify-center",children:e.jsx("div",{className:"rounded-full border border-emerald-200 bg-emerald-50 p-3",children:e.jsx(ve,{size:28,className:"text-emerald-600"})})}),e.jsx("h1",{className:"mb-2 text-xl font-black text-emerald-700",children:"Verify Your Email"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Enter the 6-digit code sent to ",e.jsx("span",{className:"font-bold text-slate-700",children:n})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[y&&e.jsx("p",{className:"mb-4 rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:y}),e.jsx("div",{className:"mb-6 flex justify-between gap-2",children:K.map((R,E)=>e.jsx("input",{ref:M=>r.current[E]=M,type:"text",inputMode:"numeric",maxLength:1,className:"h-12 w-full rounded-xl border border-slate-200 bg-slate-50 text-center text-lg font-bold transition-all outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500",value:R,onChange:M=>I(M,E),onKeyDown:M=>le(M,E)},E))}),e.jsx("button",{onClick:be,disabled:u||K.join("").length<6,className:"mb-3 w-full rounded-xl bg-emerald-600 py-3 font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:bg-emerald-400",children:u?e.jsx(G,{className:"mx-auto animate-spin",size:20}):"Verify & Create Account"}),e.jsx("button",{onClick:pe,disabled:u,className:"w-full text-center text-xs font-bold text-slate-400 uppercase hover:text-emerald-600",children:"Resend Code"}),e.jsx("button",{onClick:()=>d("REGISTER"),className:"mt-4 w-full text-center text-xs font-medium text-slate-400 hover:text-slate-600",children:"Back to Registration"})]})]}):e.jsxs("div",{className:"pb-8",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("div",{className:"mb-3 flex justify-center",children:e.jsx("div",{className:"rounded-full border border-emerald-200 bg-emerald-50 p-3",children:e.jsx(ve,{size:28,className:"text-emerald-600"})})}),e.jsx("h1",{className:"mb-2 text-xl font-black text-emerald-700",children:"Register as Sehri Provider"}),e.jsx("p",{className:"mx-auto max-w-sm text-sm text-slate-500",children:"Create your Sehri Provider account to start offering Sehri to the community this Ramadan."})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"mb-4 rounded-xl bg-emerald-50 px-4 py-3",children:[e.jsx("p",{className:"text-xs font-bold text-emerald-700",children:" Sehri Provider Account"}),e.jsx("p",{className:"text-xs text-emerald-600",children:"Arrange Sehri for guests in your area"})]}),y&&e.jsx("p",{className:"mb-4 rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:y}),e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Email Address *"}),e.jsx("input",{type:"email",required:!0,placeholder:"your@email.com",className:J,value:n,onChange:R=>b(R.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Password *"}),e.jsx("input",{type:"password",required:!0,placeholder:"Min 6 characters",className:J,value:h,onChange:R=>v(R.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Full Name *"}),e.jsx("input",{type:"text",required:!0,placeholder:"Your name",className:J,value:F,onChange:R=>w(R.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Contact *"}),e.jsx("input",{type:"tel",required:!0,placeholder:"+91 XXXXX",className:J,value:k,onChange:R=>_(R.target.value)})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:["Place Name * ",e.jsx("span",{className:"font-normal text-slate-400",children:"(Masjid, Restaurant, etc.)"})]}),e.jsx("input",{type:"text",required:!0,placeholder:"e.g., Masjid-e-Khair",className:J,value:p,onChange:R=>m(R.target.value)})]})]}),e.jsxs("div",{className:"space-y-2 border-t border-slate-100 pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500",children:"Address Details"}),z&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(G,{size:10,className:"animate-spin"}),"Fetching location..."]}),!z&&O&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(ne,{size:10}),"Auto-filled"]})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Street / Door No",className:J,value:x,onChange:R=>C(R.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Area / Locality",className:J,value:A,onChange:R=>D(R.target.value)}),e.jsx("input",{type:"text",required:!0,placeholder:"City",className:J,value:O,onChange:R=>q(R.target.value)})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Pincode",className:J,value:L,onChange:R=>H(R.target.value)})]}),e.jsx("button",{type:"submit",disabled:u,className:"w-full rounded-xl bg-emerald-600 py-3 font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:bg-emerald-400",children:u?e.jsx(G,{className:"mx-auto animate-spin",size:20}):"Create Sehri Provider Account "}),e.jsxs("p",{className:"text-center text-xs text-slate-400",children:["Already have an account?"," ",e.jsx("button",{type:"button",onClick:()=>o(),className:"font-bold text-emerald-600 hover:underline",children:"Login"})]})]})]})]})}const Re=({children:s,className:l=""})=>e.jsx("div",{className:`rounded-[2rem] border border-slate-100 bg-white p-5 shadow-sm transition-all duration-500 hover:shadow-md ${l}`,children:s}),at=()=>e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2M7 2v20M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3zm0 0v7"})}),lt=()=>e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"})}),Ae=({value:s,duration:l=1500})=>{const[t,o]=a.useState(0);return a.useEffect(()=>{if(s===0)return;let c=0;const d=s,u=l/d,i=setInterval(()=>{c+=1,o(c),c>=d&&clearInterval(i)},Math.max(u,20));return()=>clearInterval(i)},[s,l]),e.jsx("span",{children:t})};function rt({ramzanTiming:s,onNavigate:l,city:t="Chennai",onRefresh:o}){const[c,d]=a.useState([]),[u,i]=a.useState(0),[y,j]=a.useState({seekers:0,providers:0,requests:0}),[n,b]=a.useState(null),[h,v]=a.useState([]),[F,w]=a.useState(!1);a.useEffect(()=>{const C=new Date("2026-02-19T00:00:00")-new Date,A=Math.ceil(C/(1e3*60*60*24));i(A>0?A:0)},[]),a.useEffect(()=>{(async()=>{const x=await ee.fetchHomeStats();j(x)})()},[]);const k=async m=>{b(m),w(!0);try{let x=[];m==="seekers"?x=await ee.fetchSeekers():m==="providers"?x=await ee.fetchProvidersList():m==="requests"&&(x=await ee.fetchSupportRequests()),v(x)}catch(x){console.error("Failed to load data:",x),v([])}w(!1)},_=()=>{b(null),v([])};a.useEffect(()=>{if(s){const m=new Date("2026-02-19"),C=Math.max(1,Math.ceil((new Date-m)/(1e3*60*60*24))+1),A=[];for(let D=0;D<3;D++){const O=new Date(m);O.setDate(m.getDate()+C-1+D),A.push({date:O.toLocaleDateString("en-US",{weekday:"short",day:"numeric"}),sehri:s.sehar_time,iftar:s.iftar_time})}d(A)}},[s]);const p=m=>{if(!m)return"--:--";const[x,C]=m.split(":"),A=parseInt(x),D=A>=12?"PM":"AM";return`${A%12||12}:${C} ${D}`};return e.jsxs("div",{className:"animate-in fade-in mx-auto max-w-md space-y-6 px-4 pb-12 duration-700",dir:"ltr",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-[2rem] bg-emerald-900 p-6 text-white shadow-xl shadow-emerald-900/10",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 opacity-10",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"24px 24px"}}),e.jsx("div",{className:"absolute -top-12 -right-12 h-32 w-32 rounded-full bg-emerald-400/20 blur-3xl"}),e.jsxs("div",{className:"relative z-10 space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/10 px-3 py-1 backdrop-blur-md",children:[e.jsx(Be,{size:12,className:"fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"text-[10px] font-black tracking-widest text-white uppercase",children:"Ramzan Hub"})]}),u>0&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[9px] font-black tracking-tighter text-emerald-300 uppercase",children:"Countdown"}),e.jsxs("p",{className:"text-lg leading-none font-black",children:[u," Days ",e.jsx("span",{className:"text-[10px] opacity-60",children:"Left"})]})]})]}),e.jsxs("h1",{className:"text-3xl leading-[0.95] font-black tracking-tighter",children:["NEVER FAST ",e.jsx("br",{}),e.jsx("span",{className:"text-emerald-400",children:"ALONE."})]}),e.jsxs("p",{className:"max-w-[240px] text-xs leading-relaxed font-medium text-emerald-100/70",children:["Discover local Sehri points and support fasting brothers in ",t,"."]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs("button",{onClick:()=>l("find"),className:"flex flex-1 items-center justify-center gap-2 rounded-xl bg-white px-4 py-3 text-xs font-black text-emerald-900 transition-all active:scale-95",children:[e.jsx(at,{})," Find Sehri"]}),e.jsxs("button",{onClick:()=>l("request"),className:"flex flex-1 items-center justify-center gap-2 rounded-xl border border-white/20 bg-emerald-800/40 px-4 py-3 text-xs font-black text-white active:scale-95",children:[e.jsx(lt,{})," Support"]})]})]})]}),e.jsxs(Re,{className:"!p-5",children:[e.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[e.jsx(De,{size:16,className:"text-emerald-600"}),e.jsx("h3",{className:"text-xs font-black text-slate-900 uppercase",children:"Our Purpose"})]}),e.jsx("p",{className:"text-xs leading-relaxed text-slate-500",children:"While Iftar is usually shared, Sehri can be lonely and difficult for students and hostelers. We connect those who need a meal with those who provide it."})]}),e.jsxs("section",{className:"space-y-3",children:[e.jsx("h3",{className:"px-1 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Upcoming Timings"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:c.map((m,x)=>e.jsxs("div",{className:"flex flex-col items-center rounded-2xl border border-slate-100 bg-slate-50 p-3 text-center",children:[e.jsx("p",{className:"mb-2 text-[8px] font-black text-slate-400 uppercase",children:m.date}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[7px] leading-none font-bold text-slate-400 uppercase",children:"Sehri"}),e.jsx("p",{className:"text-[10px] font-black text-slate-900",children:p(m.sehri).replace(" AM","")})]}),e.jsx("div",{className:"mx-auto h-[1px] w-4 bg-slate-200"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[7px] leading-none font-bold text-slate-400 uppercase",children:"Iftar"}),e.jsx("p",{className:"text-[10px] font-black text-emerald-600",children:p(m.iftar).replace(" PM","")})]})]})]},x))})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("button",{onClick:()=>k("seekers"),className:"flex flex-col items-center space-y-1 rounded-2xl border border-emerald-100 bg-emerald-50/50 p-3 text-center transition-all hover:shadow-md active:scale-95",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-white text-emerald-600 shadow-sm",children:e.jsx(de,{size:16})}),e.jsx("p",{className:"text-lg font-black text-emerald-700",children:e.jsx(Ae,{value:y.seekers})}),e.jsx("p",{className:"text-[8px] font-black text-slate-600 uppercase",children:"Seekers"})]}),e.jsxs("button",{onClick:()=>k("providers"),className:"flex flex-col items-center space-y-1 rounded-2xl border border-amber-100 bg-amber-50/50 p-3 text-center transition-all hover:shadow-md active:scale-95",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-white text-amber-600 shadow-sm",children:e.jsx(Se,{size:16})}),e.jsx("p",{className:"text-lg font-black text-amber-700",children:e.jsx(Ae,{value:y.providers})}),e.jsx("p",{className:"text-[8px] font-black text-slate-600 uppercase",children:"Providers"})]}),e.jsxs("button",{onClick:()=>k("requests"),className:"flex flex-col items-center space-y-1 rounded-2xl border border-blue-100 bg-blue-50/50 p-3 text-center transition-all hover:shadow-md active:scale-95",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-white text-blue-600 shadow-sm",children:e.jsx(us,{size:16})}),e.jsx("p",{className:"text-lg font-black text-blue-700",children:e.jsx(Ae,{value:y.requests})}),e.jsx("p",{className:"text-[8px] font-black text-slate-600 uppercase",children:"Requests"})]})]}),e.jsxs(Re,{className:"border-amber-200 bg-amber-50/30 !p-5",children:[e.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[e.jsx(hs,{size:16,className:"text-amber-600"}),e.jsx("h3",{className:"text-xs font-black text-slate-900 uppercase",children:"Spread the Word (Sadaqah Jariyah)"})]}),e.jsx("p",{className:"mb-4 text-xs leading-relaxed text-slate-500",children:"Help bachelors and travelers find Sehri. Download our poster and paste it on **Masjid notice boards** or share it in your **local WhatsApp groups**."}),e.jsxs("a",{href:"/poster.pdf",download:!0,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-amber-500 py-3 text-[10px] font-black tracking-widest text-white uppercase shadow-sm transition-all hover:bg-amber-600 active:scale-95",children:[e.jsx(ps,{size:14})," Download PDF Poster"]})]}),e.jsxs(Re,{className:"border-dashed border-emerald-200 bg-emerald-50/30 !p-5",children:[e.jsxs("div",{className:"mb-3 flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-emerald-600 text-white",children:e.jsx(Le,{size:20})}),e.jsx("h4",{className:"text-xs font-black text-slate-900 uppercase",children:"Are you a provider?"})]}),e.jsx("p",{className:"mb-4 text-xs leading-relaxed text-slate-500",children:"If your Masjid or group is serving Sehri, please register your location to help others find you."}),e.jsxs("button",{onClick:()=>l("join"),className:"flex w-full items-center justify-center gap-2 rounded-xl border border-emerald-200 bg-white py-3 text-[10px] font-black tracking-widest text-emerald-600 uppercase active:scale-95",children:["Register Now ",e.jsx(qe,{size:14})]})]}),e.jsx("footer",{className:"py-4 text-center",children:e.jsx("p",{className:"text-[8px] font-black tracking-[0.3em] text-slate-300 uppercase",children:"Â© 2026 Ramzania.com â€” Ummah Connected"})}),n&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:_,children:e.jsxs("div",{className:"max-h-[80vh] w-full max-w-md overflow-hidden rounded-3xl bg-white shadow-2xl",onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 p-4",children:[e.jsxs("h3",{className:"text-sm font-black text-slate-900 uppercase",children:[n==="seekers"&&"Registered Seekers",n==="providers"&&"Registered Providers",n==="requests"&&"Support Requests"]}),e.jsx("button",{onClick:_,className:"rounded-lg p-1 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(ce,{size:20})})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto p-4",children:F?e.jsx("div",{className:"py-8 text-center",children:e.jsx("p",{className:"text-sm text-slate-500",children:"Loading..."})}):h.length===0?e.jsx("div",{className:"py-8 text-center",children:e.jsx("p",{className:"text-sm text-slate-500",children:"No data found"})}):e.jsx("div",{className:"space-y-2",children:h.map(m=>e.jsx("div",{className:"rounded-lg border border-slate-100 bg-slate-50 px-3 py-2",children:n==="providers"?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:m.place_name||m.name}),e.jsxs("div",{className:"mt-1 flex flex-wrap gap-1.5 text-[9px] text-slate-500",children:[m.contact&&e.jsx("span",{className:"rounded bg-emerald-100 px-1.5 py-0.5 text-emerald-700",children:m.contact}),m.area&&e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5",children:m.area}),m.city&&e.jsx("span",{className:"rounded bg-blue-100 px-1.5 py-0.5 text-blue-700",children:m.city}),m.pincode&&e.jsx("span",{className:"rounded bg-amber-100 px-1.5 py-0.5 text-amber-700",children:m.pincode})]})]}):n==="requests"?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:m.name}),e.jsxs("div",{className:"mt-1 flex flex-wrap gap-1.5 text-[9px] text-slate-500",children:[m.area&&e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5",children:m.area}),m.address&&e.jsx("span",{className:"max-w-[150px] truncate rounded bg-blue-100 px-1.5 py-0.5 text-blue-700",children:m.address})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:m.name}),e.jsxs("div",{className:"mt-1 flex flex-wrap gap-1.5 text-[9px] text-slate-500",children:[m.area&&e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5",children:m.area}),m.place_name&&e.jsx("span",{className:"rounded bg-emerald-100 px-1.5 py-0.5 text-emerald-700",children:m.place_name}),m.city&&e.jsx("span",{className:"rounded bg-blue-100 px-1.5 py-0.5 text-blue-700",children:m.city}),m.pincode&&e.jsx("span",{className:"rounded bg-amber-100 px-1.5 py-0.5 text-amber-700",children:m.pincode})]})]})},m.id))})})]})})]})}function nt(){const[s,l]=a.useState([]),[t,o]=a.useState(!0),[c,d]=a.useState(null),u=n=>{const b=["th","st","nd","rd"],h=n%100;return n+(b[(h-20)%10]||b[h]||b[0])},i=async()=>{o(!0);try{const n=await Ts();n.success?l(n.bookings||[]):f.error(n.message||"Failed to load bookings")}catch{f.error("Failed to load bookings")}finally{o(!1)}};a.useEffect(()=>{i()},[]);const y=async n=>{if(globalThis.confirm("Are you sure you want to cancel this booking?")){d(n);try{const b=await Is(n);b.success?(f.success("Booking cancelled"),l(h=>h.map(v=>v.id===n?{...v,status:"cancelled"}:v))):f.error(b.message||"Failed to cancel")}catch{f.error("Failed to cancel booking")}finally{d(null)}}},j=n=>{switch(n){case"confirmed":return"bg-emerald-100 text-emerald-700";case"completed":return"bg-blue-100 text-blue-700";case"cancelled":return"bg-red-100 text-red-700";default:return"bg-slate-100 text-slate-700"}};return t?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(G,{size:32,className:"animate-spin text-emerald-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-slate-900",children:"My Reservations"}),e.jsxs("p",{className:"text-xs text-slate-500",children:[s.length," Sehri reservation(s)"]})]}),e.jsx("button",{onClick:i,className:"rounded-lg bg-slate-100 p-2 text-slate-600 transition-all hover:bg-slate-200 active:scale-95",children:e.jsx(He,{size:16})})]}),s.length===0?e.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-16 text-center",children:[e.jsx($e,{size:48,className:"mx-auto mb-4 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-600",children:"No Sehri reservations yet"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Browse hosts & reserve your Sehri from Home"})]}):e.jsx("div",{className:"space-y-4",children:s.map(n=>e.jsxs("div",{className:`rounded-2xl border bg-white p-4 shadow-sm ${n.status==="cancelled"?"border-slate-200 opacity-60":"border-slate-100"}`,children:[e.jsxs("div",{className:"mb-3 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-black text-slate-900",children:n.provider_name}),e.jsxs("div",{className:"mt-1 flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(ne,{size:12}),n.area]})]}),e.jsx("span",{className:`rounded-lg px-2 py-1 text-[10px] font-bold uppercase ${j(n.status)}`,children:n.status})]}),e.jsxs("div",{className:"rounded-xl bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 font-bold text-emerald-700",children:[u(n.ramzan_day)," Ramzan"]}),e.jsxs("span",{className:"flex items-center gap-1 text-slate-500",children:[e.jsx(he,{size:12}),n.formatted_date]}),e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5 text-[10px] font-bold text-slate-600",children:n.meal_type})]}),n.timing&&e.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-slate-500",children:[e.jsx(oe,{size:12}),n.timing]}),e.jsxs("p",{className:"mt-2 text-xs text-slate-500 italic",children:['"',n.menu_items,'"']})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-600",children:[e.jsxs("span",{className:"font-bold",children:["ðŸ‘¥ ",n.quantity," person(s)"]}),e.jsx("span",{className:"font-bold",children:n.price_type==="free"||n.total_amount===0?"ðŸ†“ Free":`ðŸ’° â‚¹${n.total_amount}`})]}),e.jsx("span",{className:"rounded bg-slate-100 px-2 py-1 font-mono text-[10px] text-slate-500",children:n.booking_code})]}),n.status==="confirmed"&&e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs("a",{href:`tel:${n.provider_phone}`,className:"flex flex-1 items-center justify-center gap-1.5 rounded-xl border border-slate-200 bg-white py-2 text-xs font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-95",children:[e.jsx(ze,{size:14})," Call Host"]}),e.jsxs("button",{onClick:()=>y(n.id),disabled:c===n.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-xs font-bold text-red-600 transition-all hover:bg-red-100 active:scale-95 disabled:opacity-50",children:[c===n.id?e.jsx(G,{size:14,className:"animate-spin"}):e.jsx(ce,{size:14}),"Cancel"]})]}),e.jsxs("p",{className:"mt-3 text-[10px] text-slate-400",children:["Booked on ",n.booked_at]})]},n.id))})]})}const me={LIST:"/offerings",CREATE:"/offerings",BULK_CREATE:"/offerings/bulk",UPDATE:s=>`/offerings/${s}`,DELETE:s=>`/offerings/${s}`,STATS:"/offerings/stats"},ue={getAll:async()=>$.get(me.LIST),create:async s=>$.post(me.CREATE,s),bulkCreate:async s=>$.post(me.BULK_CREATE,{offerings:s}),update:async(s,l)=>$.put(me.UPDATE(s),l),delete:async s=>$.delete(me.DELETE(s)),getStats:async()=>$.get(me.STATS)},we=30,it=new Date("2026-02-19"),ot=()=>Array.from({length:we},(s,l)=>{const t=l+1,o=new Date(it);return o.setDate(o.getDate()+l),{day:t,date:o,dateStr:o.toLocaleDateString("en-IN",{day:"numeric",month:"short"}),fullDate:o.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})}}),Oe=ot();function ct({onClose:s,onSave:l,editingPoint:t,loading:o}){var V,se,te,ae;const[c,d]=a.useState("single"),[u,i]=a.useState(t?[t.ramzan_day]:[1]),[y]=a.useState("sehar"),[j,n]=a.useState((t==null?void 0:t.menu_items)||""),[b,h]=a.useState(((V=t==null?void 0:t.capacity)==null?void 0:V.toString())||"50"),[v,F]=a.useState((t==null?void 0:t.price_type)||"free"),[w,k]=a.useState(((se=t==null?void 0:t.price_amount)==null?void 0:se.toString())||""),[_,p]=a.useState(((te=t==null?void 0:t.timing_from)==null?void 0:te.slice(0,5))||"04:00"),[m,x]=a.useState(((ae=t==null?void 0:t.timing_to)==null?void 0:ae.slice(0,5))||"05:30"),[C,A]=a.useState((t==null?void 0:t.message)||""),D="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",O="w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",q=z=>{i(c==="single"?[z]:U=>U.includes(z)?U.filter(K=>K!==z):[...U,z])},L=()=>{u.length===we?i([]):i(Array.from({length:we},(z,U)=>U+1))},H=z=>{if(z.preventDefault(),u.length===0){f.error("Please select at least one day");return}if(!j.trim()){f.error("Please enter menu items");return}const U={meal_type:y,menu_items:j.trim(),capacity:Number.parseInt(b)||50,price_type:v,price_amount:v==="paid"?Number.parseFloat(w)||0:null,timing_from:_,timing_to:m,message:C.trim()||null};if(t)l({...U,id:t.id});else if(c==="single")l({...U,ramzan_day:u[0]});else{const K=u.map(Q=>({...U,ramzan_day:Q}));l({bulk:!0,offerings:K})}};return e.jsx("div",{className:"fixed inset-0 z-100 flex items-start justify-center overflow-y-auto bg-slate-900/40 px-4 pt-4 pb-24 backdrop-blur-sm sm:items-center sm:pb-4",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-4 sm:slide-in-from-bottom-0 sm:zoom-in-95 w-full max-w-lg rounded-2xl bg-white p-6 shadow-xl sm:my-auto",children:[e.jsxs("div",{className:"mb-5 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-black text-slate-900",children:[t?"Edit":"Add"," Sehar Offering"]}),e.jsx("button",{onClick:s,className:"rounded-full p-1.5 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(ce,{size:18})})]}),e.jsxs("form",{onSubmit:H,className:"space-y-4",children:[!t&&e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{type:"button",onClick:()=>{d("single"),i([1])},className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${c==="single"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Single Day"}),e.jsx("button",{type:"button",onClick:()=>d("bulk"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${c==="bulk"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Multiple Days"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsxs("label",{className:"block text-xs font-bold text-slate-500",children:[e.jsx(he,{size:12,className:"mr-1 inline"}),c==="single"?"Select Ramzan Day":"Select Days"]}),c==="bulk"&&!t&&e.jsx("button",{type:"button",onClick:L,className:"text-[10px] font-bold text-emerald-600 hover:underline",children:u.length===we?"Deselect All":"Select All"})]}),c==="single"||t?e.jsx("select",{value:u[0],onChange:z=>i([Number.parseInt(z.target.value)]),className:D,disabled:!!t,children:Oe.map(z=>e.jsxs("option",{value:z.day,children:["Day ",z.day," - ",z.fullDate]},z.day))}):e.jsx("div",{className:"grid max-h-32 grid-cols-5 gap-1.5 overflow-y-auto rounded-xl border border-slate-200 bg-slate-50 p-2",children:Oe.map(z=>e.jsx("button",{type:"button",onClick:()=>q(z.day),className:`rounded-lg px-2 py-1.5 text-[10px] font-bold transition-all ${u.includes(z.day)?"bg-emerald-600 text-white":"bg-white text-slate-600 hover:bg-emerald-50"}`,children:z.day},z.day))}),c==="bulk"&&u.length>0&&e.jsxs("p",{className:"mt-1 text-[10px] text-emerald-600",children:[u.length," days selected"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(Ce,{size:12,className:"mr-1 inline"}),"Meal Type"]}),e.jsx("div",{className:"rounded-xl border border-slate-200 bg-emerald-50 px-4 py-3 text-sm font-bold text-emerald-700",children:"Sehar (Pre-dawn meal)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Menu Items *"}),e.jsx("textarea",{required:!0,placeholder:"e.g., Biryani, Kheer, Dates, Rooh Afza, Chai...",className:D+" resize-none",rows:2,value:j,onChange:z=>n(z.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(de,{size:12,className:"mr-1 inline"}),"Capacity *"]}),e.jsx("input",{type:"number",required:!0,min:"1",max:"10000",placeholder:"No. of people",className:O,value:b,onChange:z=>h(z.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(js,{size:12,className:"mr-1 inline"}),"Price Type"]}),e.jsxs("select",{value:v,onChange:z=>F(z.target.value),className:O,children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"paid",children:"Paid"})]})]})]}),v==="paid"&&e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Amount per person (â‚¹)"}),e.jsx("input",{type:"number",required:!0,min:"1",placeholder:"Enter amount",className:O,value:w,onChange:z=>k(z.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(oe,{size:12,className:"mr-1 inline"}),"Service Timings"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"time",className:O,value:_,onChange:z=>p(z.target.value)}),e.jsx("input",{type:"time",className:O,value:m,onChange:z=>x(z.target.value)})]}),e.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"From - To (e.g., 4:00 AM - 5:30 AM)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(Ve,{size:12,className:"mr-1 inline"}),"Additional Message (Optional)"]}),e.jsx("textarea",{placeholder:"Any special instructions or notes...",className:D+" resize-none",rows:2,value:C,onChange:z=>A(z.target.value)})]}),e.jsx("button",{type:"submit",disabled:o,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",children:o?e.jsxs(e.Fragment,{children:[e.jsx(G,{size:16,className:"animate-spin"}),"Saving..."]}):t?"Update Sehri Offering":c==="bulk"?`Add ${u.length} Sehri Offering${u.length>1?"s":""}`:"Add Sehri Offering"})]})]})})}function dt({user:s}){const[l,t]=a.useState("offerings"),[o,c]=a.useState(!1),[d,u]=a.useState(null),[i,y]=a.useState([]),[j,n]=a.useState([]),[b,h]=a.useState({total:0,confirmed:0,completed:0,cancelled:0}),[v,F]=a.useState("all"),[w,k]=a.useState(!1),[_,p]=a.useState(!1),[m,x]=a.useState(!1),[C,A]=a.useState(null),[D,O]=a.useState({total_offerings:0,total_capacity:0,total_booked:0});a.useEffect(()=>{q(),L(),H()},[]),a.useEffect(()=>{H()},[v]);const q=async()=>{k(!0);try{const r=await ue.getAll();r.success&&y(r.offerings||[])}catch{f.error("Failed to load offerings")}finally{k(!1)}},L=async()=>{try{const r=await ue.getStats();r.success&&O(r.stats)}catch(r){console.error("Failed to load stats",r)}},H=async()=>{p(!0);try{const r=await $s(v);r.success&&(n(r.bookings||[]),r.stats&&h(r.stats))}catch{f.error("Failed to load bookings")}finally{p(!1)}},V=async(r,P)=>{A(r);try{const I=await qs(r,P);I.success?(f.success("Status updated"),n(le=>le.map(X=>X.id===r?{...X,status:P}:X)),await H(),await L()):f.error(I.message||"Failed to update status")}catch{f.error("Failed to update status")}finally{A(null)}},se=D.total_offerings||i.length,te=b.total||0,ae=b.confirmed||0,z=async r=>{x(!0);try{if(r.bulk){const P=await ue.bulkCreate(r.offerings);P.success?(f.success(`${P.created_count} offerings created successfully!`),await q(),await L(),c(!1)):f.error(P.message||"Failed to create offerings")}else if(r.id){const P=await ue.update(r.id,r);P.success?(f.success("Offering updated successfully"),await q(),await L(),c(!1)):f.error(P.message||"Failed to update offering")}else{const P=await ue.create(r);P.success?(f.success("Offering created successfully"),await q(),await L(),c(!1)):f.error(P.message||"Failed to create offering")}}catch(P){f.error(P.message||"An error occurred")}finally{x(!1),u(null)}},U=async r=>{if(window.confirm("Delete this food offering?"))try{const P=await ue.delete(r);P.success?(f.success("Offering deleted"),await q(),await L()):f.error(P.message||"Failed to delete")}catch{f.error("Failed to delete offering")}},K=r=>{switch(r){case"confirmed":return"bg-emerald-50 text-emerald-600";case"completed":return"bg-blue-50 text-blue-600";case"cancelled":return"bg-red-50 text-red-500";default:return"bg-slate-100 text-slate-500"}},Q=r=>{const P=["th","st","nd","rd"],I=r%100;return r+(P[(I-20)%10]||P[I]||P[0])};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-slate-900",children:"Host Dashboard"}),e.jsx("p",{className:"text-xs font-medium text-slate-500",children:(s==null?void 0:s.place_name)||"Manage your Sehri distribution"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"rounded-xl bg-emerald-50 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-emerald-600",children:se}),e.jsx("p",{className:"text-[10px] font-bold text-emerald-700 uppercase",children:"Offerings"})]}),e.jsxs("div",{className:"rounded-xl bg-slate-100 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-slate-700",children:te}),e.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:"Bookings"})]}),e.jsxs("div",{className:"rounded-xl bg-blue-50 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-blue-600",children:ae}),e.jsx("p",{className:"text-[10px] font-bold text-blue-700 uppercase",children:"Confirmed"})]})]}),e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{onClick:()=>t("offerings"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${l==="offerings"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Sehri Offerings"}),e.jsx("button",{onClick:()=>t("bookings"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${l==="bookings"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Bookings"})]}),l==="offerings"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-bold text-slate-700",children:"My Sehri Offerings"}),e.jsxs("button",{onClick:()=>{u(null),c(!0)},className:"flex items-center gap-1.5 rounded-lg bg-emerald-600 px-3 py-2 text-xs font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:[e.jsx(Le,{size:14}),"Add Sehri Offering"]})]}),w?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(G,{size:24,className:"animate-spin text-emerald-600"})}):e.jsx("div",{className:"space-y-3",children:i.length>0?i.sort((r,P)=>r.ramzan_day-P.ramzan_day).map(r=>{var I,le;const P=Oe.find(X=>X.day===r.ramzan_day);return e.jsxs("div",{className:"rounded-xl border border-slate-100 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 text-xs font-black text-emerald-700",children:[Q(r.ramzan_day)," Ramzan"]}),e.jsx("span",{className:"text-[10px] text-slate-400",children:P==null?void 0:P.fullDate}),e.jsx("span",{className:"rounded bg-slate-100 px-1.5 py-0.5 text-[9px] font-bold text-slate-600 uppercase",children:r.meal_type})]}),e.jsx("span",{className:`rounded-lg px-2 py-0.5 text-[9px] font-black uppercase ${r.price_type==="free"?"bg-emerald-50 text-emerald-600":"bg-amber-50 text-amber-600"}`,children:r.price_type==="free"?"Free":`â‚¹${r.price_amount}`})]}),e.jsxs("p",{className:"mt-2 text-xs text-slate-600 italic",children:['"',r.menu_items,'"']}),r.message&&e.jsxs("p",{className:"mt-1 text-[10px] text-slate-400",children:["ðŸ’¬ ",r.message]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-3 text-[10px] text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(de,{size:10}),r.booked_count||0,"/",r.capacity]}),e.jsx("span",{className:`${(r.booked_count||0)>=r.capacity?"text-red-500":"text-emerald-600"}`,children:(r.booked_count||0)>=r.capacity?"Full":`${r.capacity-(r.booked_count||0)} left`}),r.timing_from&&r.timing_to&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(oe,{size:10}),(I=r.timing_from)==null?void 0:I.slice(0,5)," - ",(le=r.timing_to)==null?void 0:le.slice(0,5)]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between border-t border-slate-50 pt-3",children:[e.jsx("span",{className:`rounded px-1.5 py-0.5 text-[9px] font-bold uppercase ${r.status==="active"?"bg-emerald-50 text-emerald-600":"bg-slate-100 text-slate-500"}`,children:r.status}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>{u(r),c(!0)},className:"rounded-lg p-1.5 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(fs,{size:14})}),e.jsx("button",{onClick:()=>U(r.id),className:"rounded-lg p-1.5 text-slate-400 hover:bg-red-50 hover:text-red-500",children:e.jsx(gs,{size:14})})]})]})]},r.id)}):e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-12 text-center",children:[e.jsx(Ce,{size:32,className:"mx-auto mb-3 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-500",children:"No offerings yet"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Add food offerings for specific Ramzan days"})]})})]}),l==="bookings"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-bold text-slate-700",children:"Manage Bookings"}),e.jsxs("button",{onClick:H,disabled:_,className:"flex items-center gap-1.5 rounded-lg bg-slate-100 px-3 py-2 text-xs font-bold text-slate-600 transition-all hover:bg-slate-200 active:scale-95 disabled:opacity-50",children:[e.jsx(He,{size:14,className:_?"animate-spin":""}),"Refresh"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"all",label:"All",count:b.total},{value:"confirmed",label:"Confirmed",count:b.confirmed},{value:"completed",label:"Completed",count:b.completed},{value:"cancelled",label:"Cancelled",count:b.cancelled}].map(r=>e.jsxs("button",{onClick:()=>F(r.value),className:`rounded-lg px-3 py-1.5 text-[10px] font-bold transition-all ${v===r.value?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[r.label," (",r.count||0,")"]},r.value))}),_?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(G,{size:24,className:"animate-spin text-emerald-600"})}):e.jsx("div",{className:"space-y-3",children:j.length>0?j.map(r=>{var P,I;return e.jsxs("div",{className:`rounded-xl border bg-white p-4 transition-all ${r.status==="cancelled"?"border-slate-200 opacity-70":"border-slate-100"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900",children:r.seeker_name}),e.jsxs("div",{className:"mt-1 flex flex-col gap-1 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{size:12}),e.jsx("a",{href:`tel:${r.seeker_phone}`,className:"hover:text-emerald-600",children:r.seeker_phone})]}),r.seeker_email&&e.jsx("span",{className:"text-[10px] text-slate-400",children:r.seeker_email})]})]}),e.jsx("span",{className:`rounded-lg px-2 py-1 text-[10px] font-bold uppercase ${K(r.status)}`,children:r.status})]}),r.menu_items&&e.jsxs("p",{className:"mt-2 text-xs text-slate-500 italic",children:['"',r.menu_items,'"']}),e.jsxs("div",{className:"mt-3 rounded-lg bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 font-bold text-emerald-700",children:[Q(r.ramzan_day)," Ramzan"]}),e.jsxs("span",{className:"flex items-center gap-1 text-slate-500",children:[e.jsx(he,{size:12}),r.formatted_date]}),e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5 text-[10px] font-bold text-slate-600 uppercase",children:r.meal_type})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs text-slate-600",children:[e.jsxs("span",{className:"flex items-center gap-1 font-bold",children:[e.jsx(de,{size:12}),r.quantity," person(s)"]}),e.jsx("span",{className:"font-bold",children:r.total_amount>0?`â‚¹${r.total_amount}`:"Free"}),r.timing_from&&r.timing_to&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(oe,{size:12}),(P=r.timing_from)==null?void 0:P.slice(0,5)," - ",(I=r.timing_to)==null?void 0:I.slice(0,5)]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsx("span",{className:"rounded bg-slate-100 px-2 py-1 font-mono text-[10px] text-slate-500",children:r.booking_code}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:["Booked: ",new Date(r.created_at).toLocaleDateString("en-IN")]})]}),r.status==="confirmed"&&e.jsxs("div",{className:"mt-4 flex gap-2 border-t border-slate-100 pt-4",children:[e.jsxs("button",{onClick:()=>V(r.id,"completed"),disabled:C===r.id,className:"flex flex-1 items-center justify-center gap-1.5 rounded-xl bg-emerald-600 py-2 text-xs font-bold text-white transition-all hover:bg-emerald-700 active:scale-95 disabled:opacity-50",children:[C===r.id?e.jsx(G,{size:14,className:"animate-spin"}):e.jsx(ke,{size:14}),"Mark Completed"]}),e.jsxs("button",{onClick:()=>V(r.id,"cancelled"),disabled:C===r.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-xs font-bold text-red-600 transition-all hover:bg-red-100 active:scale-95 disabled:opacity-50",children:[e.jsx(bs,{size:14}),"Cancel"]})]}),r.status==="cancelled"&&e.jsx("div",{className:"mt-3 border-t border-slate-100 pt-3",children:e.jsxs("button",{onClick:()=>V(r.id,"confirmed"),disabled:C===r.id,className:"flex items-center gap-1.5 text-xs font-bold text-emerald-600 hover:text-emerald-700",children:[C===r.id?e.jsx(G,{size:12,className:"animate-spin"}):e.jsx(Ge,{size:12}),"Restore Booking"]})})]},r.id)}):e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-12 text-center",children:[e.jsx(de,{size:32,className:"mx-auto mb-3 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-500",children:v==="all"?"No bookings yet":`No ${v} bookings`}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Guest reservations will appear here"})]})})]}),o&&e.jsx(ct,{onClose:()=>{c(!1),u(null)},onSave:z,editingPoint:d,loading:m})]})}const Ue="ramzania_support_request",xt=()=>{const s=localStorage.getItem(Ue);if(!s)return!1;const{date:l}=JSON.parse(s);return l===new Date().toDateString()},mt=s=>{localStorage.setItem(Ue,JSON.stringify({date:new Date().toDateString(),requestId:s}))},ie=({label:s,icon:l,required:t,children:o})=>e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"ml-1 flex items-center gap-2 text-xs font-black tracking-wider text-slate-400 uppercase",children:[l&&e.jsx(l,{size:14,className:"text-emerald-500"}),s," ",t&&e.jsx("span",{className:"text-rose-500",children:"*"})]}),o]});function ut({user:s,onNavigate:l}){const[t,o]=a.useState({name:(s==null?void 0:s.name)||"",phone:(s==null?void 0:s.contact)||"",email:"",area:"",address:"",family_size:"1",days_needed:"",message:""}),[c,d]=a.useState(!1),[u,i]=a.useState(!1);a.useEffect(()=>{xt()&&i(!0)},[]);const y=b=>{const{name:h,value:v}=b.target;o(F=>({...F,[h]:v}))},j=async b=>{if(b.preventDefault(),!t.name||!t.phone||!t.area){f.error("Missing Required Fields");return}d(!0);try{const h=await $.post("/support-requests",{...t,user_id:(s==null?void 0:s.id)||null}),v=h.data||h;(v.success||v.request_id)&&(mt(v.request_id),i(!0),f.success("Request sent successfully"))}catch{f.error("Submission failed")}finally{d(!1)}};if(u)return e.jsxs("div",{className:"animate-in zoom-in-95 flex min-h-[60vh] flex-col items-center justify-center p-6 text-center duration-500",children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"absolute inset-0 animate-ping rounded-full bg-emerald-200 opacity-20"}),e.jsx("div",{className:"relative flex h-20 w-20 items-center justify-center rounded-full bg-emerald-100 shadow-inner",children:e.jsx(ke,{size:40,className:"text-emerald-600"})})]}),e.jsx("h2",{className:"text-2xl font-black tracking-tight text-slate-900",children:"Request Received!"}),e.jsx("p",{className:"mt-3 text-sm leading-relaxed text-slate-500",children:"We have shared your details with our community volunteers. Expect a call for your Sehri arrangements soon."}),e.jsx("button",{onClick:()=>l("find"),className:"mt-8 w-full max-w-xs rounded-2xl bg-emerald-600 py-4 font-black text-white shadow-xl shadow-emerald-200 transition-all active:scale-95",children:"Return to Home"})]});const n="w-full rounded-2xl border-none bg-slate-100 px-4 py-3 text-sm font-semibold text-slate-800 ring-2 ring-transparent transition-all placeholder:text-slate-400 placeholder:font-normal focus:bg-white focus:ring-emerald-500/30 focus:shadow-sm";return e.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 space-y-6 pb-12 duration-700",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-[2.5rem] bg-emerald-900 p-8 text-white shadow-2xl",children:[e.jsxs("div",{className:"relative z-10 pt-3",children:[e.jsxs("h1",{className:"text-3xl font-black tracking-tighter",children:["NEED ",e.jsx("span",{className:"text-emerald-400",children:"SEHRI?"})]}),e.jsxs("p",{className:"mt-2 text-xs leading-relaxed font-medium text-emerald-100/60",children:["Can't find a provider? Let us know. ",e.jsx("br",{})," Our volunteers are ready to help."]})]}),e.jsx("div",{className:"absolute -right-10 -bottom-10 h-40 w-40 rounded-full bg-emerald-400/10 blur-3xl"})]}),e.jsx("div",{className:"-mt-10 rounded-[2.5rem] border border-slate-50 bg-white p-6 shadow-xl",children:e.jsxs("form",{onSubmit:j,className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-5",children:[e.jsx(ie,{label:"Full Name",icon:Ns,required:!0,children:e.jsx("input",{type:"text",name:"name",value:t.name,onChange:y,placeholder:"Your Name",className:n,required:!0})}),e.jsx(ie,{label:"Contact Number",icon:ze,required:!0,children:e.jsx("input",{type:"tel",name:"phone",value:t.phone,onChange:y,placeholder:"+91 XXXXX XXXXX",className:n,required:!0})}),e.jsx(ie,{label:"Email Address",icon:ys,children:e.jsx("input",{type:"email",name:"email",value:t.email,onChange:y,placeholder:"Optional",className:n})}),e.jsx("div",{className:"my-2 h-px w-full bg-slate-100"}),e.jsx(ie,{label:"Area / Locality",icon:ne,required:!0,children:e.jsx("input",{type:"text",name:"area",value:t.area,onChange:y,placeholder:"e.g. Anna Nagar",className:n,required:!0})}),e.jsx(ie,{label:"Exact Address",icon:Me,children:e.jsx("textarea",{name:"address",value:t.address,onChange:y,placeholder:"Flat/House No, Landmark...",rows:2,className:`${n} resize-none`})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(ie,{label:"People",icon:de,children:e.jsxs("select",{name:"family_size",value:t.family_size,onChange:y,className:n,children:[e.jsx("option",{value:"1",children:"1 Person"}),e.jsx("option",{value:"2",children:"2 People"}),e.jsx("option",{value:"3",children:"3 People"}),e.jsx("option",{value:"4",children:"4 People"}),e.jsx("option",{value:"5+",children:"5+ People"})]})})}),e.jsx("div",{className:"flex-1",children:e.jsx(ie,{label:"Duration",icon:he,children:e.jsx("input",{type:"text",name:"days_needed",value:t.days_needed,onChange:y,placeholder:"e.g. 10 days",className:n})})})]}),e.jsx(ie,{label:"Special Message",icon:Ve,children:e.jsx("textarea",{name:"message",value:t.message,onChange:y,placeholder:"Any dietary needs or notes?",rows:3,className:`${n} resize-none`})})]}),e.jsxs("button",{type:"submit",disabled:c,className:"group relative w-full overflow-hidden rounded-2xl bg-emerald-600 py-4 font-black tracking-widest text-white shadow-lg shadow-emerald-200 transition-all active:scale-[0.97] disabled:opacity-70",children:[e.jsxs("span",{className:"relative z-10 flex items-center justify-center gap-2 text-xs uppercase",children:[c?"Processing...":"Send Assistance Request",!c&&e.jsx(ke,{size:16,className:"opacity-50 transition-opacity group-hover:opacity-100"})]}),e.jsx("div",{className:"absolute inset-0 -translate-x-full bg-gradient-to-r from-transparent via-white/10 to-transparent transition-transform duration-1000 group-hover:translate-x-full"})]}),e.jsx("p",{className:"text-center text-[10px] font-bold tracking-widest text-slate-300 uppercase",children:"One request allowed per 24 hours"})]})})]})}function ht({message:s,onClose:l}){return s?e.jsxs("div",{className:"animate-in fade-in slide-in-from-top-10 fixed top-8 left-1/2 z-[200] flex -translate-x-1/2 items-center gap-3 rounded-full bg-slate-950 px-8 py-4 text-white shadow-2xl",children:[e.jsx(ke,{className:"text-emerald-400",size:18}),e.jsx("span",{className:"text-sm font-black tracking-tight",children:s}),e.jsx("button",{onClick:l,className:"text-slate-500 transition-colors hover:text-white",children:e.jsx(ce,{size:16})})]}):null}const ye="ramzania_user_location";async function pt(s,l){try{const o=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${l}&zoom=14&addressdetails=1`,{headers:{"Accept-Language":"en"}})).json();if(o&&o.address){const{suburb:c,neighbourhood:d,city:u,town:i,village:y,state_district:j,state:n,country:b}=o.address;return{raw:o,area:c||d||u||i||y||j||""||"Unknown Area",fullAddress:o.display_name||"",city:u||i||y||j||"",state:n||"",country:b||"",addressDetails:o.address}}return null}catch(t){return console.error("Reverse geocoding failed:",t),null}}function ft(){const[s,l]=a.useState(null),[t,o]=a.useState(null),[c,d]=a.useState(!1),[u,i]=a.useState(null),[y,j]=a.useState("prompt");a.useEffect(()=>{navigator.permissions&&navigator.permissions.query({name:"geolocation"}).then(w=>{j(w.state),w.onchange=()=>{j(w.state)}})},[]),a.useEffect(()=>{const w=localStorage.getItem(ye);if(w)try{const k=JSON.parse(w);k.lat&&k.lng&&l({lat:k.lat,lng:k.lng}),k.address&&o(k.address)}catch{localStorage.removeItem(ye)}},[]),a.useEffect(()=>{y==="granted"&&!s&&b()},[y]);const n=a.useCallback((w,k)=>{l(w),o(k),localStorage.setItem(ye,JSON.stringify({lat:w.lat,lng:w.lng,address:k,timestamp:Date.now()}))},[]),b=a.useCallback(async()=>{if(!navigator.geolocation){i("Geolocation is not supported");return}d(!0),i(null),navigator.geolocation.getCurrentPosition(async w=>{const k={lat:w.coords.latitude,lng:w.coords.longitude},_=await pt(k.lat,k.lng);n(k,_),d(!1)},w=>{w.code===w.PERMISSION_DENIED?(i("Location permission denied"),j("denied")):w.code===w.POSITION_UNAVAILABLE?i("Location unavailable"):w.code===w.TIMEOUT?i("Location request timed out"):i("Enable GPS to see distance"),d(!1)},{timeout:1e4,enableHighAccuracy:!0})},[n]),h=a.useCallback(()=>{b()},[b]),v=a.useCallback((w,k)=>{if(!s)return null;const _=6371,p=(w-s.lat)*Math.PI/180,m=(k-s.lng)*Math.PI/180,x=Math.sin(p/2)*Math.sin(p/2)+Math.cos(s.lat*Math.PI/180)*Math.cos(w*Math.PI/180)*Math.sin(m/2)*Math.sin(m/2),C=2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x));return _*C},[s]),F=a.useCallback(()=>{l(null),o(null),localStorage.removeItem(ye)},[]);return{location:s,address:t,isLocating:c,error:u,permissionStatus:y,requestLocation:h,calculateDistance:v,clearLocation:F}}const gt=()=>new Date().toISOString().split("T")[0];function bt(){const[s,l]=a.useState([]),[t,o]=a.useState([]),[c,d]=a.useState([]),[u,i]=a.useState({sehar:"04:52 AM",iftar:"06:24 PM",area:"Chennai"}),[y,j]=a.useState(null),[n,b]=a.useState(!0),[h,v]=a.useState(null),[F,w]=a.useState([]),[k,_]=a.useState({area:"",place:""}),p=a.useRef(!1),m=a.useCallback(async(A={})=>{var D;try{const O=await ee.fetchPoints(A);l(O.providers||[]),w(((D=O.filters)==null?void 0:D.areas)||[])}catch(O){console.error("Failed to fetch offerings:",O)}},[]),x=a.useCallback(async(A={})=>{var D;b(!0),v(null);try{const O=await ee.fetchPoints(A);l(O.providers||[]),w(((D=O.filters)==null?void 0:D.areas)||[]),b(!1),Promise.all([ee.fetchDuas(),ee.fetchEvents(),ee.fetchTimings(),ee.fetchRamzanTimings(null,gt())]).then(([q,L,H,V])=>{o(q),d(L),i(H),V.success&&V.timing&&j(V.timing)}).catch(q=>{console.error("Failed to fetch secondary data:",q)})}catch(O){v(O.message||"Failed to fetch data"),b(!1)}},[]);a.useEffect(()=>{p.current||(p.current=!0,x())},[]);const C=a.useCallback(async A=>{_(A),await m(A)},[m]);return{points:s,duas:t,events:c,timings:u,ramzanTiming:y,loading:n,error:h,availableAreas:F,filters:k,refetch:()=>x(k),refetchWithFilters:C,setFilters:C}}const Pe="ramzania_user";function St(){const[s,l]=a.useState(null),[t,o]=a.useState(!1),[c,d]=a.useState("home"),[u,i]=a.useState(null),[y,j]=a.useState(null),{points:n,timings:b,ramzanTiming:h,availableAreas:v,refetchWithFilters:F,loading:w,refetch:k}=bt(),{location:_,address:p,isLocating:m,requestLocation:x}=ft();a.useEffect(()=>{const L=localStorage.getItem(Pe);if(L){const H=JSON.parse(L);l(H),d(H.role==="provider"?"dashboard":"find")}},[]);const C=L=>{l(L),localStorage.setItem(Pe,JSON.stringify(L)),o(!1),d(L.role==="provider"?"dashboard":"find")},A=()=>{localStorage.removeItem(Pe),l(null),d("home")},D=L=>{j(L),i(null)},O=L=>{d(L)},q=()=>{if((s==null?void 0:s.role)==="provider")switch(c){case"settings":return e.jsx(et,{user:s,onUserUpdate:C});case"dashboard":default:return e.jsx(dt,{user:s})}switch(c){case"find":return e.jsx(Zs,{timings:b,ramzanTiming:h,points:n,onBook:i,availableAreas:v,onFilterChange:F,loading:w,onRefresh:k});case"request":return e.jsx(ut,{user:s,onNavigate:O});case"join":return e.jsx(tt,{user:s,onLogin:C,onNavigate:O,onJoinClick:()=>o(!0)});case"bookings":return e.jsx(nt,{});case"home":default:return e.jsx(rt,{ramzanTiming:h,onNavigate:O,city:(p==null?void 0:p.city)||"Chennai",onRefresh:k})}};return e.jsxs("div",{className:"min-h-screen bg-white pb-20 font-sans text-slate-900 selection:bg-emerald-100 sm:pb-16",children:[e.jsx(Cs,{user:s,onLogout:A,onJoinClick:()=>o(!0),address:p,isLocating:m,onRequestLocation:x}),e.jsx("main",{className:"mx-auto max-w-lg px-4 py-6 sm:max-w-2xl sm:px-6 sm:py-8",children:q()}),e.jsx(Ss,{activeView:c,onViewChange:d,userRole:s==null?void 0:s.role,user:s}),t&&e.jsx(Fs,{onClose:()=>o(!1),onSuccess:C}),u&&e.jsx(Js,{point:u,user:s,userLocation:_,onClose:()=>i(null),onSuccess:D,onLoginClick:()=>{i(null),o(!0)}}),e.jsx(ht,{message:y,onClose:()=>j(null)})]})}export{St as default};
