import{j as e}from"./vendor-ui-B2jkoGl9.js";import{L,j as oe,f as Ze,k as ye,h as Qe,B as ve,g as Xe,H as De,T as Ee,l as Te,m as es,n as ss,o as de,U as fe,P as we,p as ts,q as as,r as ue,X as Z,s as ls,a as Ie,t as ae,u as ke,v as ce,w as rs,x as Pe,y as ns,z as is,S as cs,D as os,E as ds,R as Le,G as Me,I as xs,J as ms,K as us,N as hs}from"./vendor-other-bujeOmyr.js";import{a as J,s as Re,t as h,b as $}from"./index-CYBeCVPq.js";import{a as l}from"./vendor-react-Cc-oBOCu.js";import"./vendor-recharts-LMBWezzC.js";function ps({user:s,onLogout:a,onJoinClick:r,address:i,isLocating:n,onRequestLocation:d}){return e.jsx("nav",{className:"sticky top-0 z-50 w-full border-b border-slate-100/50 bg-white/70 px-4 py-3 backdrop-blur-xl sm:px-6 sm:py-4",children:e.jsxs("div",{className:"mx-auto flex max-w-6xl items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-emerald-600 text-lg font-black text-white shadow-lg shadow-emerald-100 sm:h-10 sm:w-10 sm:rounded-2xl sm:text-xl",children:"R"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-lg leading-none font-black tracking-tighter sm:text-xl",children:["RAMZAN",e.jsx("span",{className:"text-emerald-600",children:"IA"})]}),e.jsx("button",{onClick:d,className:"mt-0.5 flex items-center gap-1 text-[9px] font-bold tracking-wide text-slate-400 transition-colors hover:text-emerald-600",children:n?e.jsxs(e.Fragment,{children:[e.jsx(L,{size:8,className:"animate-spin"}),e.jsx("span",{children:"Locating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{size:8}),e.jsx("span",{className:"max-w-[120px] truncate sm:max-w-[180px]",children:(i==null?void 0:i.city)||(i==null?void 0:i.area)||"Set Location"})]})})]})]}),e.jsx("div",{className:"flex items-center gap-3 sm:gap-4",children:s?e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsxs("div",{className:"hidden text-right sm:block",children:[e.jsx("p",{className:"text-xs font-black text-slate-900",children:s.name}),e.jsx("p",{className:"text-[10px] font-bold text-emerald-600 uppercase",children:s.role==="provider"?"HOST":"GUEST"})]}),e.jsx("button",{onClick:a,className:"flex h-9 w-9 items-center justify-center rounded-xl border border-slate-200 bg-slate-50 text-slate-400 transition-all hover:text-red-500 sm:h-10 sm:w-10 sm:rounded-2xl","aria-label":"Logout",children:e.jsx(Ze,{size:16,className:"sm:h-[18px] sm:w-[18px]"})})]}):e.jsxs("button",{onClick:r,className:"flex items-center justify-center gap-1.5 rounded-xl bg-emerald-600 px-4 py-2 text-xs font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-95 sm:gap-2 sm:rounded-2xl sm:px-5 sm:text-sm",children:[e.jsx(ye,{size:14,className:"sm:h-4 sm:w-4"}),"Join"]})})]})})}const fs=[{id:"home",label:"Home",icon:De},{id:"duas",label:"Duas",icon:Te},{id:"events",label:"Events",icon:ve}],gs=[{id:"home",label:"Home",icon:De},{id:"bookings",label:"Reserved",icon:Ee},{id:"duas",label:"Duas",icon:Te},{id:"events",label:"Events",icon:ve}],bs=[{id:"dashboard",label:"Dashboard",icon:Qe},{id:"events",label:"Events",icon:ve},{id:"settings",label:"Settings",icon:Xe}];function js({activeView:s,onViewChange:a,userRole:r="seeker",user:i=null}){let n;return r==="provider"?n=bs:i?n=gs:n=fs,e.jsxs(e.Fragment,{children:[e.jsx("nav",{className:"fixed bottom-0 z-50 flex w-full items-center justify-around border-t border-slate-100 bg-white px-6 py-3 pb-6 shadow-[0_-10px_30px_rgba(0,0,0,0.03)] sm:hidden",children:n.map(d=>e.jsxs("button",{onClick:()=>a(d.id),className:`flex flex-col items-center gap-1 rounded-xl px-4 py-2 transition-all ${s===d.id?"bg-emerald-50 text-emerald-600":"text-slate-400 hover:text-slate-600"}`,"aria-label":d.label,children:[e.jsx(d.icon,{size:20}),e.jsx("span",{className:"text-[10px] font-bold",children:d.label})]},d.id))}),e.jsx("div",{className:"fixed bottom-6 left-1/2 z-50 hidden -translate-x-1/2 sm:block",children:e.jsx("div",{className:"flex gap-1 rounded-2xl bg-slate-950 p-1.5 text-white shadow-2xl shadow-slate-950/20",children:n.map(d=>e.jsx("button",{onClick:()=>a(d.id),className:`rounded-xl px-6 py-2.5 text-[10px] font-black tracking-wider uppercase transition-all ${s===d.id?"bg-emerald-600 text-white":"text-slate-400 hover:text-white"}`,children:d.label},d.id))})})]})}function Ns({time:s,compact:a=!1}){return e.jsxs("div",{className:`group relative overflow-hidden border-none bg-emerald-600 text-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-emerald-200/40 ${a?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsx(es,{size:a?60:100,className:"absolute -top-4 -right-4 text-emerald-500/30 transition-transform duration-500 group-hover:scale-110"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("span",{className:`block font-black tracking-wider text-emerald-200 uppercase ${a?"mb-1 text-[8px]":"mb-8 text-[10px]"}`,children:"Imsak (Sehar)"}),e.jsx("h4",{className:`font-black tracking-tight ${a?"text-3xl":"text-5xl"}`,children:s}),!a&&e.jsx("p",{className:"mt-1 text-sm font-medium text-emerald-100/80",children:"Stop eating and intend to fast."})]})]})}function ys({time:s,compact:a=!1}){return e.jsxs("div",{className:`group relative overflow-hidden border-none bg-slate-950 text-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-slate-200/40 ${a?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsx(ss,{size:a?60:100,className:"absolute -top-4 -right-4 text-slate-800/50 transition-transform duration-500 group-hover:rotate-12"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("span",{className:`block font-black tracking-wider text-slate-400 uppercase ${a?"mb-1 text-[8px]":"mb-8 text-[10px]"}`,children:"Maghrib (Iftar)"}),e.jsx("h4",{className:`font-black tracking-tight ${a?"text-3xl":"text-5xl"}`,children:s}),!a&&e.jsx("p",{className:"mt-1 text-sm font-medium text-slate-400/80",children:"Break your fast with the sun's set."})]})]})}function vs({timings:s,compact:a=!1}){return e.jsxs("div",{className:`grid grid-cols-2 ${a?"gap-3":"gap-4"}`,children:[e.jsx(Ns,{time:s.sehar,compact:a}),e.jsx(ys,{time:s.iftar,compact:a})]})}function ws({point:s,onBook:a,compact:r=!1}){const i=n=>{const d=["th","st","nd","rd"],p=n%100;return n+(d[(p-20)%10]||d[p]||d[0])};return e.jsxs("div",{className:`flex flex-col border border-t-4 border-slate-100 border-t-emerald-500 bg-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-slate-200/40 ${r?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsxs("div",{className:`flex items-start justify-between ${r?"mb-2":"mb-4"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`leading-tight font-black text-slate-900 ${r?"text-base":"text-xl"}`,children:s.name}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[s.next_available_day&&e.jsxs("span",{className:"rounded-md bg-emerald-100 px-1.5 py-0.5 text-[10px] font-bold text-emerald-700",children:["Next: ",i(s.next_available_day)," Ramzan"]}),s.next_available_date&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-slate-400",children:[e.jsx(de,{size:10}),s.next_available_date]})]})]}),e.jsx("span",{className:`rounded-lg font-black uppercase ${r?"px-1.5 py-0.5 text-[8px]":"rounded-xl px-2 py-1 text-[9px]"} ${s.price===0?"bg-emerald-50 text-emerald-600":"bg-amber-50 text-amber-600"}`,children:s.price===0?"Free":`From â‚¹${s.price}`})]}),e.jsx("div",{className:`flex-1 bg-slate-50 text-slate-600 ${r?"mb-3 rounded-xl p-3 text-xs leading-relaxed":"mb-6 rounded-2xl p-4 text-sm leading-relaxed"}`,children:e.jsxs("span",{className:"italic",children:['"',s.menu,'"']})}),e.jsxs("div",{className:"mb-3 flex flex-wrap items-center gap-2 text-[10px] text-slate-500",children:[s.distance!==null&&s.distance!==void 0&&e.jsxs("span",{className:"flex items-center gap-1 rounded bg-blue-50 px-1.5 py-0.5 font-bold text-blue-600",children:["ðŸ“ ",s.distance," km"]}),s.total_offerings&&e.jsxs("span",{className:"flex items-center gap-1 rounded bg-emerald-50 px-1.5 py-0.5 text-emerald-600",children:[e.jsx(fe,{size:10})," ",s.total_offerings," days"]}),s.total_slots!==void 0&&e.jsxs("span",{className:"rounded bg-slate-100 px-1.5 py-0.5",children:["ðŸ‘¥ ",s.total_slots," total spots"]}),s.meal_types&&e.jsx("span",{className:"rounded bg-slate-100 px-1.5 py-0.5 uppercase",children:s.meal_types.includes(",")?"Sehar & Iftar":s.meal_types}),s.area&&e.jsxs("span",{className:"rounded bg-slate-100 px-1.5 py-0.5",children:["ðŸ“ ",s.area]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>globalThis.open(`tel:${s.phone}`),className:`flex items-center justify-center gap-1.5 rounded-xl border border-slate-200 bg-white font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-95 ${r?"px-3 py-2 text-xs":"px-6 py-3.5 text-sm"}`,children:[e.jsx(we,{size:r?12:16})," Call"]}),e.jsxs("button",{onClick:()=>globalThis.open(`https://wa.me/${s.phone.replaceAll(/\D/g,"")}`),className:`flex items-center justify-center gap-1.5 rounded-xl border border-emerald-100 bg-white font-bold text-emerald-600 transition-all hover:bg-emerald-50 active:scale-95 ${r?"px-3 py-2 text-xs":"px-6 py-3.5 text-sm"}`,children:[e.jsx(ts,{size:r?12:16})," Chat"]})]}),e.jsx("button",{onClick:()=>a(s),disabled:!s.isBookable,className:`flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-95 disabled:bg-emerald-300 disabled:opacity-50 ${r?"px-3 py-2 text-xs":"px-6 py-3.5 text-sm"}`,children:s.isBookable?"Reserve Sehri":"Info Only"})]})]})}function ks({dua:s}){return e.jsxs("div",{className:"space-y-6 rounded-[2.5rem] border border-slate-100 bg-white p-10 shadow-sm transition-all duration-500 hover:shadow-xl hover:shadow-slate-200/40",children:[e.jsx("h4",{className:"text-[10px] font-black tracking-widest text-emerald-600 uppercase",children:s.title}),e.jsx("p",{className:"text-right text-4xl leading-[1.8] font-bold text-slate-900",dir:"rtl",children:s.arabic}),e.jsxs("div",{className:"space-y-2 border-t border-slate-50 pt-6",children:[e.jsxs("p",{className:"text-sm font-bold text-emerald-700 italic",children:['"',s.transliteration,'"']}),e.jsx("p",{className:"text-sm font-medium text-slate-400",children:s.english})]})]})}function Ss({event:s,onInterested:a}){return e.jsxs("div",{className:"flex flex-col justify-between gap-6 rounded-[2.5rem] border border-slate-100 bg-white p-6 shadow-sm transition-all duration-500 hover:shadow-xl hover:shadow-emerald-100/30 md:flex-row md:items-center",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"rounded-full bg-emerald-50 px-3 py-1 text-[10px] font-black text-emerald-600 uppercase",children:s.date}),e.jsx("span",{className:"rounded-full bg-slate-50 px-3 py-1 text-[10px] font-black text-slate-400 uppercase",children:s.time})]}),e.jsx("h3",{className:"text-2xl font-black text-slate-900",children:s.title}),e.jsxs("p",{className:"text-sm font-medium text-slate-400",children:[e.jsx(oe,{size:12,className:"mr-1 inline"})," ",s.location," â€¢ ",e.jsx(as,{size:12,className:"mr-1 inline"})," ",s.speaker]})]}),e.jsx("button",{onClick:()=>a==null?void 0:a(s),className:"flex items-center justify-center gap-2 rounded-2xl bg-slate-900 px-6 py-3.5 text-sm font-bold text-white transition-all hover:bg-slate-800 active:scale-95",children:"Interested"})]})}async function Cs(s,a){try{const i=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${a}&zoom=18&addressdetails=1`,{headers:{"Accept-Language":"en"}})).json();if(i!=null&&i.address){const{road:n,suburb:d,neighbourhood:p,city:c,town:A,village:y,state_district:o,state:x,postcode:_,county:k}=i.address;return{street:n||"",area:d||p||k||"",city:c||A||y||o||"",pincode:_||"",state:x||""}}return null}catch(r){return console.error("Reverse geocoding failed:",r),null}}function _s({onClose:s,onSuccess:a}){const[r,i]=l.useState("CHOICE"),[n,d]=l.useState(!1),[p,c]=l.useState(""),[A,y]=l.useState(""),[o,x]=l.useState(""),[_,k]=l.useState("seeker"),[z,j]=l.useState(""),[w,R]=l.useState(""),[g,u]=l.useState(""),[F,S]=l.useState(""),[B,T]=l.useState(""),[I,D]=l.useState(""),[C,M]=l.useState(""),[G,K]=l.useState(""),[V,U]=l.useState(""),[Q,X]=l.useState(null),[N,q]=l.useState(null),[t,v]=l.useState(!1),[E,W]=l.useState(""),[H,Se]=l.useState(""),[ge,Ce]=l.useState(""),[$e,_e]=l.useState(""),[le,me]=l.useState(["","","","","",""]),[re,ze]=l.useState(""),be=l.useRef([]),Ae=l.useCallback(async()=>{if(navigator.geolocation){v(!0);try{const m=await new Promise((P,We)=>{navigator.geolocation.getCurrentPosition(P,We,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),{latitude:f,longitude:b}=m.coords;X(f),q(b);const O=await Cs(f,b);O&&(D(O.street),M(O.area),K(O.city),U(O.pincode))}catch(m){console.log("Location fetch failed:",m.message)}finally{v(!1)}}},[]);l.useEffect(()=>{r==="REGISTER"&&Ae()},[r,Ae]);const Be=(m,f)=>{var P;const b=m.target.value;if(isNaN(b))return;const O=[...le];O[f]=b.slice(-1),me(O),b&&f<5&&((P=be.current[f+1])==null||P.focus())},qe=(m,f)=>{var b;m.key==="Backspace"&&!le[f]&&f>0&&((b=be.current[f-1])==null||b.focus())},Ge=async m=>{var f,b;m.preventDefault(),c(""),d(!0);try{const O=await J.login({email:A,password:o});if(O.success)O.token&&Re.set("auth_token",O.token),h.success("Welcome back!",{description:`Logged in as ${O.user.name}`}),a(O.user);else{const P=O.message||"Login failed";c(P),h.error("Login Failed",{description:P})}}catch(O){const P=O.message||((b=(f=O.errors)==null?void 0:f.email)==null?void 0:b[0])||"Login failed. Please try again.";c(P),h.error("Login Failed",{description:P})}finally{d(!1)}},Ue=async m=>{var f,b;if(m.preventDefault(),c(""),w.length<6){c("Password must be at least 6 characters"),h.error("Validation Error",{description:"Password must be at least 6 characters"});return}d(!0);try{const O=await J.register({email:z,password:w,name:g,contact:F,role:_,place_name:_==="provider"?B:null,street:I,area:C,city:G,pincode:V,latitude:Q,longitude:N});if(O.success)h.success("OTP Sent!",{description:"Please check your email for the verification code"}),ze("register"),me(["","","","","",""]),i("OTP");else{const P=O.message||"Registration failed";c(P),h.error("Registration Failed",{description:P})}}catch(O){const P=O.message||((b=(f=O.errors)==null?void 0:f.email)==null?void 0:b[0])||"Registration failed. Please try again.";c(P),h.error("Registration Failed",{description:P})}finally{d(!1)}},He=async m=>{if(m.preventDefault(),c(""),!E){c("Please enter your email"),h.error("Email Required",{description:"Please enter your registered email address"});return}d(!0);try{const f=await J.forgotPassword(E);if(f.success)h.success("OTP Sent!",{description:"Please check your email for the reset code"}),ze("forgot"),me(["","","","","",""]),i("OTP");else{const b=f.message||"Failed to send OTP";c(b),h.error("Failed",{description:b})}}catch(f){const b=f.message||"Failed to send OTP. Please try again.";c(b),h.error("Failed",{description:b})}finally{d(!1)}},Ve=async()=>{const m=le.join("");if(!(m.length<6)){c(""),d(!0);try{if(re==="register"){const f=await J.verifyRegistrationOtp(z,m);if(f.success)f.token&&Re.set("auth_token",f.token),h.success("Account Verified!",{description:"Welcome to Ramzania!"}),a(f.user);else{const b=f.message||"Invalid OTP";c(b),h.error("Verification Failed",{description:b})}}else if(re==="forgot"){const f=await J.verifyForgotPasswordOtp(E,m);if(f.success)h.success("OTP Verified!",{description:"Now set your new password"}),_e(f.reset_token),i("RESET_PASSWORD");else{const b=f.message||"Invalid OTP";c(b),h.error("Verification Failed",{description:b})}}}catch(f){const b=f.message||"OTP verification failed. Please try again.";c(b),h.error("Verification Failed",{description:b})}finally{d(!1)}}},Ye=async m=>{if(m.preventDefault(),c(""),H.length<6){c("Password must be at least 6 characters"),h.error("Validation Error",{description:"Password must be at least 6 characters"});return}if(H!==ge){c("Passwords do not match"),h.error("Validation Error",{description:"Passwords do not match"});return}d(!0);try{const f=await J.resetPassword(E,$e,H,ge);if(f.success)h.success("Password Reset!",{description:"You can now login with your new password"}),i("LOGIN"),c(""),W(""),Se(""),Ce(""),_e("");else{const b=f.message||"Password reset failed";c(b),h.error("Reset Failed",{description:b})}}catch(f){const b=f.message||"Password reset failed. Please try again.";c(b),h.error("Reset Failed",{description:b})}finally{d(!1)}},Ke=async()=>{d(!0),c("");try{let m;if(re==="register"?m=await J.resendRegistrationOtp(z):m=await J.forgotPassword(E),m.success)h.success("OTP Resent!",{description:"Please check your email for the new code"}),me(["","","","","",""]);else{const f=m.message||"Failed to resend OTP";c(f),h.error("Failed",{description:f})}}catch{const f="Failed to resend OTP. Please try again.";c(f),h.error("Failed",{description:f})}finally{d(!1)}},ne="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",Y="w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",ee="flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 px-4 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",Je={CHOICE:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-black tracking-tight text-slate-900",children:"Join Ramzania"}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Your portal to community Sehar & Iftar."}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("button",{className:ee,onClick:()=>i("LOGIN"),children:"Sign In"}),e.jsx("button",{className:"flex w-full items-center justify-center gap-2 rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-[0.98]",onClick:()=>i("REGISTER"),children:"Create Account"})]})]}),LOGIN:e.jsxs("form",{onSubmit:Ge,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>i("CHOICE"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ue,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Sign In"})]}),p&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:p}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"email",required:!0,placeholder:"Email address",className:ne,value:A,onChange:m=>y(m.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Password",className:ne,value:o,onChange:m=>x(m.target.value)})]}),e.jsx("button",{type:"submit",disabled:n,className:ee,children:n?e.jsx(L,{className:"animate-spin",size:18}):"Sign In"}),e.jsx("button",{type:"button",onClick:()=>i("FORGOT"),className:"w-full text-center text-[10px] font-bold tracking-wide text-slate-400 uppercase hover:text-emerald-600",children:"Forgot Password?"})]}),REGISTER:e.jsxs("form",{onSubmit:Ue,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>i("CHOICE"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ue,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Create Account"})]}),p&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:p}),e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{type:"button",onClick:()=>k("seeker"),className:`flex-1 rounded-lg py-2.5 text-xs font-bold transition-all ${_==="seeker"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"ðŸ½ï¸ Guest"}),e.jsx("button",{type:"button",onClick:()=>k("provider"),className:`flex-1 rounded-lg py-2.5 text-xs font-bold transition-all ${_==="provider"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"ðŸ  Host"})]}),e.jsx("p",{className:"text-[10px] font-medium text-slate-400",children:_==="seeker"?"Find & reserve Sehri near you":"Arrange Sehri for guests in your area"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"email",required:!0,placeholder:"Email address",className:Y,value:z,onChange:m=>j(m.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Password (min 6 chars)",className:Y,value:w,onChange:m=>R(m.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Full Name",className:Y,value:g,onChange:m=>u(m.target.value)}),e.jsx("input",{type:"tel",required:!0,placeholder:"Contact Number",className:Y,value:F,onChange:m=>S(m.target.value)})]}),_==="provider"&&e.jsx("input",{type:"text",required:!0,placeholder:"Place Name (e.g., Restaurant, Masjid,..)",className:Y,value:B,onChange:m=>T(m.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500",children:"Address Details"}),t&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(L,{size:10,className:"animate-spin"}),"Fetching location..."]}),!t&&G&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(oe,{size:10}),"Auto-filled"]})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Street / Door No",className:Y,value:I,onChange:m=>D(m.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Area / Locality",className:Y,value:C,onChange:m=>M(m.target.value)}),e.jsx("input",{type:"text",required:!0,placeholder:"City",className:Y,value:G,onChange:m=>K(m.target.value)})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Pincode",className:Y,value:V,onChange:m=>U(m.target.value)})]}),e.jsx("button",{type:"submit",disabled:n,className:ee,children:n?e.jsx(L,{className:"animate-spin",size:18}):"Continue â†’"})]}),FORGOT:e.jsxs("form",{onSubmit:He,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>i("LOGIN"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ue,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Reset Password"})]}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Enter your email to receive a verification code."}),p&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:p}),e.jsx("input",{type:"email",required:!0,placeholder:"Registered email",className:ne,value:E,onChange:m=>W(m.target.value)}),e.jsx("button",{type:"submit",disabled:n,className:ee,children:n?e.jsx(L,{className:"animate-spin",size:18}):"Send OTP"})]}),OTP:e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>i(re==="register"?"REGISTER":"FORGOT"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ue,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Verify Email"})]}),e.jsxs("p",{className:"text-sm font-medium text-slate-500",children:["Enter the 6-digit code sent to ",e.jsx("span",{className:"font-bold text-slate-700",children:re==="register"?z:E})]}),p&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:p}),e.jsx("div",{className:"flex justify-between gap-2",children:le.map((m,f)=>e.jsx("input",{ref:b=>be.current[f]=b,type:"text",inputMode:"numeric",maxLength:1,className:"h-12 w-full rounded-xl border border-slate-200 bg-slate-50 text-center text-lg font-bold transition-all outline-none focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",value:m,onChange:b=>Be(b,f),onKeyDown:b=>qe(b,f)},f))}),e.jsx("button",{type:"button",onClick:Ve,disabled:n||le.join("").length<6,className:ee,children:n?e.jsx(L,{className:"animate-spin",size:18}):"Verify"}),e.jsx("button",{type:"button",onClick:Ke,disabled:n,className:"w-full text-center text-[10px] font-bold tracking-wide text-slate-400 uppercase hover:text-emerald-600",children:"Resend Code"})]}),RESET_PASSWORD:e.jsxs("form",{onSubmit:Ye,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ls,{size:20,className:"text-emerald-600"}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"New Password"})]}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Create a new password for your account."}),p&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:p}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"password",required:!0,placeholder:"New Password (min 6 chars)",className:ne,value:H,onChange:m=>Se(m.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Confirm Password",className:ne,value:ge,onChange:m=>Ce(m.target.value)})]}),e.jsx("button",{type:"submit",disabled:n,className:ee,children:n?e.jsx(L,{className:"animate-spin",size:18}):"Reset Password"})]})};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-slate-900/40 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-4 w-full max-w-md rounded-2xl border border-slate-100 bg-white p-6 shadow-xl sm:rounded-3xl sm:p-8",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-emerald-50 text-emerald-600",children:e.jsx(ye,{size:20})}),e.jsx("button",{onClick:s,className:"rounded-full p-2 text-slate-300 transition-all hover:bg-slate-100 hover:text-slate-500",children:e.jsx(Z,{size:18})})]}),Je[r]]})})}const xe=s=>new Promise(a=>setTimeout(a,s)),zs=async(s={})=>{try{const a=new URLSearchParams;s.lat&&a.append("lat",s.lat),s.lng&&a.append("lng",s.lng),s.area&&a.append("area",s.area),s.place&&a.append("place",s.place);const r=a.toString(),i=`/home/offerings${r?`?${r}`:""}`,n=await $.get(i,{auth:!1});return n.success?{providers:n.providers||[],filters:n.filters||{},current_ramzan_day:n.current_ramzan_day,ramzan_start_date:n.ramzan_start_date}:{providers:Fe(),filters:{}}}catch(a){return console.error("Failed to fetch providers from API, using mock data:",a),{providers:Fe(),filters:{}}}},As=async(s=null)=>{try{const a=s?`/home/timings?day=${s}`:"/home/timings",r=await $.get(a,{auth:!1});return r.success?r:{success:!1,timing:null}}catch(a){return console.error("Failed to fetch Ramzan timings:",a),{success:!1,timing:null}}},Rs=async()=>{try{const s=await $.get("/home/timings/all",{auth:!1});return s.success?s.timings||[]:[]}catch(s){return console.error("Failed to fetch all Ramzan timings:",s),[]}},Fs=async s=>{try{const a=await $.get(`/home/provider/${s}/offerings`,{auth:!1});return a.success?a:{success:!1,offerings:[]}}catch(a){return console.error("Failed to fetch provider offerings:",a),{success:!1,offerings:[]}}},Os=async(s,a)=>$.post("/bookings",{offering_id:s,quantity:a}),Ds=async()=>$.get("/bookings/my"),Es=async s=>$.post(`/bookings/${s}/cancel`),Ts=async(s="all")=>{const a=s==="all"?"/bookings/provider":`/bookings/provider?status=${s}`;return $.get(a)},Is=async(s,a)=>$.put(`/bookings/${s}/status`,{status:a}),Fe=()=>[],Ps=async()=>(await xe(200),[{id:1,title:"Dua for Suhoor (Intention for Fasting)",arabic:"ÙˆÙŽØ¨ÙØµÙŽÙˆÙ’Ù…Ù ØºÙŽØ¯Ù Ù†ÙŽÙˆÙŽÙŠÙ’ØªÙ Ù…ÙÙ†Ù’ Ø´ÙŽÙ‡Ù’Ø±Ù Ø±ÙŽÙ…ÙŽØ¶ÙŽØ§Ù†ÙŽ",transliteration:"Wa bisawmi ghadin nawaitu min shahri Ramadan",english:"I intend to fast tomorrow for the month of Ramadan."},{id:2,title:"Dua for Iftar (Breaking Fast)",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ Ø¥ÙÙ†ÙÙ‘ÙŠ Ù„ÙŽÙƒÙŽ ØµÙÙ…Ù’ØªÙ ÙˆÙŽØ¨ÙÙƒÙŽ Ø¢Ù…ÙŽÙ†Ù’ØªÙ ÙˆÙŽØ¹ÙŽÙ„ÙŽÙŠÙ’ÙƒÙŽ ØªÙŽÙˆÙŽÙƒÙŽÙ‘Ù„Ù’ØªÙ ÙˆÙŽØ¹ÙŽÙ„ÙŽÙ‰ Ø±ÙØ²Ù’Ù‚ÙÙƒÙŽ Ø£ÙŽÙÙ’Ø·ÙŽØ±Ù’ØªÙ",transliteration:"Allahumma inni laka sumtu wa bika aamantu wa â€˜alayka tawakkaltu wa â€˜ala rizqika aftartu",english:"O Allah, I fasted for You, I believe in You, I trust in You, and I break my fast with Your provision."},{id:3,title:"Dua After Breaking Fast (Authentic)",arabic:"Ø°ÙŽÙ‡ÙŽØ¨ÙŽ Ø§Ù„Ø¸ÙŽÙ‘Ù…ÙŽØ£Ù ÙˆÙŽØ§Ø¨Ù’ØªÙŽÙ„ÙŽÙ‘ØªÙ Ø§Ù„Ù’Ø¹ÙØ±ÙÙˆÙ‚Ù ÙˆÙŽØ«ÙŽØ¨ÙŽØªÙŽ Ø§Ù„Ù’Ø£ÙŽØ¬Ù’Ø±Ù Ø¥ÙÙ†Ù’ Ø´ÙŽØ§Ø¡ÙŽ Ø§Ù„Ù„ÙŽÙ‘Ù‡Ù",transliteration:"Dhahaba adh-dhamaâ€™u wabtallatil â€˜urooq wa thabatal ajru in sha Allah",english:"The thirst is gone, the veins are moistened, and the reward is confirmed, if Allah wills."},{id:4,title:"Dua for Laylatul Qadr",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ Ø¥ÙÙ†ÙŽÙ‘ÙƒÙŽ Ø¹ÙŽÙÙÙˆÙŒÙ‘ ØªÙØ­ÙØ¨ÙÙ‘ Ø§Ù„Ù’Ø¹ÙŽÙÙ’ÙˆÙŽ ÙÙŽØ§Ø¹Ù’ÙÙ Ø¹ÙŽÙ†ÙÙ‘ÙŠ",transliteration:"Allahumma innaka afuwwun tuhibbul afwa faâ€™fu anni",english:"O Allah, You are Most Forgiving, and You love forgiveness; so forgive me."},{id:5,title:"Dua for Forgiveness",arabic:"Ø£ÙŽØ³Ù’ØªÙŽØºÙ’ÙÙØ±Ù Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙŽ",transliteration:"Astaghfirullah",english:"I seek forgiveness from Allah."},{id:6,title:"Dua for Mercy",arabic:"Ø±ÙŽØ¨ÙÙ‘ Ø§ØºÙ’ÙÙØ±Ù’ ÙˆÙŽØ§Ø±Ù’Ø­ÙŽÙ…Ù’ ÙˆÙŽØ£ÙŽÙ†Ù’ØªÙŽ Ø®ÙŽÙŠÙ’Ø±Ù Ø§Ù„Ø±ÙŽÙ‘Ø§Ø­ÙÙ…ÙÙŠÙ†ÙŽ",transliteration:"Rabbighfir warham wa anta khayrur rahimeen",english:"My Lord, forgive and have mercy, for You are the Best of the merciful."},{id:7,title:"Dua for Guidance",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ Ø§Ù‡Ù’Ø¯ÙÙ†ÙÙŠ ÙˆÙŽØ³ÙŽØ¯ÙÙ‘Ø¯Ù’Ù†ÙÙŠ",transliteration:"Allahumma ihdini wa saddidni",english:"O Allah, guide me and keep me steadfast."},{id:8,title:"Dua for Acceptance of Fasting",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ ØªÙŽÙ‚ÙŽØ¨ÙŽÙ‘Ù„Ù’ Ù…ÙÙ†ÙŽÙ‘Ø§ Ø¥ÙÙ†ÙŽÙ‘ÙƒÙŽ Ø£ÙŽÙ†Ù’ØªÙŽ Ø§Ù„Ø³ÙŽÙ‘Ù…ÙÙŠØ¹Ù Ø§Ù„Ù’Ø¹ÙŽÙ„ÙÙŠÙ…Ù",transliteration:"Allahumma taqabbal Ù…Ù†Ø§ innaka antas-sameeâ€™ul aleem",english:"O Allah, accept from us. Indeed, You are the All-Hearing, All-Knowing."}]),Ls=async()=>(await xe(200),[]),Ms=async(s="Chennai")=>(await xe(100),{sehar:"4:52 AM",iftar:"6:24 PM",area:s}),$s=async(s,a)=>(await xe(1e3),{success:!0,user:{email:s,role:s.includes("admin")?"admin":"seeker",name:s.split("@")[0],token:"token-"+Date.now()}}),Bs=async(s,a)=>(await xe(500),{success:!0,bookingId:`BK-${Date.now()}`,message:"Spot booked successfully!"}),ie={fetchPoints:zs,fetchDuas:Ps,fetchEvents:Ls,fetchTimings:Ms,fetchRamzanTimings:As,fetchAllRamzanTimings:Rs,login:$s,bookSpot:Bs};function qs({point:s,user:a,onClose:r,onSuccess:i,onLoginClick:n}){const[d,p]=l.useState(!0),[c,A]=l.useState([]),[y,o]=l.useState(null),[x,_]=l.useState(null),[k,z]=l.useState(1),[j,w]=l.useState(!1);l.useEffect(()=>{(async()=>{p(!0);const F=s.provider_id||s.id,S=await Fs(F);S.success&&(o(S.provider),A(S.offerings||[])),p(!1)})()},[s]);const R=u=>{const F=["th","st","nd","rd"],S=u%100;return u+(F[(S-20)%10]||F[S]||F[0])},g=async()=>{if(!x){h.error("Please select a date");return}w(!0);try{const u=await Os(x.id,k);u.success?(h.success("Spot Booked!",{description:`Booking code: ${u.booking.booking_code}`}),i==null||i(`Spot booked for ${R(x.ramzan_day)} Ramzan!`)):h.error("Booking Failed",{description:u.message})}catch(u){u.status===401?(h.error("Please login to book"),n==null||n()):h.error("Booking Failed",{description:u.message})}finally{w(!1)}};return a?e.jsx("div",{className:"fixed inset-0 z-100 flex items-end justify-center bg-slate-900/30 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-10 max-h-[90vh] w-full max-w-md overflow-hidden rounded-3xl border border-slate-100 bg-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 p-4",children:[e.jsx("h2",{className:"text-lg font-black text-slate-900",children:"Reserve Sehri"}),e.jsx("button",{onClick:r,className:"rounded-full p-2 text-slate-400 hover:bg-slate-100",children:e.jsx(Z,{size:18})})]}),e.jsxs("div",{className:"bg-emerald-50 px-4 py-3",children:[e.jsx("p",{className:"font-black text-emerald-800",children:(y==null?void 0:y.name)||s.name}),e.jsx("p",{className:"text-xs text-emerald-600",children:(y==null?void 0:y.area)||s.area})]}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto p-4",children:d?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(L,{size:24,className:"animate-spin text-emerald-600"})}):c.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(fe,{size:32,className:"mx-auto mb-2 text-slate-300"}),e.jsx("p",{className:"text-sm text-slate-500",children:"No available dates"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"mb-3 text-xs font-bold text-slate-500",children:"Select a date:"}),c.map(u=>e.jsxs("button",{disabled:!u.is_bookable,onClick:()=>_(u),className:`w-full rounded-xl border p-3 text-left transition-all ${(x==null?void 0:x.id)===u.id?"border-emerald-500 bg-emerald-50 ring-2 ring-emerald-200":u.is_bookable?"border-slate-200 bg-white hover:border-emerald-300 hover:bg-emerald-50/50":"cursor-not-allowed border-slate-100 bg-slate-50 opacity-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 text-xs font-black text-emerald-700",children:R(u.ramzan_day)}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold text-slate-800",children:[u.formatted_date,e.jsxs("span",{className:"ml-1 text-[10px] font-normal text-slate-400",children:["(",u.day_name,")"]})]}),e.jsx("p",{className:"text-[10px] text-slate-500",children:u.meal_type})]})]}),e.jsxs("div",{className:"text-right",children:[(x==null?void 0:x.id)===u.id&&e.jsx(Ie,{size:16,className:"text-emerald-600"}),!x||x.id!==u.id?e.jsx("span",{className:`text-xs font-bold ${u.is_bookable?"text-emerald-600":"text-red-500"}`,children:u.is_bookable?`${u.available_slots} spots`:"Full"}):null]})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-1.5 text-[10px] text-slate-500",children:[u.timing&&e.jsxs("span",{className:"flex items-center gap-0.5 rounded bg-slate-100 px-1.5 py-0.5",children:[e.jsx(ae,{size:10})," ",u.timing]}),u.delivery_available&&e.jsxs("span",{className:"flex items-center gap-0.5 rounded bg-emerald-100 px-1.5 py-0.5 text-emerald-600",children:[e.jsx(ke,{size:10})," Delivery"]}),e.jsx("span",{className:`rounded px-1.5 py-0.5 ${u.price_type==="free"?"bg-emerald-100 text-emerald-600":"bg-amber-100 text-amber-600"}`,children:u.price_type==="free"?"Free":`â‚¹${u.price_amount}`})]}),e.jsxs("p",{className:"mt-2 text-[10px] text-slate-400 italic",children:['"',u.menu_items,'"']})]},u.id))]})}),x&&e.jsxs("div",{className:"border-t border-slate-100 bg-slate-50 p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between rounded-xl bg-white p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{size:16,className:"text-slate-400"}),e.jsx("span",{className:"text-sm font-bold text-slate-700",children:"No. of Persons"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>z(u=>Math.max(1,u-1)),className:"rounded-lg bg-slate-100 p-1.5 text-slate-600 hover:bg-slate-200",children:e.jsx(rs,{size:14})}),e.jsx("span",{className:"w-6 text-center text-sm font-black text-slate-900",children:k}),e.jsx("button",{type:"button",onClick:()=>z(u=>Math.min(x.available_slots,Math.min(10,u+1))),className:"rounded-lg bg-slate-100 p-1.5 text-slate-600 hover:bg-slate-200",children:e.jsx(Pe,{size:14})})]})]}),e.jsxs("div",{className:"mb-4 flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-slate-500",children:[R(x.ramzan_day)," Ramzan â€¢ ",x.meal_type]}),e.jsx("span",{className:"font-bold text-slate-900",children:x.price_type==="free"?"Free":`â‚¹${(x.price_amount||0)*k}`})]}),e.jsx("button",{onClick:g,disabled:j,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",children:j?e.jsxs(e.Fragment,{children:[e.jsx(L,{size:16,className:"animate-spin"}),"Booking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{size:16}),"Confirm Booking"]})})]})]})}):e.jsx("div",{className:"fixed inset-0 z-100 flex items-end justify-center bg-slate-900/30 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-10 w-full max-w-md rounded-3xl border border-slate-100 bg-white p-6 shadow-lg",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Book Spot"}),e.jsx("button",{onClick:r,className:"rounded-full p-2 text-slate-400 hover:bg-slate-100",children:e.jsx(Z,{size:18})})]}),e.jsxs("div",{className:"mb-6 rounded-xl bg-emerald-50 p-4",children:[e.jsx("p",{className:"font-black text-emerald-800",children:s.name}),e.jsx("p",{className:"text-xs text-emerald-600",children:s.area})]}),e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:[e.jsx(ye,{size:32,className:"mx-auto mb-3 text-slate-400"}),e.jsx("p",{className:"font-bold text-slate-700",children:"Login Required"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Please login or register to reserve Sehri"}),e.jsx("button",{onClick:()=>{r(),n==null||n()},className:"mt-4 rounded-xl bg-emerald-600 px-6 py-2.5 text-sm font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:"Login / Register"})]})]})})}function Gs({timings:s,ramzanTiming:a,points:r,onBook:i,availableAreas:n=[],onFilterChange:d,loading:p}){const[c,A]=l.useState(""),[y,o]=l.useState(""),[x,_]=l.useState(!1),k=()=>{const g=new Date,u=new Date("2026-02-19"),F=new Date("2026-03-20");return g>=u&&g<=F},z=r.filter(g=>g.name.toLowerCase().includes(c.toLowerCase())||g.menu.toLowerCase().includes(c.toLowerCase())),j=g=>{o(g),d&&d({area:g})},w=()=>{o(""),A(""),d&&d({})},R=g=>{if(!g)return"--:--";const[u,F]=g.split(":"),S=parseInt(u),B=S>=12?"PM":"AM";return`${S%12||12}:${F} ${B}`};return e.jsxs("div",{className:"space-y-6",children:[a&&k()&&e.jsxs("section",{className:"rounded-2xl bg-gradient-to-br from-emerald-50 to-teal-50 p-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{size:16,className:"text-emerald-600"}),e.jsxs("h2",{className:"text-sm font-black tracking-tight text-slate-900",children:["Day ",a.ramzan_day," - Prayer Times"]})]}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:new Date(a.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"rounded-xl bg-white/80 p-3 text-center shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:"Sehri Ends"}),e.jsx("p",{className:"text-lg font-black text-emerald-700",children:R(a.sehar_time)})]}),e.jsxs("div",{className:"rounded-xl bg-white/80 p-3 text-center shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:"Iftar"}),e.jsx("p",{className:"text-lg font-black text-orange-600",children:R(a.iftar_time)})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2 sm:grid-cols-6",children:[{name:"Fajr",time:a.fajr},{name:"Zohar",time:a.zohar},{name:"Asar",time:a.asar},{name:"Magrib",time:a.magrib},{name:"Isha",time:a.isha},{name:"Taraweeh",time:a.taraweeh}].map(g=>e.jsxs("div",{className:"rounded-lg bg-white/60 px-2 py-1.5 text-center",children:[e.jsx("p",{className:"text-[10px] font-medium text-slate-500",children:g.name}),e.jsx("p",{className:"text-xs font-bold text-slate-700",children:R(g.time)})]},g.name))})]}),!a&&k()&&e.jsxs("section",{children:[e.jsx("h2",{className:"mb-3 text-sm font-black tracking-tight text-slate-900",children:"Today's Timings"}),e.jsx(vs,{timings:s,compact:!0})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ns,{size:16,className:"text-emerald-600"}),e.jsx("h2",{className:"text-sm font-black tracking-tight text-slate-900",children:"Sehri Hosts"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"rounded-lg bg-slate-100 px-2 py-0.5 text-xs font-bold text-slate-600",children:p?"...":`${z.length} nearby`}),e.jsxs("button",{onClick:()=>_(!x),className:`flex items-center gap-1 rounded-lg px-2 py-0.5 text-xs font-bold transition-colors ${x||y?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600"}`,children:[e.jsx(is,{size:12}),"Filter"]})]})]}),x&&e.jsxs("div",{className:"mb-4 rounded-xl border border-slate-200 bg-slate-50 p-3",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-bold text-slate-700",children:"Filter by Area"}),y&&e.jsxs("button",{onClick:w,className:"flex items-center gap-1 text-xs text-slate-500 hover:text-slate-700",children:[e.jsx(Z,{size:12})," Clear"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.length>0?n.map(g=>e.jsxs("button",{onClick:()=>j(g===y?"":g),className:`flex items-center gap-1 rounded-full px-3 py-1 text-xs font-medium transition-colors ${y===g?"bg-emerald-600 text-white":"bg-white text-slate-600 hover:bg-emerald-50"}`,children:[e.jsx(oe,{size:10}),g]},g)):e.jsx("p",{className:"text-xs text-slate-400",children:"No areas available"})})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(cs,{size:16,className:"absolute top-1/2 left-3 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search hosts...",value:c,onChange:g=>A(g.target.value),className:"w-full rounded-xl border border-slate-200 bg-white py-2.5 pr-4 pl-9 text-sm font-medium text-slate-900 placeholder:text-slate-400 focus:border-emerald-300 focus:ring-2 focus:ring-emerald-100 focus:outline-none"})]}),p?e.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:e.jsx("div",{className:"animate-pulse",children:e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Loading hosts..."})})}):z.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:z.map(g=>e.jsx(ws,{point:g,onBook:i,compact:!0},g.id))}):e.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"No Sehri hosts found"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Try a different search term or clear filters"})]})]})]})}const se={LIST:"/offerings",CREATE:"/offerings",BULK_CREATE:"/offerings/bulk",UPDATE:s=>`/offerings/${s}`,DELETE:s=>`/offerings/${s}`,STATS:"/offerings/stats"},te={getAll:async()=>$.get(se.LIST),create:async s=>$.post(se.CREATE,s),bulkCreate:async s=>$.post(se.BULK_CREATE,{offerings:s}),update:async(s,a)=>$.put(se.UPDATE(s),a),delete:async s=>$.delete(se.DELETE(s)),getStats:async()=>$.get(se.STATS)},pe=30,Us=new Date("2026-02-19"),Hs=()=>Array.from({length:pe},(s,a)=>{const r=a+1,i=new Date(Us);return i.setDate(i.getDate()+a),{day:r,date:i,dateStr:i.toLocaleDateString("en-IN",{day:"numeric",month:"short"}),fullDate:i.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})}}),Ne=Hs();function Vs({onClose:s,onSave:a,editingPoint:r,loading:i}){var V,U,Q,X;const[n,d]=l.useState("single"),[p,c]=l.useState(r?[r.ramzan_day]:[1]),[A]=l.useState("sehar"),[y,o]=l.useState((r==null?void 0:r.menu_items)||""),[x,_]=l.useState(((V=r==null?void 0:r.capacity)==null?void 0:V.toString())||"50"),[k,z]=l.useState((r==null?void 0:r.price_type)||"free"),[j,w]=l.useState(((U=r==null?void 0:r.price_amount)==null?void 0:U.toString())||""),[R,g]=l.useState((r==null?void 0:r.delivery_available)||!1),[u,F]=l.useState(((Q=r==null?void 0:r.timing_from)==null?void 0:Q.slice(0,5))||"04:00"),[S,B]=l.useState(((X=r==null?void 0:r.timing_to)==null?void 0:X.slice(0,5))||"05:30"),[T,I]=l.useState((r==null?void 0:r.message)||""),D="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",C="w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",M=N=>{c(n==="single"?[N]:q=>q.includes(N)?q.filter(t=>t!==N):[...q,N])},G=()=>{p.length===pe?c([]):c(Array.from({length:pe},(N,q)=>q+1))},K=N=>{if(N.preventDefault(),p.length===0){h.error("Please select at least one day");return}if(!y.trim()){h.error("Please enter menu items");return}const q={meal_type:A,menu_items:y.trim(),capacity:Number.parseInt(x)||50,price_type:k,price_amount:k==="paid"?Number.parseFloat(j)||0:null,delivery_available:R,timing_from:u,timing_to:S,message:T.trim()||null};if(r)a({...q,id:r.id});else if(n==="single")a({...q,ramzan_day:p[0]});else{const t=p.map(v=>({...q,ramzan_day:v}));a({bulk:!0,offerings:t})}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-slate-900/40 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-4 sm:slide-in-from-bottom-0 sm:zoom-in-95 max-h-[90vh] w-full max-w-lg overflow-y-auto rounded-2xl bg-white p-6 shadow-xl",children:[e.jsxs("div",{className:"mb-5 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-black text-slate-900",children:[r?"Edit":"Add"," Sehar Offering"]}),e.jsx("button",{onClick:s,className:"rounded-full p-1.5 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(Z,{size:18})})]}),e.jsxs("form",{onSubmit:K,className:"space-y-4",children:[!r&&e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{type:"button",onClick:()=>{d("single"),c([1])},className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${n==="single"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Single Day"}),e.jsx("button",{type:"button",onClick:()=>d("bulk"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${n==="bulk"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Multiple Days"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsxs("label",{className:"block text-xs font-bold text-slate-500",children:[e.jsx(de,{size:12,className:"mr-1 inline"}),n==="single"?"Select Ramzan Day":"Select Days"]}),n==="bulk"&&!r&&e.jsx("button",{type:"button",onClick:G,className:"text-[10px] font-bold text-emerald-600 hover:underline",children:p.length===pe?"Deselect All":"Select All"})]}),n==="single"||r?e.jsx("select",{value:p[0],onChange:N=>c([Number.parseInt(N.target.value)]),className:D,disabled:!!r,children:Ne.map(N=>e.jsxs("option",{value:N.day,children:["Day ",N.day," - ",N.fullDate]},N.day))}):e.jsx("div",{className:"grid max-h-32 grid-cols-5 gap-1.5 overflow-y-auto rounded-xl border border-slate-200 bg-slate-50 p-2",children:Ne.map(N=>e.jsx("button",{type:"button",onClick:()=>M(N.day),className:`rounded-lg px-2 py-1.5 text-[10px] font-bold transition-all ${p.includes(N.day)?"bg-emerald-600 text-white":"bg-white text-slate-600 hover:bg-emerald-50"}`,children:N.day},N.day))}),n==="bulk"&&p.length>0&&e.jsxs("p",{className:"mt-1 text-[10px] text-emerald-600",children:[p.length," days selected"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(fe,{size:12,className:"mr-1 inline"}),"Meal Type"]}),e.jsx("div",{className:"rounded-xl border border-slate-200 bg-emerald-50 px-4 py-3 text-sm font-bold text-emerald-700",children:"Sehar (Pre-dawn meal)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Menu Items *"}),e.jsx("textarea",{required:!0,placeholder:"e.g., Biryani, Kheer, Dates, Rooh Afza, Chai...",className:D+" resize-none",rows:2,value:y,onChange:N=>o(N.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(ce,{size:12,className:"mr-1 inline"}),"Capacity *"]}),e.jsx("input",{type:"number",required:!0,min:"1",max:"10000",placeholder:"No. of people",className:C,value:x,onChange:N=>_(N.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(us,{size:12,className:"mr-1 inline"}),"Price Type"]}),e.jsxs("select",{value:k,onChange:N=>z(N.target.value),className:C,children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"paid",children:"Paid"})]})]})]}),k==="paid"&&e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Amount per person (â‚¹)"}),e.jsx("input",{type:"number",required:!0,min:"1",placeholder:"Enter amount",className:C,value:j,onChange:N=>w(N.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(ae,{size:12,className:"mr-1 inline"}),"Service Timings"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"time",className:C,value:u,onChange:N=>F(N.target.value)}),e.jsx("input",{type:"time",className:C,value:S,onChange:N=>B(N.target.value)})]}),e.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"From - To (e.g., 4:00 AM - 5:30 AM)"})]}),e.jsxs("div",{className:"flex items-center gap-3 rounded-xl border border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("input",{type:"checkbox",id:"delivery",checked:R,onChange:N=>g(N.target.checked),className:"h-4 w-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-500"}),e.jsxs("label",{htmlFor:"delivery",className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[e.jsx(ke,{size:16,className:"text-slate-400"}),"Delivery Available"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(hs,{size:12,className:"mr-1 inline"}),"Additional Message (Optional)"]}),e.jsx("textarea",{placeholder:"Any special instructions or notes...",className:D+" resize-none",rows:2,value:T,onChange:N=>I(N.target.value)})]}),e.jsx("button",{type:"submit",disabled:i,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",children:i?e.jsxs(e.Fragment,{children:[e.jsx(L,{size:16,className:"animate-spin"}),"Saving..."]}):r?"Update Offering":n==="bulk"?`Add ${p.length} Offering${p.length>1?"s":""}`:"Add Offering"})]})]})})}function Ys({user:s}){const[a,r]=l.useState("offerings"),[i,n]=l.useState(!1),[d,p]=l.useState(null),[c,A]=l.useState([]),[y,o]=l.useState([]),[x,_]=l.useState({total:0,confirmed:0,completed:0,cancelled:0,no_show:0}),[k,z]=l.useState("all"),[j,w]=l.useState(!1),[R,g]=l.useState(!1),[u,F]=l.useState(!1),[S,B]=l.useState(null),[T,I]=l.useState({total_offerings:0,total_capacity:0,total_booked:0});l.useEffect(()=>{D(),C(),M()},[]),l.useEffect(()=>{M()},[k]);const D=async()=>{w(!0);try{const t=await te.getAll();t.success&&A(t.offerings||[])}catch{h.error("Failed to load offerings")}finally{w(!1)}},C=async()=>{try{const t=await te.getStats();t.success&&I(t.stats)}catch(t){console.error("Failed to load stats",t)}},M=async()=>{g(!0);try{const t=await Ts(k);t.success&&(o(t.bookings||[]),t.stats&&_(t.stats))}catch{h.error("Failed to load bookings")}finally{g(!1)}},G=async(t,v)=>{B(t);try{const E=await Is(t,v);E.success?(h.success("Status updated"),o(W=>W.map(H=>H.id===t?{...H,status:v}:H)),await M(),await C()):h.error(E.message||"Failed to update status")}catch{h.error("Failed to update status")}finally{B(null)}},K=T.total_offerings||c.length,V=x.total||0,U=x.confirmed||0,Q=async t=>{F(!0);try{if(t.bulk){const v=await te.bulkCreate(t.offerings);v.success?(h.success(`${v.created_count} offerings created successfully!`),await D(),await C(),n(!1)):h.error(v.message||"Failed to create offerings")}else if(t.id){const v=await te.update(t.id,t);v.success?(h.success("Offering updated successfully"),await D(),await C(),n(!1)):h.error(v.message||"Failed to update offering")}else{const v=await te.create(t);v.success?(h.success("Offering created successfully"),await D(),await C(),n(!1)):h.error(v.message||"Failed to create offering")}}catch(v){h.error(v.message||"An error occurred")}finally{F(!1),p(null)}},X=async t=>{if(window.confirm("Delete this food offering?"))try{const v=await te.delete(t);v.success?(h.success("Offering deleted"),await D(),await C()):h.error(v.message||"Failed to delete")}catch{h.error("Failed to delete offering")}},N=t=>{switch(t){case"confirmed":return"bg-emerald-50 text-emerald-600";case"completed":return"bg-blue-50 text-blue-600";case"cancelled":return"bg-red-50 text-red-500";case"no_show":return"bg-amber-50 text-amber-600";default:return"bg-slate-100 text-slate-500"}},q=t=>{const v=["th","st","nd","rd"],E=t%100;return t+(v[(E-20)%10]||v[E]||v[0])};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-slate-900",children:"Host Dashboard"}),e.jsx("p",{className:"text-xs font-medium text-slate-500",children:(s==null?void 0:s.place_name)||"Manage your Sehri distribution"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"rounded-xl bg-emerald-50 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-emerald-600",children:K}),e.jsx("p",{className:"text-[10px] font-bold text-emerald-700 uppercase",children:"Offerings"})]}),e.jsxs("div",{className:"rounded-xl bg-slate-100 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-slate-700",children:V}),e.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:"Bookings"})]}),e.jsxs("div",{className:"rounded-xl bg-blue-50 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-blue-600",children:U}),e.jsx("p",{className:"text-[10px] font-bold text-blue-700 uppercase",children:"Confirmed"})]})]}),e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{onClick:()=>r("offerings"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${a==="offerings"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Food Offerings"}),e.jsx("button",{onClick:()=>r("bookings"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${a==="bookings"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Bookings"})]}),a==="offerings"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-bold text-slate-700",children:"My Offerings"}),e.jsxs("button",{onClick:()=>{p(null),n(!0)},className:"flex items-center gap-1.5 rounded-lg bg-emerald-600 px-3 py-2 text-xs font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:[e.jsx(Pe,{size:14}),"Add Day"]})]}),j?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(L,{size:24,className:"animate-spin text-emerald-600"})}):e.jsx("div",{className:"space-y-3",children:c.length>0?c.sort((t,v)=>t.ramzan_day-v.ramzan_day).map(t=>{var E,W;const v=Ne.find(H=>H.day===t.ramzan_day);return e.jsxs("div",{className:"rounded-xl border border-slate-100 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 text-xs font-black text-emerald-700",children:[q(t.ramzan_day)," Ramzan"]}),e.jsx("span",{className:"text-[10px] text-slate-400",children:v==null?void 0:v.fullDate}),e.jsx("span",{className:"rounded bg-slate-100 px-1.5 py-0.5 text-[9px] font-bold text-slate-600 uppercase",children:t.meal_type})]}),e.jsx("span",{className:`rounded-lg px-2 py-0.5 text-[9px] font-black uppercase ${t.price_type==="free"?"bg-emerald-50 text-emerald-600":"bg-amber-50 text-amber-600"}`,children:t.price_type==="free"?"Free":`â‚¹${t.price_amount}`})]}),e.jsxs("p",{className:"mt-2 text-xs text-slate-600 italic",children:['"',t.menu_items,'"']}),t.message&&e.jsxs("p",{className:"mt-1 text-[10px] text-slate-400",children:["ðŸ’¬ ",t.message]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-3 text-[10px] text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ce,{size:10}),t.booked_count||0,"/",t.capacity]}),e.jsx("span",{className:`${(t.booked_count||0)>=t.capacity?"text-red-500":"text-emerald-600"}`,children:(t.booked_count||0)>=t.capacity?"Full":`${t.capacity-(t.booked_count||0)} left`}),t.timing_from&&t.timing_to&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ae,{size:10}),(E=t.timing_from)==null?void 0:E.slice(0,5)," - ",(W=t.timing_to)==null?void 0:W.slice(0,5)]}),t.delivery_available&&e.jsxs("span",{className:"flex items-center gap-1 text-emerald-600",children:[e.jsx(ke,{size:10}),"Delivery"]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between border-t border-slate-50 pt-3",children:[e.jsx("span",{className:`rounded px-1.5 py-0.5 text-[9px] font-bold uppercase ${t.status==="active"?"bg-emerald-50 text-emerald-600":"bg-slate-100 text-slate-500"}`,children:t.status}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>{p(t),n(!0)},className:"rounded-lg p-1.5 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(os,{size:14})}),e.jsx("button",{onClick:()=>X(t.id),className:"rounded-lg p-1.5 text-slate-400 hover:bg-red-50 hover:text-red-500",children:e.jsx(ds,{size:14})})]})]})]},t.id)}):e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-12 text-center",children:[e.jsx(fe,{size:32,className:"mx-auto mb-3 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-500",children:"No offerings yet"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Add food offerings for specific Ramzan days"})]})})]}),a==="bookings"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-bold text-slate-700",children:"Manage Bookings"}),e.jsxs("button",{onClick:M,disabled:R,className:"flex items-center gap-1.5 rounded-lg bg-slate-100 px-3 py-2 text-xs font-bold text-slate-600 transition-all hover:bg-slate-200 active:scale-95 disabled:opacity-50",children:[e.jsx(Le,{size:14,className:R?"animate-spin":""}),"Refresh"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"all",label:"All",count:x.total},{value:"confirmed",label:"Confirmed",count:x.confirmed},{value:"completed",label:"Completed",count:x.completed},{value:"cancelled",label:"Cancelled",count:x.cancelled},{value:"no_show",label:"No Show",count:x.no_show}].map(t=>e.jsxs("button",{onClick:()=>z(t.value),className:`rounded-lg px-3 py-1.5 text-[10px] font-bold transition-all ${k===t.value?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[t.label," (",t.count||0,")"]},t.value))}),R?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(L,{size:24,className:"animate-spin text-emerald-600"})}):e.jsx("div",{className:"space-y-3",children:y.length>0?y.map(t=>{var v,E;return e.jsxs("div",{className:`rounded-xl border bg-white p-4 transition-all ${t.status==="cancelled"||t.status==="no_show"?"border-slate-200 opacity-70":"border-slate-100"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900",children:t.seeker_name}),e.jsxs("div",{className:"mt-1 flex flex-col gap-1 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{size:12}),e.jsx("a",{href:`tel:${t.seeker_phone}`,className:"hover:text-emerald-600",children:t.seeker_phone})]}),t.seeker_email&&e.jsx("span",{className:"text-[10px] text-slate-400",children:t.seeker_email})]})]}),e.jsx("span",{className:`rounded-lg px-2 py-1 text-[10px] font-bold uppercase ${N(t.status)}`,children:t.status})]}),t.menu_items&&e.jsxs("p",{className:"mt-2 text-xs text-slate-500 italic",children:['"',t.menu_items,'"']}),e.jsxs("div",{className:"mt-3 rounded-lg bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 font-bold text-emerald-700",children:[q(t.ramzan_day)," Ramzan"]}),e.jsxs("span",{className:"flex items-center gap-1 text-slate-500",children:[e.jsx(de,{size:12}),t.formatted_date]}),e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5 text-[10px] font-bold text-slate-600 uppercase",children:t.meal_type})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs text-slate-600",children:[e.jsxs("span",{className:"flex items-center gap-1 font-bold",children:[e.jsx(ce,{size:12}),t.quantity," person(s)"]}),e.jsx("span",{className:"font-bold",children:t.total_amount>0?`â‚¹${t.total_amount}`:"Free"}),t.timing_from&&t.timing_to&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ae,{size:12}),(v=t.timing_from)==null?void 0:v.slice(0,5)," - ",(E=t.timing_to)==null?void 0:E.slice(0,5)]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsx("span",{className:"rounded bg-slate-100 px-2 py-1 font-mono text-[10px] text-slate-500",children:t.booking_code}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:["Booked: ",new Date(t.created_at).toLocaleDateString("en-IN")]})]}),t.status==="confirmed"&&e.jsxs("div",{className:"mt-4 flex gap-2 border-t border-slate-100 pt-4",children:[e.jsxs("button",{onClick:()=>G(t.id,"completed"),disabled:S===t.id,className:"flex flex-1 items-center justify-center gap-1.5 rounded-xl bg-emerald-600 py-2 text-xs font-bold text-white transition-all hover:bg-emerald-700 active:scale-95 disabled:opacity-50",children:[S===t.id?e.jsx(L,{size:14,className:"animate-spin"}):e.jsx(Me,{size:14}),"Mark Completed"]}),e.jsxs("button",{onClick:()=>G(t.id,"no_show"),disabled:S===t.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-amber-200 bg-amber-50 px-4 py-2 text-xs font-bold text-amber-600 transition-all hover:bg-amber-100 active:scale-95 disabled:opacity-50",children:[e.jsx(xs,{size:14}),"No Show"]}),e.jsxs("button",{onClick:()=>G(t.id,"cancelled"),disabled:S===t.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-xs font-bold text-red-600 transition-all hover:bg-red-100 active:scale-95 disabled:opacity-50",children:[e.jsx(ms,{size:14}),"Cancel"]})]}),(t.status==="cancelled"||t.status==="no_show")&&e.jsx("div",{className:"mt-3 border-t border-slate-100 pt-3",children:e.jsxs("button",{onClick:()=>G(t.id,"confirmed"),disabled:S===t.id,className:"flex items-center gap-1.5 text-xs font-bold text-emerald-600 hover:text-emerald-700",children:[S===t.id?e.jsx(L,{size:12,className:"animate-spin"}):e.jsx(Ie,{size:12}),"Restore Booking"]})})]},t.id)}):e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-12 text-center",children:[e.jsx(ce,{size:32,className:"mx-auto mb-3 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-500",children:k==="all"?"No bookings yet":`No ${k} bookings`}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Guest reservations will appear here"})]})})]}),i&&e.jsx(Vs,{onClose:()=>{n(!1),p(null)},onSave:Q,editingPoint:d,loading:u})]})}function Ks(){const[s,a]=l.useState([]),[r,i]=l.useState(!0),[n,d]=l.useState(null),p=o=>{const x=["th","st","nd","rd"],_=o%100;return o+(x[(_-20)%10]||x[_]||x[0])},c=async()=>{i(!0);try{const o=await Ds();o.success?a(o.bookings||[]):h.error(o.message||"Failed to load bookings")}catch{h.error("Failed to load bookings")}finally{i(!1)}};l.useEffect(()=>{c()},[]);const A=async o=>{if(globalThis.confirm("Are you sure you want to cancel this booking?")){d(o);try{const x=await Es(o);x.success?(h.success("Booking cancelled"),a(_=>_.map(k=>k.id===o?{...k,status:"cancelled"}:k))):h.error(x.message||"Failed to cancel")}catch{h.error("Failed to cancel booking")}finally{d(null)}}},y=o=>{switch(o){case"confirmed":return"bg-emerald-100 text-emerald-700";case"completed":return"bg-blue-100 text-blue-700";case"cancelled":return"bg-red-100 text-red-700";case"no_show":return"bg-amber-100 text-amber-700";default:return"bg-slate-100 text-slate-700"}};return r?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(L,{size:32,className:"animate-spin text-emerald-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-slate-900",children:"My Reservations"}),e.jsxs("p",{className:"text-xs text-slate-500",children:[s.length," Sehri reservation(s)"]})]}),e.jsx("button",{onClick:c,className:"rounded-lg bg-slate-100 p-2 text-slate-600 transition-all hover:bg-slate-200 active:scale-95",children:e.jsx(Le,{size:16})})]}),s.length===0?e.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-16 text-center",children:[e.jsx(Ee,{size:48,className:"mx-auto mb-4 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-600",children:"No Sehri reservations yet"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Browse hosts & reserve your Sehri from Home"})]}):e.jsx("div",{className:"space-y-4",children:s.map(o=>e.jsxs("div",{className:`rounded-2xl border bg-white p-4 shadow-sm ${o.status==="cancelled"?"border-slate-200 opacity-60":"border-slate-100"}`,children:[e.jsxs("div",{className:"mb-3 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-black text-slate-900",children:o.provider_name}),e.jsxs("div",{className:"mt-1 flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(oe,{size:12}),o.area]})]}),e.jsx("span",{className:`rounded-lg px-2 py-1 text-[10px] font-bold uppercase ${y(o.status)}`,children:o.status})]}),e.jsxs("div",{className:"rounded-xl bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 font-bold text-emerald-700",children:[p(o.ramzan_day)," Ramzan"]}),e.jsxs("span",{className:"flex items-center gap-1 text-slate-500",children:[e.jsx(de,{size:12}),o.formatted_date]}),e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5 text-[10px] font-bold text-slate-600",children:o.meal_type})]}),o.timing&&e.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-slate-500",children:[e.jsx(ae,{size:12}),o.timing]}),e.jsxs("p",{className:"mt-2 text-xs text-slate-500 italic",children:['"',o.menu_items,'"']})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-600",children:[e.jsxs("span",{className:"font-bold",children:["ðŸ‘¥ ",o.quantity," person(s)"]}),e.jsx("span",{className:"font-bold",children:o.price_type==="free"||o.total_amount===0?"ðŸ†“ Free":`ðŸ’° â‚¹${o.total_amount}`})]}),e.jsx("span",{className:"rounded bg-slate-100 px-2 py-1 font-mono text-[10px] text-slate-500",children:o.booking_code})]}),o.status==="confirmed"&&e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs("a",{href:`tel:${o.provider_phone}`,className:"flex flex-1 items-center justify-center gap-1.5 rounded-xl border border-slate-200 bg-white py-2 text-xs font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-95",children:[e.jsx(we,{size:14})," Call Host"]}),e.jsxs("button",{onClick:()=>A(o.id),disabled:n===o.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-xs font-bold text-red-600 transition-all hover:bg-red-100 active:scale-95 disabled:opacity-50",children:[n===o.id?e.jsx(L,{size:14,className:"animate-spin"}):e.jsx(Z,{size:14}),"Cancel"]})]}),e.jsxs("p",{className:"mt-3 text-[10px] text-slate-400",children:["Booked on ",o.booked_at]})]},o.id))})]})}function Js({duas:s}){return e.jsxs("div",{className:"space-y-12",children:[e.jsxs("h2",{className:"text-5xl font-black tracking-tighter text-slate-950 md:text-7xl",children:["Daily ",e.jsx("span",{className:"text-emerald-600",children:"Duas."})]}),e.jsx("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2",children:s.map(a=>e.jsx(ks,{dua:a},a.id))}),s.length===0&&e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-lg font-bold text-slate-400",children:"No duas available"})})]})}function Oe({events:s,onInterested:a}){return e.jsxs("div",{className:"space-y-12",children:[e.jsxs("h2",{className:"text-5xl font-black tracking-tighter text-slate-950 md:text-7xl",children:["Community ",e.jsx("span",{className:"text-emerald-600",children:"Events."})]}),e.jsx("div",{className:"space-y-4",children:s.map(r=>e.jsx(Ss,{event:r,onInterested:a},r.id))}),s.length===0&&e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("p",{className:"text-lg font-bold text-slate-400",children:"No events scheduled"}),e.jsx("p",{className:"text-sm text-slate-300",children:"Check back later for upcoming events"})]})]})}function Ws({message:s,onClose:a}){return s?e.jsxs("div",{className:"animate-in fade-in slide-in-from-top-10 fixed top-8 left-1/2 z-[200] flex -translate-x-1/2 items-center gap-3 rounded-full bg-slate-950 px-8 py-4 text-white shadow-2xl",children:[e.jsx(Me,{className:"text-emerald-400",size:18}),e.jsx("span",{className:"text-sm font-black tracking-tight",children:s}),e.jsx("button",{onClick:a,className:"text-slate-500 transition-colors hover:text-white",children:e.jsx(Z,{size:16})})]}):null}const he="ramzania_user_location";async function Zs(s,a){try{const i=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${a}&zoom=14&addressdetails=1`,{headers:{"Accept-Language":"en"}})).json();if(i&&i.address){const{suburb:n,neighbourhood:d,city:p,town:c,village:A,state_district:y,state:o,country:x}=i.address;return{raw:i,area:n||d||p||c||A||y||""||"Unknown Area",fullAddress:i.display_name||"",city:p||c||A||y||"",state:o||"",country:x||"",addressDetails:i.address}}return null}catch(r){return console.error("Reverse geocoding failed:",r),null}}function Qs(){const[s,a]=l.useState(null),[r,i]=l.useState(null),[n,d]=l.useState(!1),[p,c]=l.useState(null),[A,y]=l.useState("prompt");l.useEffect(()=>{navigator.permissions&&navigator.permissions.query({name:"geolocation"}).then(j=>{y(j.state),j.onchange=()=>{y(j.state)}})},[]),l.useEffect(()=>{const j=localStorage.getItem(he);if(j)try{const w=JSON.parse(j);w.lat&&w.lng&&a({lat:w.lat,lng:w.lng}),w.address&&i(w.address)}catch{localStorage.removeItem(he)}},[]),l.useEffect(()=>{A==="granted"&&!s&&x()},[A]);const o=l.useCallback((j,w)=>{a(j),i(w),localStorage.setItem(he,JSON.stringify({lat:j.lat,lng:j.lng,address:w,timestamp:Date.now()}))},[]),x=l.useCallback(async()=>{if(!navigator.geolocation){c("Geolocation is not supported");return}d(!0),c(null),navigator.geolocation.getCurrentPosition(async j=>{const w={lat:j.coords.latitude,lng:j.coords.longitude},R=await Zs(w.lat,w.lng);o(w,R),d(!1)},j=>{j.code===j.PERMISSION_DENIED?(c("Location permission denied"),y("denied")):j.code===j.POSITION_UNAVAILABLE?c("Location unavailable"):j.code===j.TIMEOUT?c("Location request timed out"):c("Enable GPS to see distance"),d(!1)},{timeout:1e4,enableHighAccuracy:!0})},[o]),_=l.useCallback(()=>{x()},[x]),k=l.useCallback((j,w)=>{if(!s)return null;const R=6371,g=(j-s.lat)*Math.PI/180,u=(w-s.lng)*Math.PI/180,F=Math.sin(g/2)*Math.sin(g/2)+Math.cos(s.lat*Math.PI/180)*Math.cos(j*Math.PI/180)*Math.sin(u/2)*Math.sin(u/2),S=2*Math.atan2(Math.sqrt(F),Math.sqrt(1-F));return R*S},[s]),z=l.useCallback(()=>{a(null),i(null),localStorage.removeItem(he)},[]);return{location:s,address:r,isLocating:n,error:p,permissionStatus:A,requestLocation:_,calculateDistance:k,clearLocation:z}}function Xs(){const[s,a]=l.useState([]),[r,i]=l.useState([]),[n,d]=l.useState([]),[p,c]=l.useState({sehar:"04:52 AM",iftar:"06:24 PM",area:"Chennai"}),[A,y]=l.useState(null),[o,x]=l.useState(!0),[_,k]=l.useState(null),[z,j]=l.useState(null),[w,R]=l.useState([]),[g,u]=l.useState({area:"",place:""}),F=l.useCallback(()=>new Promise(T=>{if(!navigator.geolocation){T(null);return}navigator.geolocation.getCurrentPosition(I=>{const D={lat:I.coords.latitude,lng:I.coords.longitude};j(D),T(D)},()=>T(null),{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})}),[]),S=l.useCallback(async(T=null,I={})=>{var D;x(!0),k(null);try{const C={...T||z||{},...I},[M,G,K,V,U]=await Promise.all([ie.fetchPoints(C),ie.fetchDuas(),ie.fetchEvents(),ie.fetchTimings(),ie.fetchRamzanTimings()]);a(M.providers||[]),R(((D=M.filters)==null?void 0:D.areas)||[]),i(G),d(K),c(V),U.success&&U.timing&&y(U.timing)}catch(C){k(C.message||"Failed to fetch data")}finally{x(!1)}},[z]);l.useEffect(()=>{(async()=>{const I=await F();await S(I)})()},[]);const B=l.useCallback(async T=>{u(T),await S(z,T)},[S,z]);return{points:s,duas:r,events:n,timings:p,ramzanTiming:A,loading:o,error:_,userLocation:z,availableAreas:w,filters:g,refetch:()=>S(z,g),refetchWithFilters:B,setFilters:B}}const je="ramzania_user";function nt(){const[s,a]=l.useState(null),[r,i]=l.useState(!1),[n,d]=l.useState("home"),[p,c]=l.useState(null),[A,y]=l.useState(null),{points:o,duas:x,events:_,timings:k,ramzanTiming:z,availableAreas:j,refetchWithFilters:w,loading:R}=Xs(),{address:g,isLocating:u,requestLocation:F}=Qs();l.useEffect(()=>{const C=localStorage.getItem(je);if(C){const M=JSON.parse(C);a(M),d(M.role==="provider"?"dashboard":"home")}},[]);const S=C=>{a(C),localStorage.setItem(je,JSON.stringify(C)),i(!1),d(C.role==="provider"?"dashboard":"home")},B=()=>{localStorage.removeItem(je),a(null),d("home")},T=C=>{y(C),c(null)},I=C=>{y(`Marked interest for ${C.title}`)},D=()=>{if((s==null?void 0:s.role)==="provider")switch(n){case"events":return e.jsx(Oe,{events:_,onInterested:I});case"settings":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-black text-slate-900",children:"Settings"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Host settings coming soon..."})]});case"dashboard":default:return e.jsx(Ys,{user:s})}switch(n){case"duas":return e.jsx(Js,{duas:x});case"events":return e.jsx(Oe,{events:_,onInterested:I});case"bookings":return e.jsx(Ks,{});case"home":default:return e.jsx(Gs,{timings:k,ramzanTiming:z,points:o,onBook:c,availableAreas:j,onFilterChange:w,loading:R})}};return e.jsxs("div",{className:"min-h-screen bg-white pb-20 font-sans text-slate-900 selection:bg-emerald-100 sm:pb-16",children:[e.jsx(ps,{user:s,onLogout:B,onJoinClick:()=>i(!0),address:g,isLocating:u,onRequestLocation:F}),e.jsx("main",{className:"mx-auto max-w-lg px-4 py-6 sm:max-w-2xl sm:px-6 sm:py-8",children:D()}),e.jsx(js,{activeView:n,onViewChange:d,userRole:s==null?void 0:s.role,user:s}),r&&e.jsx(_s,{onClose:()=>i(!1),onSuccess:S}),p&&e.jsx(qs,{point:p,user:s,onClose:()=>c(null),onSuccess:T,onLoginClick:()=>{c(null),i(!0)}}),e.jsx(Ws,{message:A,onClose:()=>y(null)})]})}export{nt as default};
