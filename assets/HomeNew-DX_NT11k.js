import{j as e}from"./vendor-ui-B2jkoGl9.js";import{L as B,j as re,f as Ze,k as ye,h as Qe,B as ve,g as Xe,H as De,T as Ee,l as Ie,m as es,n as ss,o as de,U as fe,P as we,p as ts,q as as,r as ue,X as W,s as ls,a as Pe,t as le,u as ke,v as oe,w as rs,x as Te,y as ns,z as is,S as cs,D as os,E as ds,R as $e,G as Me,I as xs,J as ms,K as us,N as hs}from"./vendor-other-bujeOmyr.js";import{a as V,s as Re,t as u,b as q}from"./index-CjH6G6uF.js";import{a as r}from"./vendor-react-Cc-oBOCu.js";import"./vendor-recharts-LMBWezzC.js";function ps({user:s,onLogout:a,onJoinClick:l,address:n,isLocating:c,onRequestLocation:o}){return e.jsx("nav",{className:"sticky top-0 z-50 w-full border-b border-slate-100/50 bg-white/70 px-4 py-3 backdrop-blur-xl sm:px-6 sm:py-4",children:e.jsxs("div",{className:"mx-auto flex max-w-6xl items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-emerald-600 text-lg font-black text-white shadow-lg shadow-emerald-100 sm:h-10 sm:w-10 sm:rounded-2xl sm:text-xl",children:"R"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-lg leading-none font-black tracking-tighter sm:text-xl",children:["RAMZAN",e.jsx("span",{className:"text-emerald-600",children:"IA"})]}),e.jsx("button",{onClick:o,className:"mt-0.5 flex items-center gap-1 text-[9px] font-bold tracking-wide text-slate-400 transition-colors hover:text-emerald-600",children:c?e.jsxs(e.Fragment,{children:[e.jsx(B,{size:8,className:"animate-spin"}),e.jsx("span",{children:"Locating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{size:8}),e.jsx("span",{className:"max-w-[120px] truncate sm:max-w-[180px]",children:(n==null?void 0:n.city)||(n==null?void 0:n.area)||"Set Location"})]})})]})]}),e.jsx("div",{className:"flex items-center gap-3 sm:gap-4",children:s?e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsxs("div",{className:"hidden text-right sm:block",children:[e.jsx("p",{className:"text-xs font-black text-slate-900",children:s.name}),e.jsx("p",{className:"text-[10px] font-bold text-emerald-600 uppercase",children:s.role==="provider"?"HOST":"GUEST"})]}),e.jsx("button",{onClick:a,className:"flex h-9 w-9 items-center justify-center rounded-xl border border-slate-200 bg-slate-50 text-slate-400 transition-all hover:text-red-500 sm:h-10 sm:w-10 sm:rounded-2xl","aria-label":"Logout",children:e.jsx(Ze,{size:16,className:"sm:h-[18px] sm:w-[18px]"})})]}):e.jsxs("button",{onClick:l,className:"flex items-center justify-center gap-1.5 rounded-xl bg-emerald-600 px-4 py-2 text-xs font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-95 sm:gap-2 sm:rounded-2xl sm:px-5 sm:text-sm",children:[e.jsx(ye,{size:14,className:"sm:h-4 sm:w-4"}),"Join"]})})]})})}const fs=[{id:"home",label:"Home",icon:De},{id:"duas",label:"Duas",icon:Ie},{id:"events",label:"Events",icon:ve}],gs=[{id:"home",label:"Home",icon:De},{id:"bookings",label:"Reserved",icon:Ee},{id:"duas",label:"Duas",icon:Ie},{id:"events",label:"Events",icon:ve}],bs=[{id:"dashboard",label:"Dashboard",icon:Qe},{id:"events",label:"Events",icon:ve},{id:"settings",label:"Settings",icon:Xe}];function js({activeView:s,onViewChange:a,userRole:l="seeker",user:n=null}){let c;return l==="provider"?c=bs:n?c=gs:c=fs,e.jsxs(e.Fragment,{children:[e.jsx("nav",{className:"fixed bottom-0 z-50 flex w-full items-center justify-around border-t border-slate-100 bg-white px-6 py-3 pb-6 shadow-[0_-10px_30px_rgba(0,0,0,0.03)] sm:hidden",children:c.map(o=>e.jsxs("button",{onClick:()=>a(o.id),className:`flex flex-col items-center gap-1 rounded-xl px-4 py-2 transition-all ${s===o.id?"bg-emerald-50 text-emerald-600":"text-slate-400 hover:text-slate-600"}`,"aria-label":o.label,children:[e.jsx(o.icon,{size:20}),e.jsx("span",{className:"text-[10px] font-bold",children:o.label})]},o.id))}),e.jsx("div",{className:"fixed bottom-6 left-1/2 z-50 hidden -translate-x-1/2 sm:block",children:e.jsx("div",{className:"flex gap-1 rounded-2xl bg-slate-950 p-1.5 text-white shadow-2xl shadow-slate-950/20",children:c.map(o=>e.jsx("button",{onClick:()=>a(o.id),className:`rounded-xl px-6 py-2.5 text-[10px] font-black tracking-wider uppercase transition-all ${s===o.id?"bg-emerald-600 text-white":"text-slate-400 hover:text-white"}`,children:o.label},o.id))})})]})}function Ns({time:s,compact:a=!1}){return e.jsxs("div",{className:`group relative overflow-hidden border-none bg-emerald-600 text-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-emerald-200/40 ${a?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsx(es,{size:a?60:100,className:"absolute -top-4 -right-4 text-emerald-500/30 transition-transform duration-500 group-hover:scale-110"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("span",{className:`block font-black tracking-wider text-emerald-200 uppercase ${a?"mb-1 text-[8px]":"mb-8 text-[10px]"}`,children:"Imsak (Sehar)"}),e.jsx("h4",{className:`font-black tracking-tight ${a?"text-3xl":"text-5xl"}`,children:s}),!a&&e.jsx("p",{className:"mt-1 text-sm font-medium text-emerald-100/80",children:"Stop eating and intend to fast."})]})]})}function ys({time:s,compact:a=!1}){return e.jsxs("div",{className:`group relative overflow-hidden border-none bg-slate-950 text-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-slate-200/40 ${a?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsx(ss,{size:a?60:100,className:"absolute -top-4 -right-4 text-slate-800/50 transition-transform duration-500 group-hover:rotate-12"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("span",{className:`block font-black tracking-wider text-slate-400 uppercase ${a?"mb-1 text-[8px]":"mb-8 text-[10px]"}`,children:"Maghrib (Iftar)"}),e.jsx("h4",{className:`font-black tracking-tight ${a?"text-3xl":"text-5xl"}`,children:s}),!a&&e.jsx("p",{className:"mt-1 text-sm font-medium text-slate-400/80",children:"Break your fast with the sun's set."})]})]})}function vs({timings:s,compact:a=!1}){return e.jsxs("div",{className:`grid grid-cols-2 ${a?"gap-3":"gap-4"}`,children:[e.jsx(Ns,{time:s.sehar,compact:a}),e.jsx(ys,{time:s.iftar,compact:a})]})}function ws({point:s,onBook:a,compact:l=!1}){const n=c=>{const o=["th","st","nd","rd"],h=c%100;return c+(o[(h-20)%10]||o[h]||o[0])};return e.jsxs("div",{className:`flex flex-col border border-t-4 border-slate-100 border-t-emerald-500 bg-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-slate-200/40 ${l?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsxs("div",{className:`flex items-start justify-between ${l?"mb-2":"mb-4"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`leading-tight font-black text-slate-900 ${l?"text-base":"text-xl"}`,children:s.name}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[s.next_available_day&&e.jsxs("span",{className:"rounded-md bg-emerald-100 px-1.5 py-0.5 text-[10px] font-bold text-emerald-700",children:["Next: ",n(s.next_available_day)," Ramzan"]}),s.next_available_date&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-slate-400",children:[e.jsx(de,{size:10}),s.next_available_date]})]})]}),e.jsx("span",{className:`rounded-lg font-black uppercase ${l?"px-1.5 py-0.5 text-[8px]":"rounded-xl px-2 py-1 text-[9px]"} ${s.price===0?"bg-emerald-50 text-emerald-600":"bg-amber-50 text-amber-600"}`,children:s.price===0?"Free":`From â‚¹${s.price}`})]}),e.jsx("div",{className:`flex-1 bg-slate-50 text-slate-600 ${l?"mb-3 rounded-xl p-3 text-xs leading-relaxed":"mb-6 rounded-2xl p-4 text-sm leading-relaxed"}`,children:e.jsxs("span",{className:"italic",children:['"',s.menu,'"']})}),e.jsxs("div",{className:"mb-3 flex flex-wrap items-center gap-2 text-[10px] text-slate-500",children:[s.distance!==null&&s.distance!==void 0&&e.jsxs("span",{className:"flex items-center gap-1 rounded bg-blue-50 px-1.5 py-0.5 font-bold text-blue-600",children:["ðŸ“ ",s.distance," km"]}),s.total_offerings&&e.jsxs("span",{className:"flex items-center gap-1 rounded bg-emerald-50 px-1.5 py-0.5 text-emerald-600",children:[e.jsx(fe,{size:10})," ",s.total_offerings," days"]}),s.total_slots!==void 0&&e.jsxs("span",{className:"rounded bg-slate-100 px-1.5 py-0.5",children:["ðŸ‘¥ ",s.total_slots," total spots"]}),s.meal_types&&e.jsx("span",{className:"rounded bg-slate-100 px-1.5 py-0.5 uppercase",children:s.meal_types.includes(",")?"Sehar & Iftar":s.meal_types}),s.area&&e.jsxs("span",{className:"rounded bg-slate-100 px-1.5 py-0.5",children:["ðŸ“ ",s.area]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>globalThis.open(`tel:${s.phone}`),className:`flex items-center justify-center gap-1.5 rounded-xl border border-slate-200 bg-white font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-95 ${l?"px-3 py-2 text-xs":"px-6 py-3.5 text-sm"}`,children:[e.jsx(we,{size:l?12:16})," Call"]}),e.jsxs("button",{onClick:()=>globalThis.open(`https://wa.me/${s.phone.replaceAll(/\D/g,"")}`),className:`flex items-center justify-center gap-1.5 rounded-xl border border-emerald-100 bg-white font-bold text-emerald-600 transition-all hover:bg-emerald-50 active:scale-95 ${l?"px-3 py-2 text-xs":"px-6 py-3.5 text-sm"}`,children:[e.jsx(ts,{size:l?12:16})," Chat"]})]}),e.jsx("button",{onClick:()=>a(s),disabled:!s.isBookable,className:`flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-95 disabled:bg-emerald-300 disabled:opacity-50 ${l?"px-3 py-2 text-xs":"px-6 py-3.5 text-sm"}`,children:s.isBookable?"Reserve Sehri":"Info Only"})]})]})}function ks({dua:s}){return e.jsxs("div",{className:"space-y-6 rounded-[2.5rem] border border-slate-100 bg-white p-10 shadow-sm transition-all duration-500 hover:shadow-xl hover:shadow-slate-200/40",children:[e.jsx("h4",{className:"text-[10px] font-black tracking-widest text-emerald-600 uppercase",children:s.title}),e.jsx("p",{className:"text-right text-4xl leading-[1.8] font-bold text-slate-900",dir:"rtl",children:s.arabic}),e.jsxs("div",{className:"space-y-2 border-t border-slate-50 pt-6",children:[e.jsxs("p",{className:"text-sm font-bold text-emerald-700 italic",children:['"',s.transliteration,'"']}),e.jsx("p",{className:"text-sm font-medium text-slate-400",children:s.english})]})]})}function Ss({event:s,onInterested:a}){return e.jsxs("div",{className:"flex flex-col justify-between gap-6 rounded-[2.5rem] border border-slate-100 bg-white p-6 shadow-sm transition-all duration-500 hover:shadow-xl hover:shadow-emerald-100/30 md:flex-row md:items-center",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"rounded-full bg-emerald-50 px-3 py-1 text-[10px] font-black text-emerald-600 uppercase",children:s.date}),e.jsx("span",{className:"rounded-full bg-slate-50 px-3 py-1 text-[10px] font-black text-slate-400 uppercase",children:s.time})]}),e.jsx("h3",{className:"text-2xl font-black text-slate-900",children:s.title}),e.jsxs("p",{className:"text-sm font-medium text-slate-400",children:[e.jsx(re,{size:12,className:"mr-1 inline"})," ",s.location," â€¢ ",e.jsx(as,{size:12,className:"mr-1 inline"})," ",s.speaker]})]}),e.jsx("button",{onClick:()=>a==null?void 0:a(s),className:"flex items-center justify-center gap-2 rounded-2xl bg-slate-900 px-6 py-3.5 text-sm font-bold text-white transition-all hover:bg-slate-800 active:scale-95",children:"Interested"})]})}async function Cs(s,a){try{const n=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${a}&zoom=18&addressdetails=1`,{headers:{"Accept-Language":"en"}})).json();if(n!=null&&n.address){const{road:c,suburb:o,neighbourhood:h,city:d,town:C,village:k,state_district:i,state:j,postcode:g,county:S}=n.address;return{street:c||"",area:o||h||S||"",city:d||C||k||i||"",pincode:g||"",state:j||""}}return null}catch(l){return console.error("Reverse geocoding failed:",l),null}}function _s({onClose:s,onSuccess:a}){const[l,n]=r.useState("CHOICE"),[c,o]=r.useState(!1),[h,d]=r.useState(""),[C,k]=r.useState(""),[i,j]=r.useState(""),[g,S]=r.useState("seeker"),[R,N]=r.useState(""),[w,F]=r.useState(""),[f,D]=r.useState(""),[x,_]=r.useState(""),[z,I]=r.useState(""),[$,P]=r.useState(""),[T,O]=r.useState(""),[M,Z]=r.useState(""),[Y,K]=r.useState(""),[Q,X]=r.useState(null),[y,G]=r.useState(null),[t,v]=r.useState(!1),[E,J]=r.useState(""),[U,Se]=r.useState(""),[ge,Ce]=r.useState(""),[Le,_e]=r.useState(""),[ne,me]=r.useState(["","","","","",""]),[ie,ze]=r.useState(""),be=r.useRef([]),Ae=r.useCallback(async()=>{if(navigator.geolocation){v(!0);try{const m=await new Promise((L,We)=>{navigator.geolocation.getCurrentPosition(L,We,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),{latitude:p,longitude:b}=m.coords;X(p),G(b);const A=await Cs(p,b);A&&(P(A.street),O(A.area),Z(A.city),K(A.pincode))}catch(m){console.log("Location fetch failed:",m.message)}finally{v(!1)}}},[]);r.useEffect(()=>{l==="REGISTER"&&Ae()},[l,Ae]);const Be=(m,p)=>{var L;const b=m.target.value;if(isNaN(b))return;const A=[...ne];A[p]=b.slice(-1),me(A),b&&p<5&&((L=be.current[p+1])==null||L.focus())},qe=(m,p)=>{var b;m.key==="Backspace"&&!ne[p]&&p>0&&((b=be.current[p-1])==null||b.focus())},Ge=async m=>{var p,b;m.preventDefault(),d(""),o(!0);try{const A=await V.login({email:C,password:i});if(A.success)A.token&&Re.set("auth_token",A.token),u.success("Welcome back!",{description:`Logged in as ${A.user.name}`}),a(A.user);else{const L=A.message||"Login failed";d(L),u.error("Login Failed",{description:L})}}catch(A){const L=A.message||((b=(p=A.errors)==null?void 0:p.email)==null?void 0:b[0])||"Login failed. Please try again.";d(L),u.error("Login Failed",{description:L})}finally{o(!1)}},Ue=async m=>{var p,b;if(m.preventDefault(),d(""),w.length<6){d("Password must be at least 6 characters"),u.error("Validation Error",{description:"Password must be at least 6 characters"});return}o(!0);try{const A=await V.register({email:R,password:w,name:f,contact:x,role:g,place_name:g==="provider"?z:null,street:$,area:T,city:M,pincode:Y,latitude:Q,longitude:y});if(A.success)u.success("OTP Sent!",{description:"Please check your email for the verification code"}),ze("register"),me(["","","","","",""]),n("OTP");else{const L=A.message||"Registration failed";d(L),u.error("Registration Failed",{description:L})}}catch(A){const L=A.message||((b=(p=A.errors)==null?void 0:p.email)==null?void 0:b[0])||"Registration failed. Please try again.";d(L),u.error("Registration Failed",{description:L})}finally{o(!1)}},He=async m=>{if(m.preventDefault(),d(""),!E){d("Please enter your email"),u.error("Email Required",{description:"Please enter your registered email address"});return}o(!0);try{const p=await V.forgotPassword(E);if(p.success)u.success("OTP Sent!",{description:"Please check your email for the reset code"}),ze("forgot"),me(["","","","","",""]),n("OTP");else{const b=p.message||"Failed to send OTP";d(b),u.error("Failed",{description:b})}}catch(p){const b=p.message||"Failed to send OTP. Please try again.";d(b),u.error("Failed",{description:b})}finally{o(!1)}},Ve=async()=>{const m=ne.join("");if(!(m.length<6)){d(""),o(!0);try{if(ie==="register"){const p=await V.verifyRegistrationOtp(R,m);if(p.success)p.token&&Re.set("auth_token",p.token),u.success("Account Verified!",{description:"Welcome to Ramzania!"}),a(p.user);else{const b=p.message||"Invalid OTP";d(b),u.error("Verification Failed",{description:b})}}else if(ie==="forgot"){const p=await V.verifyForgotPasswordOtp(E,m);if(p.success)u.success("OTP Verified!",{description:"Now set your new password"}),_e(p.reset_token),n("RESET_PASSWORD");else{const b=p.message||"Invalid OTP";d(b),u.error("Verification Failed",{description:b})}}}catch(p){const b=p.message||"OTP verification failed. Please try again.";d(b),u.error("Verification Failed",{description:b})}finally{o(!1)}}},Ye=async m=>{if(m.preventDefault(),d(""),U.length<6){d("Password must be at least 6 characters"),u.error("Validation Error",{description:"Password must be at least 6 characters"});return}if(U!==ge){d("Passwords do not match"),u.error("Validation Error",{description:"Passwords do not match"});return}o(!0);try{const p=await V.resetPassword(E,Le,U,ge);if(p.success)u.success("Password Reset!",{description:"You can now login with your new password"}),n("LOGIN"),d(""),J(""),Se(""),Ce(""),_e("");else{const b=p.message||"Password reset failed";d(b),u.error("Reset Failed",{description:b})}}catch(p){const b=p.message||"Password reset failed. Please try again.";d(b),u.error("Reset Failed",{description:b})}finally{o(!1)}},Ke=async()=>{o(!0),d("");try{let m;if(ie==="register"?m=await V.resendRegistrationOtp(R):m=await V.forgotPassword(E),m.success)u.success("OTP Resent!",{description:"Please check your email for the new code"}),me(["","","","","",""]);else{const p=m.message||"Failed to resend OTP";d(p),u.error("Failed",{description:p})}}catch{const p="Failed to resend OTP. Please try again.";d(p),u.error("Failed",{description:p})}finally{o(!1)}},ce="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",H="w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",ee="flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 px-4 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",Je={CHOICE:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-black tracking-tight text-slate-900",children:"Join Ramzania"}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Your portal to community Sehar & Iftar."}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("button",{className:ee,onClick:()=>n("LOGIN"),children:"Sign In"}),e.jsx("button",{className:"flex w-full items-center justify-center gap-2 rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-[0.98]",onClick:()=>n("REGISTER"),children:"Create Account"})]})]}),LOGIN:e.jsxs("form",{onSubmit:Ge,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n("CHOICE"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ue,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Sign In"})]}),h&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:h}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"email",required:!0,placeholder:"Email address",className:ce,value:C,onChange:m=>k(m.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Password",className:ce,value:i,onChange:m=>j(m.target.value)})]}),e.jsx("button",{type:"submit",disabled:c,className:ee,children:c?e.jsx(B,{className:"animate-spin",size:18}):"Sign In"}),e.jsx("button",{type:"button",onClick:()=>n("FORGOT"),className:"w-full text-center text-[10px] font-bold tracking-wide text-slate-400 uppercase hover:text-emerald-600",children:"Forgot Password?"})]}),REGISTER:e.jsxs("form",{onSubmit:Ue,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n("CHOICE"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ue,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Create Account"})]}),h&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:h}),e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{type:"button",onClick:()=>S("seeker"),className:`flex-1 rounded-lg py-2.5 text-xs font-bold transition-all ${g==="seeker"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"ðŸ½ï¸ Guest"}),e.jsx("button",{type:"button",onClick:()=>S("provider"),className:`flex-1 rounded-lg py-2.5 text-xs font-bold transition-all ${g==="provider"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"ðŸ  Host"})]}),e.jsx("p",{className:"text-[10px] font-medium text-slate-400",children:g==="seeker"?"Find & reserve Sehri near you":"Arrange Sehri for guests in your area"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"email",required:!0,placeholder:"Email address",className:H,value:R,onChange:m=>N(m.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Password (min 6 chars)",className:H,value:w,onChange:m=>F(m.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Full Name",className:H,value:f,onChange:m=>D(m.target.value)}),e.jsx("input",{type:"tel",required:!0,placeholder:"Contact Number",className:H,value:x,onChange:m=>_(m.target.value)})]}),g==="provider"&&e.jsx("input",{type:"text",required:!0,placeholder:"Place Name (e.g., Restaurant, Masjid,..)",className:H,value:z,onChange:m=>I(m.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500",children:"Address Details"}),t&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(B,{size:10,className:"animate-spin"}),"Fetching location..."]}),!t&&M&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(re,{size:10}),"Auto-filled"]})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Street / Door No",className:H,value:$,onChange:m=>P(m.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Area / Locality",className:H,value:T,onChange:m=>O(m.target.value)}),e.jsx("input",{type:"text",required:!0,placeholder:"City",className:H,value:M,onChange:m=>Z(m.target.value)})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Pincode",className:H,value:Y,onChange:m=>K(m.target.value)})]}),e.jsx("button",{type:"submit",disabled:c,className:ee,children:c?e.jsx(B,{className:"animate-spin",size:18}):"Continue â†’"})]}),FORGOT:e.jsxs("form",{onSubmit:He,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n("LOGIN"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ue,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Reset Password"})]}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Enter your email to receive a verification code."}),h&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:h}),e.jsx("input",{type:"email",required:!0,placeholder:"Registered email",className:ce,value:E,onChange:m=>J(m.target.value)}),e.jsx("button",{type:"submit",disabled:c,className:ee,children:c?e.jsx(B,{className:"animate-spin",size:18}):"Send OTP"})]}),OTP:e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n(ie==="register"?"REGISTER":"FORGOT"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ue,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Verify Email"})]}),e.jsxs("p",{className:"text-sm font-medium text-slate-500",children:["Enter the 6-digit code sent to ",e.jsx("span",{className:"font-bold text-slate-700",children:ie==="register"?R:E})]}),h&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:h}),e.jsx("div",{className:"flex justify-between gap-2",children:ne.map((m,p)=>e.jsx("input",{ref:b=>be.current[p]=b,type:"text",inputMode:"numeric",maxLength:1,className:"h-12 w-full rounded-xl border border-slate-200 bg-slate-50 text-center text-lg font-bold transition-all outline-none focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",value:m,onChange:b=>Be(b,p),onKeyDown:b=>qe(b,p)},p))}),e.jsx("button",{type:"button",onClick:Ve,disabled:c||ne.join("").length<6,className:ee,children:c?e.jsx(B,{className:"animate-spin",size:18}):"Verify"}),e.jsx("button",{type:"button",onClick:Ke,disabled:c,className:"w-full text-center text-[10px] font-bold tracking-wide text-slate-400 uppercase hover:text-emerald-600",children:"Resend Code"})]}),RESET_PASSWORD:e.jsxs("form",{onSubmit:Ye,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ls,{size:20,className:"text-emerald-600"}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"New Password"})]}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Create a new password for your account."}),h&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:h}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"password",required:!0,placeholder:"New Password (min 6 chars)",className:ce,value:U,onChange:m=>Se(m.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Confirm Password",className:ce,value:ge,onChange:m=>Ce(m.target.value)})]}),e.jsx("button",{type:"submit",disabled:c,className:ee,children:c?e.jsx(B,{className:"animate-spin",size:18}):"Reset Password"})]})};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-slate-900/40 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-4 w-full max-w-md rounded-2xl border border-slate-100 bg-white p-6 shadow-xl sm:rounded-3xl sm:p-8",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-emerald-50 text-emerald-600",children:e.jsx(ye,{size:20})}),e.jsx("button",{onClick:s,className:"rounded-full p-2 text-slate-300 transition-all hover:bg-slate-100 hover:text-slate-500",children:e.jsx(W,{size:18})})]}),Je[l]]})})}const xe=s=>new Promise(a=>setTimeout(a,s)),zs=async(s={})=>{try{const a=new URLSearchParams;s.area&&a.append("area",s.area),s.place&&a.append("place",s.place);const l=a.toString(),n=`/home/offerings${l?`?${l}`:""}`,c=await q.get(n,{auth:!1});return c.success?{providers:c.providers||[],filters:c.filters||{},current_ramzan_day:c.current_ramzan_day,ramzan_start_date:c.ramzan_start_date}:{providers:Fe(),filters:{}}}catch(a){return console.error("Failed to fetch providers from API, using mock data:",a),{providers:Fe(),filters:{}}}},As=async(s=null,a=null)=>{try{const l=new URLSearchParams;s&&l.append("day",s),a&&l.append("date",a);const n=l.toString(),c=n?`/home/timings?${n}`:"/home/timings",o=await q.get(c,{auth:!1});return o.success?o:{success:!1,timing:null}}catch(l){return console.error("Failed to fetch Ramzan timings:",l),{success:!1,timing:null}}},Rs=async()=>{try{const s=await q.get("/home/timings/all",{auth:!1});return s.success?s.timings||[]:[]}catch(s){return console.error("Failed to fetch all Ramzan timings:",s),[]}},Fs=async(s,a={})=>{try{const l=new URLSearchParams;a.lat&&l.append("lat",a.lat),a.lng&&l.append("lng",a.lng);const n=l.toString(),c=`/home/provider/${s}/offerings${n?`?${n}`:""}`,o=await q.get(c,{auth:!1});return o.success?o:{success:!1,offerings:[]}}catch(l){return console.error("Failed to fetch provider offerings:",l),{success:!1,offerings:[]}}},Os=async(s,a)=>q.post("/bookings",{offering_id:s,quantity:a}),Ds=async()=>q.get("/bookings/my"),Es=async s=>q.post(`/bookings/${s}/cancel`),Is=async(s="all")=>{const a=s==="all"?"/bookings/provider":`/bookings/provider?status=${s}`;return q.get(a)},Ps=async(s,a)=>q.put(`/bookings/${s}/status`,{status:a}),Fe=()=>[],Ts=async()=>(await xe(200),[{id:1,title:"Dua for Suhoor (Intention for Fasting)",arabic:"ÙˆÙŽØ¨ÙØµÙŽÙˆÙ’Ù…Ù ØºÙŽØ¯Ù Ù†ÙŽÙˆÙŽÙŠÙ’ØªÙ Ù…ÙÙ†Ù’ Ø´ÙŽÙ‡Ù’Ø±Ù Ø±ÙŽÙ…ÙŽØ¶ÙŽØ§Ù†ÙŽ",transliteration:"Wa bisawmi ghadin nawaitu min shahri Ramadan",english:"I intend to fast tomorrow for the month of Ramadan."},{id:2,title:"Dua for Iftar (Breaking Fast)",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ Ø¥ÙÙ†ÙÙ‘ÙŠ Ù„ÙŽÙƒÙŽ ØµÙÙ…Ù’ØªÙ ÙˆÙŽØ¨ÙÙƒÙŽ Ø¢Ù…ÙŽÙ†Ù’ØªÙ ÙˆÙŽØ¹ÙŽÙ„ÙŽÙŠÙ’ÙƒÙŽ ØªÙŽÙˆÙŽÙƒÙŽÙ‘Ù„Ù’ØªÙ ÙˆÙŽØ¹ÙŽÙ„ÙŽÙ‰ Ø±ÙØ²Ù’Ù‚ÙÙƒÙŽ Ø£ÙŽÙÙ’Ø·ÙŽØ±Ù’ØªÙ",transliteration:"Allahumma inni laka sumtu wa bika aamantu wa â€˜alayka tawakkaltu wa â€˜ala rizqika aftartu",english:"O Allah, I fasted for You, I believe in You, I trust in You, and I break my fast with Your provision."},{id:3,title:"Dua After Breaking Fast (Authentic)",arabic:"Ø°ÙŽÙ‡ÙŽØ¨ÙŽ Ø§Ù„Ø¸ÙŽÙ‘Ù…ÙŽØ£Ù ÙˆÙŽØ§Ø¨Ù’ØªÙŽÙ„ÙŽÙ‘ØªÙ Ø§Ù„Ù’Ø¹ÙØ±ÙÙˆÙ‚Ù ÙˆÙŽØ«ÙŽØ¨ÙŽØªÙŽ Ø§Ù„Ù’Ø£ÙŽØ¬Ù’Ø±Ù Ø¥ÙÙ†Ù’ Ø´ÙŽØ§Ø¡ÙŽ Ø§Ù„Ù„ÙŽÙ‘Ù‡Ù",transliteration:"Dhahaba adh-dhamaâ€™u wabtallatil â€˜urooq wa thabatal ajru in sha Allah",english:"The thirst is gone, the veins are moistened, and the reward is confirmed, if Allah wills."},{id:4,title:"Dua for Laylatul Qadr",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ Ø¥ÙÙ†ÙŽÙ‘ÙƒÙŽ Ø¹ÙŽÙÙÙˆÙŒÙ‘ ØªÙØ­ÙØ¨ÙÙ‘ Ø§Ù„Ù’Ø¹ÙŽÙÙ’ÙˆÙŽ ÙÙŽØ§Ø¹Ù’ÙÙ Ø¹ÙŽÙ†ÙÙ‘ÙŠ",transliteration:"Allahumma innaka afuwwun tuhibbul afwa faâ€™fu anni",english:"O Allah, You are Most Forgiving, and You love forgiveness; so forgive me."},{id:5,title:"Dua for Forgiveness",arabic:"Ø£ÙŽØ³Ù’ØªÙŽØºÙ’ÙÙØ±Ù Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙŽ",transliteration:"Astaghfirullah",english:"I seek forgiveness from Allah."},{id:6,title:"Dua for Mercy",arabic:"Ø±ÙŽØ¨ÙÙ‘ Ø§ØºÙ’ÙÙØ±Ù’ ÙˆÙŽØ§Ø±Ù’Ø­ÙŽÙ…Ù’ ÙˆÙŽØ£ÙŽÙ†Ù’ØªÙŽ Ø®ÙŽÙŠÙ’Ø±Ù Ø§Ù„Ø±ÙŽÙ‘Ø§Ø­ÙÙ…ÙÙŠÙ†ÙŽ",transliteration:"Rabbighfir warham wa anta khayrur rahimeen",english:"My Lord, forgive and have mercy, for You are the Best of the merciful."},{id:7,title:"Dua for Guidance",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ Ø§Ù‡Ù’Ø¯ÙÙ†ÙÙŠ ÙˆÙŽØ³ÙŽØ¯ÙÙ‘Ø¯Ù’Ù†ÙÙŠ",transliteration:"Allahumma ihdini wa saddidni",english:"O Allah, guide me and keep me steadfast."},{id:8,title:"Dua for Acceptance of Fasting",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ ØªÙŽÙ‚ÙŽØ¨ÙŽÙ‘Ù„Ù’ Ù…ÙÙ†ÙŽÙ‘Ø§ Ø¥ÙÙ†ÙŽÙ‘ÙƒÙŽ Ø£ÙŽÙ†Ù’ØªÙŽ Ø§Ù„Ø³ÙŽÙ‘Ù…ÙÙŠØ¹Ù Ø§Ù„Ù’Ø¹ÙŽÙ„ÙÙŠÙ…Ù",transliteration:"Allahumma taqabbal Ù…Ù†Ø§ innaka antas-sameeâ€™ul aleem",english:"O Allah, accept from us. Indeed, You are the All-Hearing, All-Knowing."}]),$s=async()=>(await xe(200),[]),Ms=async(s="Chennai")=>(await xe(100),{sehar:"4:52 AM",iftar:"6:24 PM",area:s}),Ls=async(s,a)=>(await xe(1e3),{success:!0,user:{email:s,role:s.includes("admin")?"admin":"seeker",name:s.split("@")[0],token:"token-"+Date.now()}}),Bs=async(s,a)=>(await xe(500),{success:!0,bookingId:`BK-${Date.now()}`,message:"Spot booked successfully!"}),se={fetchPoints:zs,fetchDuas:Ts,fetchEvents:$s,fetchTimings:Ms,fetchRamzanTimings:As,fetchAllRamzanTimings:Rs,login:Ls,bookSpot:Bs};function qs({point:s,user:a,userLocation:l,onClose:n,onSuccess:c,onLoginClick:o}){const[h,d]=r.useState(!0),[C,k]=r.useState([]),[i,j]=r.useState(null),[g,S]=r.useState(null),[R,N]=r.useState(1),[w,F]=r.useState(!1);r.useEffect(()=>{(async()=>{d(!0);const _=s.provider_id||s.id,z={};l!=null&&l.lat&&(l!=null&&l.lng)&&(z.lat=l.lat,z.lng=l.lng);const I=await Fs(_,z);I.success&&(j(I.provider),k(I.offerings||[])),d(!1)})()},[s,l]);const f=x=>{const _=["th","st","nd","rd"],z=x%100;return x+(_[(z-20)%10]||_[z]||_[0])},D=async()=>{if(!g){u.error("Please select a date");return}F(!0);try{const x=await Os(g.id,R);x.success?(u.success("Spot Booked!",{description:`Booking code: ${x.booking.booking_code}`}),c==null||c(`Spot booked for ${f(g.ramzan_day)} Ramzan!`)):u.error("Booking Failed",{description:x.message})}catch(x){x.status===401?(u.error("Please login to book"),o==null||o()):u.error("Booking Failed",{description:x.message})}finally{F(!1)}};return a?e.jsx("div",{className:"fixed inset-0 z-100 flex items-end justify-center bg-slate-900/30 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-10 max-h-[90vh] w-full max-w-md overflow-hidden rounded-3xl border border-slate-100 bg-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 p-4",children:[e.jsx("h2",{className:"text-lg font-black text-slate-900",children:"Reserve Sehri"}),e.jsx("button",{onClick:n,className:"rounded-full p-2 text-slate-400 hover:bg-slate-100",children:e.jsx(W,{size:18})})]}),e.jsxs("div",{className:"bg-emerald-50 px-4 py-3",children:[e.jsx("p",{className:"font-black text-emerald-800",children:(i==null?void 0:i.name)||s.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-emerald-600",children:[e.jsx("span",{children:(i==null?void 0:i.area)||s.area}),(i==null?void 0:i.distance)!==null&&(i==null?void 0:i.distance)!==void 0&&e.jsxs("span",{className:"flex items-center gap-0.5 rounded bg-emerald-100 px-1.5 py-0.5 text-emerald-700",children:[e.jsx(re,{size:10})," ",i.distance," km"]})]})]}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto p-4",children:h?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(B,{size:24,className:"animate-spin text-emerald-600"})}):C.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(fe,{size:32,className:"mx-auto mb-2 text-slate-300"}),e.jsx("p",{className:"text-sm text-slate-500",children:"No available dates"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"mb-3 text-xs font-bold text-slate-500",children:"Select a date:"}),C.map(x=>e.jsxs("button",{disabled:!x.is_bookable,onClick:()=>S(x),className:`w-full rounded-xl border p-3 text-left transition-all ${(g==null?void 0:g.id)===x.id?"border-emerald-500 bg-emerald-50 ring-2 ring-emerald-200":x.is_bookable?"border-slate-200 bg-white hover:border-emerald-300 hover:bg-emerald-50/50":"cursor-not-allowed border-slate-100 bg-slate-50 opacity-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 text-xs font-black text-emerald-700",children:f(x.ramzan_day)}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold text-slate-800",children:[x.formatted_date,e.jsxs("span",{className:"ml-1 text-[10px] font-normal text-slate-400",children:["(",x.day_name,")"]})]}),e.jsx("p",{className:"text-[10px] text-slate-500",children:x.meal_type})]})]}),e.jsxs("div",{className:"text-right",children:[(g==null?void 0:g.id)===x.id&&e.jsx(Pe,{size:16,className:"text-emerald-600"}),!g||g.id!==x.id?e.jsx("span",{className:`text-xs font-bold ${x.is_bookable?"text-emerald-600":"text-red-500"}`,children:x.is_bookable?`${x.available_slots} spots`:"Full"}):null]})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-1.5 text-[10px] text-slate-500",children:[x.timing&&e.jsxs("span",{className:"flex items-center gap-0.5 rounded bg-slate-100 px-1.5 py-0.5",children:[e.jsx(le,{size:10})," ",x.timing]}),x.delivery_available&&e.jsxs("span",{className:"flex items-center gap-0.5 rounded bg-emerald-100 px-1.5 py-0.5 text-emerald-600",children:[e.jsx(ke,{size:10})," Delivery"]}),e.jsx("span",{className:`rounded px-1.5 py-0.5 ${x.price_type==="free"?"bg-emerald-100 text-emerald-600":"bg-amber-100 text-amber-600"}`,children:x.price_type==="free"?"Free":`â‚¹${x.price_amount}`})]}),e.jsxs("p",{className:"mt-2 text-[10px] text-slate-400 italic",children:['"',x.menu_items,'"']})]},x.id))]})}),g&&e.jsxs("div",{className:"border-t border-slate-100 bg-slate-50 p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between rounded-xl bg-white p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{size:16,className:"text-slate-400"}),e.jsx("span",{className:"text-sm font-bold text-slate-700",children:"No. of Persons"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>N(x=>Math.max(1,x-1)),className:"rounded-lg bg-slate-100 p-1.5 text-slate-600 hover:bg-slate-200",children:e.jsx(rs,{size:14})}),e.jsx("span",{className:"w-6 text-center text-sm font-black text-slate-900",children:R}),e.jsx("button",{type:"button",onClick:()=>N(x=>Math.min(g.available_slots,Math.min(10,x+1))),className:"rounded-lg bg-slate-100 p-1.5 text-slate-600 hover:bg-slate-200",children:e.jsx(Te,{size:14})})]})]}),e.jsxs("div",{className:"mb-4 flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-slate-500",children:[f(g.ramzan_day)," Ramzan â€¢ ",g.meal_type]}),e.jsx("span",{className:"font-bold text-slate-900",children:g.price_type==="free"?"Free":`â‚¹${(g.price_amount||0)*R}`})]}),e.jsx("button",{onClick:D,disabled:w,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",children:w?e.jsxs(e.Fragment,{children:[e.jsx(B,{size:16,className:"animate-spin"}),"Booking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{size:16}),"Confirm Booking"]})})]})]})}):e.jsx("div",{className:"fixed inset-0 z-100 flex items-end justify-center bg-slate-900/30 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-10 w-full max-w-md rounded-3xl border border-slate-100 bg-white p-6 shadow-lg",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Book Spot"}),e.jsx("button",{onClick:n,className:"rounded-full p-2 text-slate-400 hover:bg-slate-100",children:e.jsx(W,{size:18})})]}),e.jsxs("div",{className:"mb-6 rounded-xl bg-emerald-50 p-4",children:[e.jsx("p",{className:"font-black text-emerald-800",children:s.name}),e.jsx("p",{className:"text-xs text-emerald-600",children:s.area})]}),e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:[e.jsx(ye,{size:32,className:"mx-auto mb-3 text-slate-400"}),e.jsx("p",{className:"font-bold text-slate-700",children:"Login Required"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Please login or register to reserve Sehri"}),e.jsx("button",{onClick:()=>{n(),o==null||o()},className:"mt-4 rounded-xl bg-emerald-600 px-6 py-2.5 text-sm font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:"Login / Register"})]})]})})}function Gs({timings:s,ramzanTiming:a,points:l,onBook:n,availableAreas:c=[],onFilterChange:o,loading:h}){const[d,C]=r.useState(""),[k,i]=r.useState(""),[j,g]=r.useState(!1),S=()=>{const f=new Date,D=new Date("2026-02-19"),x=new Date("2026-03-20");return f>=D&&f<=x},R=l.filter(f=>f.name.toLowerCase().includes(d.toLowerCase())||f.menu.toLowerCase().includes(d.toLowerCase())),N=f=>{i(f),o&&o({area:f})},w=()=>{i(""),C(""),o&&o({})},F=f=>{if(!f)return"--:--";const[D,x]=f.split(":"),_=parseInt(D),z=_>=12?"PM":"AM";return`${_%12||12}:${x} ${z}`};return e.jsxs("div",{className:"space-y-6",children:[a&&S()&&e.jsxs("section",{className:"rounded-2xl bg-gradient-to-br from-emerald-50 to-teal-50 p-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{size:16,className:"text-emerald-600"}),e.jsxs("h2",{className:"text-sm font-black tracking-tight text-slate-900",children:["Day ",a.ramzan_day," - Prayer Times"]})]}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:new Date(a.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"rounded-xl bg-white/80 p-3 text-center shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:"Sehri Ends"}),e.jsx("p",{className:"text-lg font-black text-emerald-700",children:F(a.sehar_time)})]}),e.jsxs("div",{className:"rounded-xl bg-white/80 p-3 text-center shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:"Iftar"}),e.jsx("p",{className:"text-lg font-black text-orange-600",children:F(a.iftar_time)})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2 sm:grid-cols-6",children:[{name:"Fajr",time:a.fajr},{name:"Zohar",time:a.zohar},{name:"Asar",time:a.asar},{name:"Magrib",time:a.magrib},{name:"Isha",time:a.isha},{name:"Taraweeh",time:a.taraweeh}].map(f=>e.jsxs("div",{className:"rounded-lg bg-white/60 px-2 py-1.5 text-center",children:[e.jsx("p",{className:"text-[10px] font-medium text-slate-500",children:f.name}),e.jsx("p",{className:"text-xs font-bold text-slate-700",children:F(f.time)})]},f.name))})]}),!a&&S()&&e.jsxs("section",{children:[e.jsx("h2",{className:"mb-3 text-sm font-black tracking-tight text-slate-900",children:"Today's Timings"}),e.jsx(vs,{timings:s,compact:!0})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ns,{size:16,className:"text-emerald-600"}),e.jsx("h2",{className:"text-sm font-black tracking-tight text-slate-900",children:"Sehri Hosts"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"rounded-lg bg-slate-100 px-2 py-0.5 text-xs font-bold text-slate-600",children:h?"...":`${R.length} nearby`}),e.jsxs("button",{onClick:()=>g(!j),className:`flex items-center gap-1 rounded-lg px-2 py-0.5 text-xs font-bold transition-colors ${j||k?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600"}`,children:[e.jsx(is,{size:12}),"Filter"]})]})]}),j&&e.jsxs("div",{className:"mb-4 rounded-xl border border-slate-200 bg-slate-50 p-3",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-bold text-slate-700",children:"Filter by Area"}),k&&e.jsxs("button",{onClick:w,className:"flex items-center gap-1 text-xs text-slate-500 hover:text-slate-700",children:[e.jsx(W,{size:12})," Clear"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.length>0?c.map(f=>e.jsxs("button",{onClick:()=>N(f===k?"":f),className:`flex items-center gap-1 rounded-full px-3 py-1 text-xs font-medium transition-colors ${k===f?"bg-emerald-600 text-white":"bg-white text-slate-600 hover:bg-emerald-50"}`,children:[e.jsx(re,{size:10}),f]},f)):e.jsx("p",{className:"text-xs text-slate-400",children:"No areas available"})})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(cs,{size:16,className:"absolute top-1/2 left-3 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search hosts...",value:d,onChange:f=>C(f.target.value),className:"w-full rounded-xl border border-slate-200 bg-white py-2.5 pr-4 pl-9 text-sm font-medium text-slate-900 placeholder:text-slate-400 focus:border-emerald-300 focus:ring-2 focus:ring-emerald-100 focus:outline-none"})]}),h?e.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:e.jsx("div",{className:"animate-pulse",children:e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Loading hosts..."})})}):R.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:R.map(f=>e.jsx(ws,{point:f,onBook:n,compact:!0},f.id))}):e.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"No Sehri hosts found"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Try a different search term or clear filters"})]})]})]})}const te={LIST:"/offerings",CREATE:"/offerings",BULK_CREATE:"/offerings/bulk",UPDATE:s=>`/offerings/${s}`,DELETE:s=>`/offerings/${s}`,STATS:"/offerings/stats"},ae={getAll:async()=>q.get(te.LIST),create:async s=>q.post(te.CREATE,s),bulkCreate:async s=>q.post(te.BULK_CREATE,{offerings:s}),update:async(s,a)=>q.put(te.UPDATE(s),a),delete:async s=>q.delete(te.DELETE(s)),getStats:async()=>q.get(te.STATS)},pe=30,Us=new Date("2026-02-19"),Hs=()=>Array.from({length:pe},(s,a)=>{const l=a+1,n=new Date(Us);return n.setDate(n.getDate()+a),{day:l,date:n,dateStr:n.toLocaleDateString("en-IN",{day:"numeric",month:"short"}),fullDate:n.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})}}),Ne=Hs();function Vs({onClose:s,onSave:a,editingPoint:l,loading:n}){var Y,K,Q,X;const[c,o]=r.useState("single"),[h,d]=r.useState(l?[l.ramzan_day]:[1]),[C]=r.useState("sehar"),[k,i]=r.useState((l==null?void 0:l.menu_items)||""),[j,g]=r.useState(((Y=l==null?void 0:l.capacity)==null?void 0:Y.toString())||"50"),[S,R]=r.useState((l==null?void 0:l.price_type)||"free"),[N,w]=r.useState(((K=l==null?void 0:l.price_amount)==null?void 0:K.toString())||""),[F,f]=r.useState((l==null?void 0:l.delivery_available)||!1),[D,x]=r.useState(((Q=l==null?void 0:l.timing_from)==null?void 0:Q.slice(0,5))||"04:00"),[_,z]=r.useState(((X=l==null?void 0:l.timing_to)==null?void 0:X.slice(0,5))||"05:30"),[I,$]=r.useState((l==null?void 0:l.message)||""),P="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",T="w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",O=y=>{d(c==="single"?[y]:G=>G.includes(y)?G.filter(t=>t!==y):[...G,y])},M=()=>{h.length===pe?d([]):d(Array.from({length:pe},(y,G)=>G+1))},Z=y=>{if(y.preventDefault(),h.length===0){u.error("Please select at least one day");return}if(!k.trim()){u.error("Please enter menu items");return}const G={meal_type:C,menu_items:k.trim(),capacity:Number.parseInt(j)||50,price_type:S,price_amount:S==="paid"?Number.parseFloat(N)||0:null,delivery_available:F,timing_from:D,timing_to:_,message:I.trim()||null};if(l)a({...G,id:l.id});else if(c==="single")a({...G,ramzan_day:h[0]});else{const t=h.map(v=>({...G,ramzan_day:v}));a({bulk:!0,offerings:t})}};return e.jsx("div",{className:"fixed inset-0 z-100 flex items-start justify-center overflow-y-auto bg-slate-900/40 px-4 pt-4 pb-24 backdrop-blur-sm sm:items-center sm:pb-4",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-4 sm:slide-in-from-bottom-0 sm:zoom-in-95 w-full max-w-lg rounded-2xl bg-white p-6 shadow-xl sm:my-auto",children:[e.jsxs("div",{className:"mb-5 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-black text-slate-900",children:[l?"Edit":"Add"," Sehar Offering"]}),e.jsx("button",{onClick:s,className:"rounded-full p-1.5 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(W,{size:18})})]}),e.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[!l&&e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{type:"button",onClick:()=>{o("single"),d([1])},className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${c==="single"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Single Day"}),e.jsx("button",{type:"button",onClick:()=>o("bulk"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${c==="bulk"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Multiple Days"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsxs("label",{className:"block text-xs font-bold text-slate-500",children:[e.jsx(de,{size:12,className:"mr-1 inline"}),c==="single"?"Select Ramzan Day":"Select Days"]}),c==="bulk"&&!l&&e.jsx("button",{type:"button",onClick:M,className:"text-[10px] font-bold text-emerald-600 hover:underline",children:h.length===pe?"Deselect All":"Select All"})]}),c==="single"||l?e.jsx("select",{value:h[0],onChange:y=>d([Number.parseInt(y.target.value)]),className:P,disabled:!!l,children:Ne.map(y=>e.jsxs("option",{value:y.day,children:["Day ",y.day," - ",y.fullDate]},y.day))}):e.jsx("div",{className:"grid max-h-32 grid-cols-5 gap-1.5 overflow-y-auto rounded-xl border border-slate-200 bg-slate-50 p-2",children:Ne.map(y=>e.jsx("button",{type:"button",onClick:()=>O(y.day),className:`rounded-lg px-2 py-1.5 text-[10px] font-bold transition-all ${h.includes(y.day)?"bg-emerald-600 text-white":"bg-white text-slate-600 hover:bg-emerald-50"}`,children:y.day},y.day))}),c==="bulk"&&h.length>0&&e.jsxs("p",{className:"mt-1 text-[10px] text-emerald-600",children:[h.length," days selected"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(fe,{size:12,className:"mr-1 inline"}),"Meal Type"]}),e.jsx("div",{className:"rounded-xl border border-slate-200 bg-emerald-50 px-4 py-3 text-sm font-bold text-emerald-700",children:"Sehar (Pre-dawn meal)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Menu Items *"}),e.jsx("textarea",{required:!0,placeholder:"e.g., Biryani, Kheer, Dates, Rooh Afza, Chai...",className:P+" resize-none",rows:2,value:k,onChange:y=>i(y.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(oe,{size:12,className:"mr-1 inline"}),"Capacity *"]}),e.jsx("input",{type:"number",required:!0,min:"1",max:"10000",placeholder:"No. of people",className:T,value:j,onChange:y=>g(y.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(us,{size:12,className:"mr-1 inline"}),"Price Type"]}),e.jsxs("select",{value:S,onChange:y=>R(y.target.value),className:T,children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"paid",children:"Paid"})]})]})]}),S==="paid"&&e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Amount per person (â‚¹)"}),e.jsx("input",{type:"number",required:!0,min:"1",placeholder:"Enter amount",className:T,value:N,onChange:y=>w(y.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(le,{size:12,className:"mr-1 inline"}),"Service Timings"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"time",className:T,value:D,onChange:y=>x(y.target.value)}),e.jsx("input",{type:"time",className:T,value:_,onChange:y=>z(y.target.value)})]}),e.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"From - To (e.g., 4:00 AM - 5:30 AM)"})]}),e.jsxs("div",{className:"flex items-center gap-3 rounded-xl border border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("input",{type:"checkbox",id:"delivery",checked:F,onChange:y=>f(y.target.checked),className:"h-4 w-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-500"}),e.jsxs("label",{htmlFor:"delivery",className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[e.jsx(ke,{size:16,className:"text-slate-400"}),"Delivery Available"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(hs,{size:12,className:"mr-1 inline"}),"Additional Message (Optional)"]}),e.jsx("textarea",{placeholder:"Any special instructions or notes...",className:P+" resize-none",rows:2,value:I,onChange:y=>$(y.target.value)})]}),e.jsx("button",{type:"submit",disabled:n,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",children:n?e.jsxs(e.Fragment,{children:[e.jsx(B,{size:16,className:"animate-spin"}),"Saving..."]}):l?"Update Offering":c==="bulk"?`Add ${h.length} Offering${h.length>1?"s":""}`:"Add Offering"})]})]})})}function Ys({user:s}){const[a,l]=r.useState("offerings"),[n,c]=r.useState(!1),[o,h]=r.useState(null),[d,C]=r.useState([]),[k,i]=r.useState([]),[j,g]=r.useState({total:0,confirmed:0,completed:0,cancelled:0,no_show:0}),[S,R]=r.useState("all"),[N,w]=r.useState(!1),[F,f]=r.useState(!1),[D,x]=r.useState(!1),[_,z]=r.useState(null),[I,$]=r.useState({total_offerings:0,total_capacity:0,total_booked:0});r.useEffect(()=>{P(),T(),O()},[]),r.useEffect(()=>{O()},[S]);const P=async()=>{w(!0);try{const t=await ae.getAll();t.success&&C(t.offerings||[])}catch{u.error("Failed to load offerings")}finally{w(!1)}},T=async()=>{try{const t=await ae.getStats();t.success&&$(t.stats)}catch(t){console.error("Failed to load stats",t)}},O=async()=>{f(!0);try{const t=await Is(S);t.success&&(i(t.bookings||[]),t.stats&&g(t.stats))}catch{u.error("Failed to load bookings")}finally{f(!1)}},M=async(t,v)=>{z(t);try{const E=await Ps(t,v);E.success?(u.success("Status updated"),i(J=>J.map(U=>U.id===t?{...U,status:v}:U)),await O(),await T()):u.error(E.message||"Failed to update status")}catch{u.error("Failed to update status")}finally{z(null)}},Z=I.total_offerings||d.length,Y=j.total||0,K=j.confirmed||0,Q=async t=>{x(!0);try{if(t.bulk){const v=await ae.bulkCreate(t.offerings);v.success?(u.success(`${v.created_count} offerings created successfully!`),await P(),await T(),c(!1)):u.error(v.message||"Failed to create offerings")}else if(t.id){const v=await ae.update(t.id,t);v.success?(u.success("Offering updated successfully"),await P(),await T(),c(!1)):u.error(v.message||"Failed to update offering")}else{const v=await ae.create(t);v.success?(u.success("Offering created successfully"),await P(),await T(),c(!1)):u.error(v.message||"Failed to create offering")}}catch(v){u.error(v.message||"An error occurred")}finally{x(!1),h(null)}},X=async t=>{if(window.confirm("Delete this food offering?"))try{const v=await ae.delete(t);v.success?(u.success("Offering deleted"),await P(),await T()):u.error(v.message||"Failed to delete")}catch{u.error("Failed to delete offering")}},y=t=>{switch(t){case"confirmed":return"bg-emerald-50 text-emerald-600";case"completed":return"bg-blue-50 text-blue-600";case"cancelled":return"bg-red-50 text-red-500";case"no_show":return"bg-amber-50 text-amber-600";default:return"bg-slate-100 text-slate-500"}},G=t=>{const v=["th","st","nd","rd"],E=t%100;return t+(v[(E-20)%10]||v[E]||v[0])};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-slate-900",children:"Host Dashboard"}),e.jsx("p",{className:"text-xs font-medium text-slate-500",children:(s==null?void 0:s.place_name)||"Manage your Sehri distribution"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"rounded-xl bg-emerald-50 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-emerald-600",children:Z}),e.jsx("p",{className:"text-[10px] font-bold text-emerald-700 uppercase",children:"Offerings"})]}),e.jsxs("div",{className:"rounded-xl bg-slate-100 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-slate-700",children:Y}),e.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:"Bookings"})]}),e.jsxs("div",{className:"rounded-xl bg-blue-50 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-blue-600",children:K}),e.jsx("p",{className:"text-[10px] font-bold text-blue-700 uppercase",children:"Confirmed"})]})]}),e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{onClick:()=>l("offerings"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${a==="offerings"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Food Offerings"}),e.jsx("button",{onClick:()=>l("bookings"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${a==="bookings"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Bookings"})]}),a==="offerings"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-bold text-slate-700",children:"My Offerings"}),e.jsxs("button",{onClick:()=>{h(null),c(!0)},className:"flex items-center gap-1.5 rounded-lg bg-emerald-600 px-3 py-2 text-xs font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:[e.jsx(Te,{size:14}),"Add Day"]})]}),N?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(B,{size:24,className:"animate-spin text-emerald-600"})}):e.jsx("div",{className:"space-y-3",children:d.length>0?d.sort((t,v)=>t.ramzan_day-v.ramzan_day).map(t=>{var E,J;const v=Ne.find(U=>U.day===t.ramzan_day);return e.jsxs("div",{className:"rounded-xl border border-slate-100 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 text-xs font-black text-emerald-700",children:[G(t.ramzan_day)," Ramzan"]}),e.jsx("span",{className:"text-[10px] text-slate-400",children:v==null?void 0:v.fullDate}),e.jsx("span",{className:"rounded bg-slate-100 px-1.5 py-0.5 text-[9px] font-bold text-slate-600 uppercase",children:t.meal_type})]}),e.jsx("span",{className:`rounded-lg px-2 py-0.5 text-[9px] font-black uppercase ${t.price_type==="free"?"bg-emerald-50 text-emerald-600":"bg-amber-50 text-amber-600"}`,children:t.price_type==="free"?"Free":`â‚¹${t.price_amount}`})]}),e.jsxs("p",{className:"mt-2 text-xs text-slate-600 italic",children:['"',t.menu_items,'"']}),t.message&&e.jsxs("p",{className:"mt-1 text-[10px] text-slate-400",children:["ðŸ’¬ ",t.message]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-3 text-[10px] text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(oe,{size:10}),t.booked_count||0,"/",t.capacity]}),e.jsx("span",{className:`${(t.booked_count||0)>=t.capacity?"text-red-500":"text-emerald-600"}`,children:(t.booked_count||0)>=t.capacity?"Full":`${t.capacity-(t.booked_count||0)} left`}),t.timing_from&&t.timing_to&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(le,{size:10}),(E=t.timing_from)==null?void 0:E.slice(0,5)," - ",(J=t.timing_to)==null?void 0:J.slice(0,5)]}),t.delivery_available&&e.jsxs("span",{className:"flex items-center gap-1 text-emerald-600",children:[e.jsx(ke,{size:10}),"Delivery"]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between border-t border-slate-50 pt-3",children:[e.jsx("span",{className:`rounded px-1.5 py-0.5 text-[9px] font-bold uppercase ${t.status==="active"?"bg-emerald-50 text-emerald-600":"bg-slate-100 text-slate-500"}`,children:t.status}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>{h(t),c(!0)},className:"rounded-lg p-1.5 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(os,{size:14})}),e.jsx("button",{onClick:()=>X(t.id),className:"rounded-lg p-1.5 text-slate-400 hover:bg-red-50 hover:text-red-500",children:e.jsx(ds,{size:14})})]})]})]},t.id)}):e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-12 text-center",children:[e.jsx(fe,{size:32,className:"mx-auto mb-3 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-500",children:"No offerings yet"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Add food offerings for specific Ramzan days"})]})})]}),a==="bookings"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-bold text-slate-700",children:"Manage Bookings"}),e.jsxs("button",{onClick:O,disabled:F,className:"flex items-center gap-1.5 rounded-lg bg-slate-100 px-3 py-2 text-xs font-bold text-slate-600 transition-all hover:bg-slate-200 active:scale-95 disabled:opacity-50",children:[e.jsx($e,{size:14,className:F?"animate-spin":""}),"Refresh"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"all",label:"All",count:j.total},{value:"confirmed",label:"Confirmed",count:j.confirmed},{value:"completed",label:"Completed",count:j.completed},{value:"cancelled",label:"Cancelled",count:j.cancelled},{value:"no_show",label:"No Show",count:j.no_show}].map(t=>e.jsxs("button",{onClick:()=>R(t.value),className:`rounded-lg px-3 py-1.5 text-[10px] font-bold transition-all ${S===t.value?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[t.label," (",t.count||0,")"]},t.value))}),F?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(B,{size:24,className:"animate-spin text-emerald-600"})}):e.jsx("div",{className:"space-y-3",children:k.length>0?k.map(t=>{var v,E;return e.jsxs("div",{className:`rounded-xl border bg-white p-4 transition-all ${t.status==="cancelled"||t.status==="no_show"?"border-slate-200 opacity-70":"border-slate-100"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900",children:t.seeker_name}),e.jsxs("div",{className:"mt-1 flex flex-col gap-1 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{size:12}),e.jsx("a",{href:`tel:${t.seeker_phone}`,className:"hover:text-emerald-600",children:t.seeker_phone})]}),t.seeker_email&&e.jsx("span",{className:"text-[10px] text-slate-400",children:t.seeker_email})]})]}),e.jsx("span",{className:`rounded-lg px-2 py-1 text-[10px] font-bold uppercase ${y(t.status)}`,children:t.status})]}),t.menu_items&&e.jsxs("p",{className:"mt-2 text-xs text-slate-500 italic",children:['"',t.menu_items,'"']}),e.jsxs("div",{className:"mt-3 rounded-lg bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 font-bold text-emerald-700",children:[G(t.ramzan_day)," Ramzan"]}),e.jsxs("span",{className:"flex items-center gap-1 text-slate-500",children:[e.jsx(de,{size:12}),t.formatted_date]}),e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5 text-[10px] font-bold text-slate-600 uppercase",children:t.meal_type})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs text-slate-600",children:[e.jsxs("span",{className:"flex items-center gap-1 font-bold",children:[e.jsx(oe,{size:12}),t.quantity," person(s)"]}),e.jsx("span",{className:"font-bold",children:t.total_amount>0?`â‚¹${t.total_amount}`:"Free"}),t.timing_from&&t.timing_to&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(le,{size:12}),(v=t.timing_from)==null?void 0:v.slice(0,5)," - ",(E=t.timing_to)==null?void 0:E.slice(0,5)]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsx("span",{className:"rounded bg-slate-100 px-2 py-1 font-mono text-[10px] text-slate-500",children:t.booking_code}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:["Booked: ",new Date(t.created_at).toLocaleDateString("en-IN")]})]}),t.status==="confirmed"&&e.jsxs("div",{className:"mt-4 flex gap-2 border-t border-slate-100 pt-4",children:[e.jsxs("button",{onClick:()=>M(t.id,"completed"),disabled:_===t.id,className:"flex flex-1 items-center justify-center gap-1.5 rounded-xl bg-emerald-600 py-2 text-xs font-bold text-white transition-all hover:bg-emerald-700 active:scale-95 disabled:opacity-50",children:[_===t.id?e.jsx(B,{size:14,className:"animate-spin"}):e.jsx(Me,{size:14}),"Mark Completed"]}),e.jsxs("button",{onClick:()=>M(t.id,"no_show"),disabled:_===t.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-amber-200 bg-amber-50 px-4 py-2 text-xs font-bold text-amber-600 transition-all hover:bg-amber-100 active:scale-95 disabled:opacity-50",children:[e.jsx(xs,{size:14}),"No Show"]}),e.jsxs("button",{onClick:()=>M(t.id,"cancelled"),disabled:_===t.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-xs font-bold text-red-600 transition-all hover:bg-red-100 active:scale-95 disabled:opacity-50",children:[e.jsx(ms,{size:14}),"Cancel"]})]}),(t.status==="cancelled"||t.status==="no_show")&&e.jsx("div",{className:"mt-3 border-t border-slate-100 pt-3",children:e.jsxs("button",{onClick:()=>M(t.id,"confirmed"),disabled:_===t.id,className:"flex items-center gap-1.5 text-xs font-bold text-emerald-600 hover:text-emerald-700",children:[_===t.id?e.jsx(B,{size:12,className:"animate-spin"}):e.jsx(Pe,{size:12}),"Restore Booking"]})})]},t.id)}):e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-12 text-center",children:[e.jsx(oe,{size:32,className:"mx-auto mb-3 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-500",children:S==="all"?"No bookings yet":`No ${S} bookings`}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Guest reservations will appear here"})]})})]}),n&&e.jsx(Vs,{onClose:()=>{c(!1),h(null)},onSave:Q,editingPoint:o,loading:D})]})}function Ks(){const[s,a]=r.useState([]),[l,n]=r.useState(!0),[c,o]=r.useState(null),h=i=>{const j=["th","st","nd","rd"],g=i%100;return i+(j[(g-20)%10]||j[g]||j[0])},d=async()=>{n(!0);try{const i=await Ds();i.success?a(i.bookings||[]):u.error(i.message||"Failed to load bookings")}catch{u.error("Failed to load bookings")}finally{n(!1)}};r.useEffect(()=>{d()},[]);const C=async i=>{if(globalThis.confirm("Are you sure you want to cancel this booking?")){o(i);try{const j=await Es(i);j.success?(u.success("Booking cancelled"),a(g=>g.map(S=>S.id===i?{...S,status:"cancelled"}:S))):u.error(j.message||"Failed to cancel")}catch{u.error("Failed to cancel booking")}finally{o(null)}}},k=i=>{switch(i){case"confirmed":return"bg-emerald-100 text-emerald-700";case"completed":return"bg-blue-100 text-blue-700";case"cancelled":return"bg-red-100 text-red-700";case"no_show":return"bg-amber-100 text-amber-700";default:return"bg-slate-100 text-slate-700"}};return l?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(B,{size:32,className:"animate-spin text-emerald-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-slate-900",children:"My Reservations"}),e.jsxs("p",{className:"text-xs text-slate-500",children:[s.length," Sehri reservation(s)"]})]}),e.jsx("button",{onClick:d,className:"rounded-lg bg-slate-100 p-2 text-slate-600 transition-all hover:bg-slate-200 active:scale-95",children:e.jsx($e,{size:16})})]}),s.length===0?e.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-16 text-center",children:[e.jsx(Ee,{size:48,className:"mx-auto mb-4 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-600",children:"No Sehri reservations yet"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Browse hosts & reserve your Sehri from Home"})]}):e.jsx("div",{className:"space-y-4",children:s.map(i=>e.jsxs("div",{className:`rounded-2xl border bg-white p-4 shadow-sm ${i.status==="cancelled"?"border-slate-200 opacity-60":"border-slate-100"}`,children:[e.jsxs("div",{className:"mb-3 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-black text-slate-900",children:i.provider_name}),e.jsxs("div",{className:"mt-1 flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(re,{size:12}),i.area]})]}),e.jsx("span",{className:`rounded-lg px-2 py-1 text-[10px] font-bold uppercase ${k(i.status)}`,children:i.status})]}),e.jsxs("div",{className:"rounded-xl bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 font-bold text-emerald-700",children:[h(i.ramzan_day)," Ramzan"]}),e.jsxs("span",{className:"flex items-center gap-1 text-slate-500",children:[e.jsx(de,{size:12}),i.formatted_date]}),e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5 text-[10px] font-bold text-slate-600",children:i.meal_type})]}),i.timing&&e.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-slate-500",children:[e.jsx(le,{size:12}),i.timing]}),e.jsxs("p",{className:"mt-2 text-xs text-slate-500 italic",children:['"',i.menu_items,'"']})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-600",children:[e.jsxs("span",{className:"font-bold",children:["ðŸ‘¥ ",i.quantity," person(s)"]}),e.jsx("span",{className:"font-bold",children:i.price_type==="free"||i.total_amount===0?"ðŸ†“ Free":`ðŸ’° â‚¹${i.total_amount}`})]}),e.jsx("span",{className:"rounded bg-slate-100 px-2 py-1 font-mono text-[10px] text-slate-500",children:i.booking_code})]}),i.status==="confirmed"&&e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs("a",{href:`tel:${i.provider_phone}`,className:"flex flex-1 items-center justify-center gap-1.5 rounded-xl border border-slate-200 bg-white py-2 text-xs font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-95",children:[e.jsx(we,{size:14})," Call Host"]}),e.jsxs("button",{onClick:()=>C(i.id),disabled:c===i.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-xs font-bold text-red-600 transition-all hover:bg-red-100 active:scale-95 disabled:opacity-50",children:[c===i.id?e.jsx(B,{size:14,className:"animate-spin"}):e.jsx(W,{size:14}),"Cancel"]})]}),e.jsxs("p",{className:"mt-3 text-[10px] text-slate-400",children:["Booked on ",i.booked_at]})]},i.id))})]})}function Js({duas:s}){return e.jsxs("div",{className:"space-y-12",children:[e.jsxs("h2",{className:"text-5xl font-black tracking-tighter text-slate-950 md:text-7xl",children:["Daily ",e.jsx("span",{className:"text-emerald-600",children:"Duas."})]}),e.jsx("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2",children:s.map(a=>e.jsx(ks,{dua:a},a.id))}),s.length===0&&e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-lg font-bold text-slate-400",children:"No duas available"})})]})}function Oe({events:s,onInterested:a}){return e.jsxs("div",{className:"space-y-12",children:[e.jsxs("h2",{className:"text-5xl font-black tracking-tighter text-slate-950 md:text-7xl",children:["Community ",e.jsx("span",{className:"text-emerald-600",children:"Events."})]}),e.jsx("div",{className:"space-y-4",children:s.map(l=>e.jsx(Ss,{event:l,onInterested:a},l.id))}),s.length===0&&e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("p",{className:"text-lg font-bold text-slate-400",children:"No events scheduled"}),e.jsx("p",{className:"text-sm text-slate-300",children:"Check back later for upcoming events"})]})]})}function Ws({message:s,onClose:a}){return s?e.jsxs("div",{className:"animate-in fade-in slide-in-from-top-10 fixed top-8 left-1/2 z-[200] flex -translate-x-1/2 items-center gap-3 rounded-full bg-slate-950 px-8 py-4 text-white shadow-2xl",children:[e.jsx(Me,{className:"text-emerald-400",size:18}),e.jsx("span",{className:"text-sm font-black tracking-tight",children:s}),e.jsx("button",{onClick:a,className:"text-slate-500 transition-colors hover:text-white",children:e.jsx(W,{size:16})})]}):null}const he="ramzania_user_location";async function Zs(s,a){try{const n=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${a}&zoom=14&addressdetails=1`,{headers:{"Accept-Language":"en"}})).json();if(n&&n.address){const{suburb:c,neighbourhood:o,city:h,town:d,village:C,state_district:k,state:i,country:j}=n.address;return{raw:n,area:c||o||h||d||C||k||""||"Unknown Area",fullAddress:n.display_name||"",city:h||d||C||k||"",state:i||"",country:j||"",addressDetails:n.address}}return null}catch(l){return console.error("Reverse geocoding failed:",l),null}}function Qs(){const[s,a]=r.useState(null),[l,n]=r.useState(null),[c,o]=r.useState(!1),[h,d]=r.useState(null),[C,k]=r.useState("prompt");r.useEffect(()=>{navigator.permissions&&navigator.permissions.query({name:"geolocation"}).then(N=>{k(N.state),N.onchange=()=>{k(N.state)}})},[]),r.useEffect(()=>{const N=localStorage.getItem(he);if(N)try{const w=JSON.parse(N);w.lat&&w.lng&&a({lat:w.lat,lng:w.lng}),w.address&&n(w.address)}catch{localStorage.removeItem(he)}},[]),r.useEffect(()=>{C==="granted"&&!s&&j()},[C]);const i=r.useCallback((N,w)=>{a(N),n(w),localStorage.setItem(he,JSON.stringify({lat:N.lat,lng:N.lng,address:w,timestamp:Date.now()}))},[]),j=r.useCallback(async()=>{if(!navigator.geolocation){d("Geolocation is not supported");return}o(!0),d(null),navigator.geolocation.getCurrentPosition(async N=>{const w={lat:N.coords.latitude,lng:N.coords.longitude},F=await Zs(w.lat,w.lng);i(w,F),o(!1)},N=>{N.code===N.PERMISSION_DENIED?(d("Location permission denied"),k("denied")):N.code===N.POSITION_UNAVAILABLE?d("Location unavailable"):N.code===N.TIMEOUT?d("Location request timed out"):d("Enable GPS to see distance"),o(!1)},{timeout:1e4,enableHighAccuracy:!0})},[i]),g=r.useCallback(()=>{j()},[j]),S=r.useCallback((N,w)=>{if(!s)return null;const F=6371,f=(N-s.lat)*Math.PI/180,D=(w-s.lng)*Math.PI/180,x=Math.sin(f/2)*Math.sin(f/2)+Math.cos(s.lat*Math.PI/180)*Math.cos(N*Math.PI/180)*Math.sin(D/2)*Math.sin(D/2),_=2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x));return F*_},[s]),R=r.useCallback(()=>{a(null),n(null),localStorage.removeItem(he)},[]);return{location:s,address:l,isLocating:c,error:h,permissionStatus:C,requestLocation:g,calculateDistance:S,clearLocation:R}}const Xs=()=>new Date().toISOString().split("T")[0];function et(){const[s,a]=r.useState([]),[l,n]=r.useState([]),[c,o]=r.useState([]),[h,d]=r.useState({sehar:"04:52 AM",iftar:"06:24 PM",area:"Chennai"}),[C,k]=r.useState(null),[i,j]=r.useState(!0),[g,S]=r.useState(null),[R,N]=r.useState([]),[w,F]=r.useState({area:"",place:""}),f=r.useRef(!1),D=r.useCallback(async(z={})=>{var I;try{const $=await se.fetchPoints(z);a($.providers||[]),N(((I=$.filters)==null?void 0:I.areas)||[])}catch($){console.error("Failed to fetch offerings:",$)}},[]),x=r.useCallback(async(z={})=>{var I;j(!0),S(null);try{const $=await se.fetchPoints(z);a($.providers||[]),N(((I=$.filters)==null?void 0:I.areas)||[]),j(!1),Promise.all([se.fetchDuas(),se.fetchEvents(),se.fetchTimings(),se.fetchRamzanTimings(null,Xs())]).then(([P,T,O,M])=>{n(P),o(T),d(O),M.success&&M.timing&&k(M.timing)}).catch(P=>{console.error("Failed to fetch secondary data:",P)})}catch($){S($.message||"Failed to fetch data"),j(!1)}},[]);r.useEffect(()=>{f.current||(f.current=!0,x())},[]);const _=r.useCallback(async z=>{F(z),await D(z)},[D]);return{points:s,duas:l,events:c,timings:h,ramzanTiming:C,loading:i,error:g,availableAreas:R,filters:w,refetch:()=>x(w),refetchWithFilters:_,setFilters:_}}const je="ramzania_user";function it(){const[s,a]=r.useState(null),[l,n]=r.useState(!1),[c,o]=r.useState("home"),[h,d]=r.useState(null),[C,k]=r.useState(null),{points:i,duas:j,events:g,timings:S,ramzanTiming:R,availableAreas:N,refetchWithFilters:w,loading:F}=et(),{location:f,address:D,isLocating:x,requestLocation:_}=Qs();r.useEffect(()=>{const O=localStorage.getItem(je);if(O){const M=JSON.parse(O);a(M),o(M.role==="provider"?"dashboard":"home")}},[]);const z=O=>{a(O),localStorage.setItem(je,JSON.stringify(O)),n(!1),o(O.role==="provider"?"dashboard":"home")},I=()=>{localStorage.removeItem(je),a(null),o("home")},$=O=>{k(O),d(null)},P=O=>{k(`Marked interest for ${O.title}`)},T=()=>{if((s==null?void 0:s.role)==="provider")switch(c){case"events":return e.jsx(Oe,{events:g,onInterested:P});case"settings":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-black text-slate-900",children:"Settings"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Host settings coming soon..."})]});case"dashboard":default:return e.jsx(Ys,{user:s})}switch(c){case"duas":return e.jsx(Js,{duas:j});case"events":return e.jsx(Oe,{events:g,onInterested:P});case"bookings":return e.jsx(Ks,{});case"home":default:return e.jsx(Gs,{timings:S,ramzanTiming:R,points:i,onBook:d,availableAreas:N,onFilterChange:w,loading:F})}};return e.jsxs("div",{className:"min-h-screen bg-white pb-20 font-sans text-slate-900 selection:bg-emerald-100 sm:pb-16",children:[e.jsx(ps,{user:s,onLogout:I,onJoinClick:()=>n(!0),address:D,isLocating:x,onRequestLocation:_}),e.jsx("main",{className:"mx-auto max-w-lg px-4 py-6 sm:max-w-2xl sm:px-6 sm:py-8",children:T()}),e.jsx(js,{activeView:c,onViewChange:o,userRole:s==null?void 0:s.role,user:s}),l&&e.jsx(_s,{onClose:()=>n(!1),onSuccess:z}),h&&e.jsx(qs,{point:h,user:s,userLocation:f,onClose:()=>d(null),onSuccess:$,onLoginClick:()=>{d(null),n(!0)}}),e.jsx(Ws,{message:C,onClose:()=>k(null)})]})}export{it as default};
