import{j as e}from"./vendor-ui-B2jkoGl9.js";import{h as Je,g as Ze,H as De,U as _e,T as Me,j as Ee,k as Ne,L as G,l as oe,f as Qe,m as Re,n as ue,o as ve,P as Ae,p as et,q as tt,r as st,s as be,X as ne,t as at,a as Le,u as me,v as pe,w as lt,x as $e,y as rt,S as nt,z as ot,R as Ie,B as it,D as ct,E as ze,G as dt,I as xt,J as mt}from"./vendor-other-JW_fR-Ym.js";import{a}from"./vendor-react-Cc-oBOCu.js";import{a as J,s as ke,t as h,b as U}from"./index-ByKmwzWg.js";import"./vendor-recharts-LMBWezzC.js";const ut=[{id:"home",label:"Home",icon:De},{id:"find",label:"Find",icon:_e},{id:"request",label:"Request",icon:Ee},{id:"join",label:"Join",icon:Ne}],ht=[{id:"home",label:"Home",icon:De},{id:"find",label:"Find",icon:_e},{id:"bookings",label:"Reserved",icon:Me},{id:"request",label:"Request",icon:Ee}],pt=[{id:"dashboard",label:"Dashboard",icon:Je},{id:"settings",label:"Settings",icon:Ze}];function ft({activeView:t,onViewChange:l,userRole:s="seeker",user:o=null}){let d;return s==="provider"?d=pt:o?d=ht:d=ut,e.jsxs(e.Fragment,{children:[e.jsx("nav",{className:"fixed bottom-0 z-50 flex w-full items-center justify-around border-t border-slate-100 bg-white px-4 py-3 pb-6 shadow-[0_-4px_20px_rgba(0,0,0,0.05)] sm:hidden",children:d.map(c=>e.jsxs("button",{onClick:()=>l(c.id),className:`flex flex-col items-center gap-1 rounded-xl px-3 py-2 transition-all ${t===c.id?"text-emerald-600":"text-slate-400 hover:text-slate-600"}`,"aria-label":c.label,children:[e.jsx(c.icon,{size:20}),e.jsx("span",{className:"text-[10px] font-bold",children:c.label})]},c.id))}),e.jsx("div",{className:"fixed bottom-6 left-1/2 z-50 hidden -translate-x-1/2 sm:block",children:e.jsx("div",{className:"flex gap-1 rounded-2xl border border-slate-200 bg-white p-1.5 shadow-xl shadow-slate-200/50",children:d.map(c=>e.jsx("button",{onClick:()=>l(c.id),className:`rounded-xl px-6 py-2.5 text-[10px] font-black tracking-wider uppercase transition-all ${t===c.id?"bg-emerald-600 text-white":"text-slate-500 hover:text-emerald-600"}`,children:c.label},c.id))})})]})}function gt({user:t,onLogout:l,onJoinClick:s,address:o,isLocating:d,onRequestLocation:c}){return e.jsx("nav",{className:"sticky top-0 z-50 w-full border-b border-slate-100/50 bg-white/70 px-4 py-3 backdrop-blur-xl sm:px-6 sm:py-4",children:e.jsxs("div",{className:"mx-auto flex max-w-6xl items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center overflow-hidden rounded-xl bg-emerald-50 shadow-lg shadow-emerald-100 sm:h-10 sm:w-10 sm:rounded-2xl",children:e.jsx("img",{src:"/icon.svg",alt:"Ramzania",className:"h-7 w-7 sm:h-8 sm:w-8"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-lg leading-none font-black tracking-tighter sm:text-xl",children:["RAMZAN",e.jsx("span",{className:"text-emerald-600",children:"IA"})]}),e.jsx("button",{onClick:c,className:"mt-0.5 flex items-center gap-1 text-[9px] font-bold tracking-wide text-slate-400 transition-colors hover:text-emerald-600",children:d?e.jsxs(e.Fragment,{children:[e.jsx(G,{size:8,className:"animate-spin"}),e.jsx("span",{children:"Locating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{size:8}),e.jsx("span",{className:"max-w-[120px] truncate sm:max-w-[180px]",children:(o==null?void 0:o.city)||(o==null?void 0:o.area)||"Set Location"})]})})]})]}),e.jsx("div",{className:"flex items-center gap-3 sm:gap-4",children:t?e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsxs("div",{className:"hidden text-right sm:block",children:[e.jsx("p",{className:"text-xs font-black text-slate-900",children:t.name}),e.jsx("p",{className:"text-[10px] font-bold text-emerald-600 uppercase",children:t.role==="provider"?"HOST":"GUEST"})]}),e.jsx("button",{onClick:l,className:"flex h-9 w-9 items-center justify-center rounded-xl border border-slate-200 bg-slate-50 text-slate-400 transition-all hover:text-red-500 sm:h-10 sm:w-10 sm:rounded-2xl","aria-label":"Logout",children:e.jsx(Qe,{size:16,className:"sm:h-[18px] sm:w-[18px]"})})]}):e.jsxs("button",{onClick:s,className:"flex items-center justify-center gap-1.5 rounded-xl bg-emerald-600 px-4 py-2 text-xs font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-95 sm:gap-2 sm:rounded-2xl sm:px-5 sm:text-sm",children:[e.jsx(Re,{size:14,className:"sm:h-4 sm:w-4"}),"Join"]})})]})})}function bt({point:t,onBook:l,compact:s=!1}){const o=d=>{const c=["th","st","nd","rd"],u=d%100;return d+(c[(u-20)%10]||c[u]||c[0])};return e.jsxs("div",{className:`flex flex-col border border-t-4 border-slate-100 border-t-emerald-500 bg-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-slate-200/40 ${s?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsxs("div",{className:`flex items-start justify-between ${s?"mb-2":"mb-4"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`leading-tight font-black text-slate-900 ${s?"text-base":"text-xl"}`,children:t.name}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[t.next_available_day&&e.jsxs("span",{className:"rounded-md bg-emerald-100 px-1.5 py-0.5 text-[10px] font-bold text-emerald-700",children:["Next: ",o(t.next_available_day)," Ramzan"]}),t.next_available_date&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-slate-400",children:[e.jsx(ue,{size:10}),t.next_available_date]})]})]}),e.jsx("span",{className:`rounded-lg font-black uppercase ${s?"px-1.5 py-0.5 text-[8px]":"rounded-xl px-2 py-1 text-[9px]"} ${t.price===0?"bg-emerald-50 text-emerald-600":"bg-amber-50 text-amber-600"}`,children:t.price===0?"Free":`From ‚Çπ${t.price}`})]}),e.jsxs("div",{className:`flex-1 bg-slate-50 text-slate-600 ${s?"mb-3 rounded-xl p-3 text-xs leading-relaxed":"mb-6 rounded-2xl p-4 text-sm leading-relaxed"}`,children:[t.menu_items&&e.jsx("p",{className:"font-medium text-slate-700",children:t.menu_items}),t.message&&e.jsxs("p",{className:"mt-1 text-[11px] text-slate-500 italic",children:['"',t.message,'"']}),!t.menu_items&&!t.message&&e.jsx("span",{className:"text-slate-400 italic",children:"Menu details available on booking"})]}),e.jsxs("div",{className:"mb-3 flex flex-wrap items-center gap-2 text-[10px] text-slate-500",children:[t.distance!==null&&t.distance!==void 0&&e.jsxs("span",{className:"flex items-center gap-1 rounded bg-blue-50 px-1.5 py-0.5 font-bold text-blue-600",children:["üìç ",t.distance," km"]}),t.total_offerings&&e.jsxs("span",{className:"flex items-center gap-1 rounded bg-emerald-50 px-1.5 py-0.5 text-emerald-600",children:[e.jsx(ve,{size:10})," ",t.total_offerings," days"]}),t.area&&e.jsxs("span",{className:"rounded bg-slate-100 px-1.5 py-0.5",children:["üìç ",t.area]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:`grid gap-2 ${t.latitude&&t.longitude?"grid-cols-3":"grid-cols-2"}`,children:[e.jsxs("button",{onClick:()=>globalThis.open(`tel:${t.phone}`),className:`flex items-center justify-center gap-1.5 rounded-xl border border-slate-200 bg-white font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-95 ${s?"px-2 py-2 text-xs":"px-4 py-3.5 text-sm"}`,children:[e.jsx(Ae,{size:s?12:16})," Call"]}),e.jsxs("button",{onClick:()=>globalThis.open(`https://wa.me/${t.phone.replaceAll(/\D/g,"")}`),className:`flex items-center justify-center gap-1.5 rounded-xl border border-emerald-100 bg-white font-bold text-emerald-600 transition-all hover:bg-emerald-50 active:scale-95 ${s?"px-2 py-2 text-xs":"px-4 py-3.5 text-sm"}`,children:[e.jsx(et,{size:s?12:16})," Chat"]}),t.latitude&&t.longitude&&e.jsxs("button",{onClick:()=>globalThis.open(`https://www.google.com/maps/dir/?api=1&destination=${t.latitude},${t.longitude}`),className:`flex items-center justify-center gap-1.5 rounded-xl border border-blue-100 bg-white font-bold text-blue-600 transition-all hover:bg-blue-50 active:scale-95 ${s?"px-2 py-2 text-xs":"px-4 py-3.5 text-sm"}`,children:[e.jsx(oe,{size:s?12:16})," Map"]})]}),e.jsx("button",{onClick:()=>l(t),disabled:!t.isBookable,className:`flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-95 disabled:bg-emerald-300 disabled:opacity-50 ${s?"px-3 py-2 text-xs":"px-6 py-3.5 text-sm"}`,children:t.isBookable?"Reserve Sehri":"Info Only"})]})]})}function jt({time:t,compact:l=!1}){return e.jsxs("div",{className:`group relative overflow-hidden border-none bg-emerald-600 text-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-emerald-200/40 ${l?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsx(tt,{size:l?60:100,className:"absolute -top-4 -right-4 text-emerald-500/30 transition-transform duration-500 group-hover:scale-110"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("span",{className:`block font-black tracking-wider text-emerald-200 uppercase ${l?"mb-1 text-[8px]":"mb-8 text-[10px]"}`,children:"Imsak (Sehar)"}),e.jsx("h4",{className:`font-black tracking-tight ${l?"text-3xl":"text-5xl"}`,children:t}),!l&&e.jsx("p",{className:"mt-1 text-sm font-medium text-emerald-100/80",children:"Stop eating and intend to fast."})]})]})}function Nt({time:t,compact:l=!1}){return e.jsxs("div",{className:`group relative overflow-hidden border-none bg-slate-950 text-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-slate-200/40 ${l?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsx(st,{size:l?60:100,className:"absolute -top-4 -right-4 text-slate-800/50 transition-transform duration-500 group-hover:rotate-12"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("span",{className:`block font-black tracking-wider text-slate-400 uppercase ${l?"mb-1 text-[8px]":"mb-8 text-[10px]"}`,children:"Maghrib (Iftar)"}),e.jsx("h4",{className:`font-black tracking-tight ${l?"text-3xl":"text-5xl"}`,children:t}),!l&&e.jsx("p",{className:"mt-1 text-sm font-medium text-slate-400/80",children:"Break your fast with the sun's set."})]})]})}function yt({timings:t,compact:l=!1}){return e.jsxs("div",{className:`grid grid-cols-2 ${l?"gap-3":"gap-4"}`,children:[e.jsx(jt,{time:t.sehar,compact:l}),e.jsx(Nt,{time:t.iftar,compact:l})]})}async function vt(t,l){try{const o=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${t}&lon=${l}&zoom=18&addressdetails=1`,{headers:{"Accept-Language":"en"}})).json();if(o!=null&&o.address){const{road:d,suburb:c,neighbourhood:u,city:n,town:N,village:b,state_district:i,state:p,postcode:x,county:f}=o.address;return{street:d||"",area:c||u||f||"",city:n||N||b||i||"",pincode:x||"",state:p||""}}return null}catch(s){return console.error("Reverse geocoding failed:",s),null}}function wt({onClose:t,onSuccess:l}){const[s,o]=a.useState("CHOICE"),[d,c]=a.useState(!1),[u,n]=a.useState(""),[N,b]=a.useState(""),[i,p]=a.useState(""),[x,f]=a.useState("seeker"),[A,v]=a.useState(""),[_,S]=a.useState(""),[g,P]=a.useState(""),[m,z]=a.useState(""),[F,E]=a.useState(""),[L,O]=a.useState(""),[T,X]=a.useState(""),[H,te]=a.useState(""),[se,Q]=a.useState(""),[k,B]=a.useState(null),[Z,ee]=a.useState(null),[r,R]=a.useState(!1),[I,ae]=a.useState(""),[W,ge]=a.useState(""),[K,C]=a.useState(""),[D,M]=a.useState(""),[q,Y]=a.useState(["","","","","",""]),[re,Pe]=a.useState(""),we=a.useRef([]),Fe=a.useCallback(async()=>{if(navigator.geolocation){R(!0);try{const j=await new Promise((V,We)=>{navigator.geolocation.getCurrentPosition(V,We,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),{latitude:y,longitude:w}=j.coords;B(y),ee(w);const $=await vt(y,w);$&&(O($.street),X($.area),te($.city),Q($.pincode))}catch(j){console.log("Location fetch failed:",j.message)}finally{R(!1)}}},[]);a.useEffect(()=>{s==="REGISTER"&&Fe()},[s,Fe]);const Te=(j,y)=>{var V;const w=j.target.value;if(isNaN(w))return;const $=[...q];$[y]=w.slice(-1),Y($),w&&y<5&&((V=we.current[y+1])==null||V.focus())},Be=(j,y)=>{var w;j.key==="Backspace"&&!q[y]&&y>0&&((w=we.current[y-1])==null||w.focus())},Ge=async j=>{var y,w;j.preventDefault(),n(""),c(!0);try{const $=await J.login({email:N,password:i});if($.success)$.token&&ke.set("auth_token",$.token),h.success("Welcome back!",{description:`Logged in as ${$.user.name}`}),l($.user);else{const V=$.message||"Login failed";n(V),h.error("Login Failed",{description:V})}}catch($){const V=$.message||((w=(y=$.errors)==null?void 0:y.email)==null?void 0:w[0])||"Login failed. Please try again.";n(V),h.error("Login Failed",{description:V})}finally{c(!1)}},He=async j=>{var y,w;if(j.preventDefault(),n(""),_.length<6){n("Password must be at least 6 characters"),h.error("Validation Error",{description:"Password must be at least 6 characters"});return}c(!0);try{const $=await J.register({email:A,password:_,name:g,contact:m,role:x,place_name:x==="provider"?F:null,street:L,area:T,city:H,pincode:se,latitude:k,longitude:Z});if($.success)h.success("OTP Sent!",{description:"Please check your email for the verification code"}),Pe("register"),Y(["","","","","",""]),o("OTP");else{const V=$.message||"Registration failed";n(V),h.error("Registration Failed",{description:V})}}catch($){const V=$.message||((w=(y=$.errors)==null?void 0:y.email)==null?void 0:w[0])||"Registration failed. Please try again.";n(V),h.error("Registration Failed",{description:V})}finally{c(!1)}},Ve=async j=>{if(j.preventDefault(),n(""),!I){n("Please enter your email"),h.error("Email Required",{description:"Please enter your registered email address"});return}c(!0);try{const y=await J.forgotPassword(I);if(y.success)h.success("OTP Sent!",{description:"Please check your email for the reset code"}),Pe("forgot"),Y(["","","","","",""]),o("OTP");else{const w=y.message||"Failed to send OTP";n(w),h.error("Failed",{description:w})}}catch(y){const w=y.message||"Failed to send OTP. Please try again.";n(w),h.error("Failed",{description:w})}finally{c(!1)}},Ue=async()=>{const j=q.join("");if(!(j.length<6)){n(""),c(!0);try{if(re==="register"){const y=await J.verifyRegistrationOtp(A,j);if(y.success)y.token&&ke.set("auth_token",y.token),h.success("Account Verified!",{description:"Welcome to Ramzania!"}),l(y.user);else{const w=y.message||"Invalid OTP";n(w),h.error("Verification Failed",{description:w})}}else if(re==="forgot"){const y=await J.verifyForgotPasswordOtp(I,j);if(y.success)h.success("OTP Verified!",{description:"Now set your new password"}),M(y.reset_token),o("RESET_PASSWORD");else{const w=y.message||"Invalid OTP";n(w),h.error("Verification Failed",{description:w})}}}catch(y){const w=y.message||"OTP verification failed. Please try again.";n(w),h.error("Verification Failed",{description:w})}finally{c(!1)}}},Ye=async j=>{if(j.preventDefault(),n(""),W.length<6){n("Password must be at least 6 characters"),h.error("Validation Error",{description:"Password must be at least 6 characters"});return}if(W!==K){n("Passwords do not match"),h.error("Validation Error",{description:"Passwords do not match"});return}c(!0);try{const y=await J.resetPassword(I,D,W,K);if(y.success)h.success("Password Reset!",{description:"You can now login with your new password"}),o("LOGIN"),n(""),ae(""),ge(""),C(""),M("");else{const w=y.message||"Password reset failed";n(w),h.error("Reset Failed",{description:w})}}catch(y){const w=y.message||"Password reset failed. Please try again.";n(w),h.error("Reset Failed",{description:w})}finally{c(!1)}},Xe=async()=>{c(!0),n("");try{let j;if(re==="register"?j=await J.resendRegistrationOtp(A):j=await J.forgotPassword(I),j.success)h.success("OTP Resent!",{description:"Please check your email for the new code"}),Y(["","","","","",""]);else{const y=j.message||"Failed to resend OTP";n(y),h.error("Failed",{description:y})}}catch{const y="Failed to resend OTP. Please try again.";n(y),h.error("Failed",{description:y})}finally{c(!1)}},he="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",le="w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",ie="flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 px-4 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",Ke={CHOICE:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/icon.svg",alt:"Ramzania",className:"h-12 w-12"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black tracking-tight text-slate-900",children:"Join Ramzania"}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Your portal to community Sehar."})]})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("button",{className:ie,onClick:()=>o("LOGIN"),children:"Sign In"}),e.jsx("button",{className:"flex w-full items-center justify-center gap-2 rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-[0.98]",onClick:()=>o("REGISTER"),children:"Create Account"})]})]}),LOGIN:e.jsxs("form",{onSubmit:Ge,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>o("CHOICE"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(be,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Sign In"})]}),u&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:u}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"email",required:!0,placeholder:"Email address",className:he,value:N,onChange:j=>b(j.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Password",className:he,value:i,onChange:j=>p(j.target.value)})]}),e.jsx("button",{type:"submit",disabled:d,className:ie,children:d?e.jsx(G,{className:"animate-spin",size:18}):"Sign In"}),e.jsx("button",{type:"button",onClick:()=>o("FORGOT"),className:"w-full text-center text-[10px] font-bold tracking-wide text-slate-400 uppercase hover:text-emerald-600",children:"Forgot Password?"})]}),REGISTER:e.jsxs("form",{onSubmit:He,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>o("CHOICE"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(be,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Create Account"})]}),u&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:u}),e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{type:"button",onClick:()=>f("seeker"),className:`flex-1 rounded-lg py-2.5 text-xs font-bold transition-all ${x==="seeker"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"üçΩÔ∏è Guest"}),e.jsx("button",{type:"button",onClick:()=>f("provider"),className:`flex-1 rounded-lg py-2.5 text-xs font-bold transition-all ${x==="provider"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"üè† Host"})]}),e.jsx("p",{className:"text-[10px] font-medium text-slate-400",children:x==="seeker"?"Find & reserve Sehri near you":"Arrange Sehri for guests in your area"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"email",required:!0,placeholder:"Email address",className:le,value:A,onChange:j=>v(j.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Password (min 6 chars)",className:le,value:_,onChange:j=>S(j.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Full Name",className:le,value:g,onChange:j=>P(j.target.value)}),e.jsx("input",{type:"tel",required:!0,placeholder:"Contact Number",className:le,value:m,onChange:j=>z(j.target.value)})]}),x==="provider"&&e.jsx("input",{type:"text",required:!0,placeholder:"Place Name (e.g., Restaurant, Masjid,..)",className:le,value:F,onChange:j=>E(j.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500",children:"Address Details"}),r&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(G,{size:10,className:"animate-spin"}),"Fetching location..."]}),!r&&H&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(oe,{size:10}),"Auto-filled"]})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Street / Door No",className:le,value:L,onChange:j=>O(j.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Area / Locality",className:le,value:T,onChange:j=>X(j.target.value)}),e.jsx("input",{type:"text",required:!0,placeholder:"City",className:le,value:H,onChange:j=>te(j.target.value)})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Pincode",className:le,value:se,onChange:j=>Q(j.target.value)})]}),e.jsx("button",{type:"submit",disabled:d,className:ie,children:d?e.jsx(G,{className:"animate-spin",size:18}):"Continue ‚Üí"})]}),FORGOT:e.jsxs("form",{onSubmit:Ve,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>o("LOGIN"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(be,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Reset Password"})]}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Enter your email to receive a verification code."}),u&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:u}),e.jsx("input",{type:"email",required:!0,placeholder:"Registered email",className:he,value:I,onChange:j=>ae(j.target.value)}),e.jsx("button",{type:"submit",disabled:d,className:ie,children:d?e.jsx(G,{className:"animate-spin",size:18}):"Send OTP"})]}),OTP:e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>o(re==="register"?"REGISTER":"FORGOT"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(be,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Verify Email"})]}),e.jsxs("p",{className:"text-sm font-medium text-slate-500",children:["Enter the 6-digit code sent to ",e.jsx("span",{className:"font-bold text-slate-700",children:re==="register"?A:I})]}),u&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:u}),e.jsx("div",{className:"flex justify-between gap-2",children:q.map((j,y)=>e.jsx("input",{ref:w=>we.current[y]=w,type:"text",inputMode:"numeric",maxLength:1,className:"h-12 w-full rounded-xl border border-slate-200 bg-slate-50 text-center text-lg font-bold transition-all outline-none focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",value:j,onChange:w=>Te(w,y),onKeyDown:w=>Be(w,y)},y))}),e.jsx("button",{type:"button",onClick:Ue,disabled:d||q.join("").length<6,className:ie,children:d?e.jsx(G,{className:"animate-spin",size:18}):"Verify"}),e.jsx("button",{type:"button",onClick:Xe,disabled:d,className:"w-full text-center text-[10px] font-bold tracking-wide text-slate-400 uppercase hover:text-emerald-600",children:"Resend Code"})]}),RESET_PASSWORD:e.jsxs("form",{onSubmit:Ye,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(at,{size:20,className:"text-emerald-600"}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"New Password"})]}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Create a new password for your account."}),u&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:u}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"password",required:!0,placeholder:"New Password (min 6 chars)",className:he,value:W,onChange:j=>ge(j.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Confirm Password",className:he,value:K,onChange:j=>C(j.target.value)})]}),e.jsx("button",{type:"submit",disabled:d,className:ie,children:d?e.jsx(G,{className:"animate-spin",size:18}):"Reset Password"})]})};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-slate-900/40 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-4 w-full max-w-md rounded-2xl border border-slate-100 bg-white p-6 shadow-xl sm:rounded-3xl sm:p-8",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-emerald-50 text-emerald-600",children:e.jsx(Re,{size:20})}),e.jsx("button",{onClick:t,className:"rounded-full p-2 text-slate-300 transition-all hover:bg-slate-100 hover:text-slate-500",children:e.jsx(ne,{size:18})})]}),Ke[s]]})})}const fe=t=>new Promise(l=>setTimeout(l,t)),St=async(t={})=>{try{const l=new URLSearchParams;t.area&&l.append("area",t.area),t.place&&l.append("place",t.place);const s=l.toString(),o=`/home/offerings${s?`?${s}`:""}`,d=await U.get(o,{auth:!1});return d.success?{providers:d.providers||[],filters:d.filters||{},current_ramzan_day:d.current_ramzan_day,ramzan_start_date:d.ramzan_start_date}:{providers:Oe(),filters:{}}}catch(l){return console.error("Failed to fetch providers from API, using mock data:",l),{providers:Oe(),filters:{}}}},kt=async(t=null,l=null)=>{try{const s=new URLSearchParams;t&&s.append("day",t),l&&s.append("date",l);const o=s.toString(),d=o?`/home/timings?${o}`:"/home/timings",c=await U.get(d,{auth:!1});return c.success?c:{success:!1,timing:null}}catch(s){return console.error("Failed to fetch Ramzan timings:",s),{success:!1,timing:null}}},Ct=async()=>{try{const t=await U.get("/home/timings/all",{auth:!1});return t.success?t.timings||[]:[]}catch(t){return console.error("Failed to fetch all Ramzan timings:",t),[]}},_t=async(t,l={})=>{try{const s=new URLSearchParams;l.lat&&s.append("lat",l.lat),l.lng&&s.append("lng",l.lng);const o=s.toString(),d=`/home/provider/${t}/offerings${o?`?${o}`:""}`,c=await U.get(d,{auth:!1});return c.success?c:{success:!1,offerings:[]}}catch(s){return console.error("Failed to fetch provider offerings:",s),{success:!1,offerings:[]}}},Rt=async(t,l)=>U.post("/bookings",{offering_id:t,quantity:l}),At=async()=>U.get("/bookings/my"),zt=async t=>U.post(`/bookings/${t}/cancel`),Pt=async(t="all")=>{const l=t==="all"?"/bookings/provider":`/bookings/provider?status=${t}`;return U.get(l)},Ft=async(t,l)=>U.put(`/bookings/${t}/status`,{status:l}),Oe=()=>[],Ot=async()=>(await fe(200),[{id:1,title:"Dua for Suhoor (Intention for Fasting)",arabic:"ŸàŸéÿ®ŸêÿµŸéŸàŸíŸÖŸê ÿ∫ŸéÿØŸç ŸÜŸéŸàŸéŸäŸíÿ™Ÿè ŸÖŸêŸÜŸí ÿ¥ŸéŸáŸíÿ±Ÿê ÿ±ŸéŸÖŸéÿ∂ŸéÿßŸÜŸé",transliteration:"Wa bisawmi ghadin nawaitu min shahri Ramadan",english:"I intend to fast tomorrow for the month of Ramadan."},{id:2,title:"Dua for Iftar (Breaking Fast)",arabic:"ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ•ŸêŸÜŸêŸëŸä ŸÑŸéŸÉŸé ÿµŸèŸÖŸíÿ™Ÿè ŸàŸéÿ®ŸêŸÉŸé ÿ¢ŸÖŸéŸÜŸíÿ™Ÿè ŸàŸéÿπŸéŸÑŸéŸäŸíŸÉŸé ÿ™ŸéŸàŸéŸÉŸéŸëŸÑŸíÿ™Ÿè ŸàŸéÿπŸéŸÑŸéŸâ ÿ±Ÿêÿ≤ŸíŸÇŸêŸÉŸé ÿ£ŸéŸÅŸíÿ∑Ÿéÿ±Ÿíÿ™Ÿè",transliteration:"Allahumma inni laka sumtu wa bika aamantu wa ‚Äòalayka tawakkaltu wa ‚Äòala rizqika aftartu",english:"O Allah, I fasted for You, I believe in You, I trust in You, and I break my fast with Your provision."},{id:3,title:"Dua After Breaking Fast (Authentic)",arabic:"ÿ∞ŸéŸáŸéÿ®Ÿé ÿßŸÑÿ∏ŸéŸëŸÖŸéÿ£Ÿè ŸàŸéÿßÿ®Ÿíÿ™ŸéŸÑŸéŸëÿ™Ÿê ÿßŸÑŸíÿπŸèÿ±ŸèŸàŸÇŸè ŸàŸéÿ´Ÿéÿ®Ÿéÿ™Ÿé ÿßŸÑŸíÿ£Ÿéÿ¨Ÿíÿ±Ÿè ÿ•ŸêŸÜŸí ÿ¥Ÿéÿßÿ°Ÿé ÿßŸÑŸÑŸéŸëŸáŸè",transliteration:"Dhahaba adh-dhama‚Äôu wabtallatil ‚Äòurooq wa thabatal ajru in sha Allah",english:"The thirst is gone, the veins are moistened, and the reward is confirmed, if Allah wills."},{id:4,title:"Dua for Laylatul Qadr",arabic:"ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ•ŸêŸÜŸéŸëŸÉŸé ÿπŸéŸÅŸèŸàŸåŸë ÿ™Ÿèÿ≠Ÿêÿ®ŸèŸë ÿßŸÑŸíÿπŸéŸÅŸíŸàŸé ŸÅŸéÿßÿπŸíŸÅŸè ÿπŸéŸÜŸêŸëŸä",transliteration:"Allahumma innaka afuwwun tuhibbul afwa fa‚Äôfu anni",english:"O Allah, You are Most Forgiving, and You love forgiveness; so forgive me."},{id:5,title:"Dua for Forgiveness",arabic:"ÿ£Ÿéÿ≥Ÿíÿ™Ÿéÿ∫ŸíŸÅŸêÿ±Ÿè ÿßŸÑŸÑŸéŸëŸáŸé",transliteration:"Astaghfirullah",english:"I seek forgiveness from Allah."},{id:6,title:"Dua for Mercy",arabic:"ÿ±Ÿéÿ®ŸêŸë ÿßÿ∫ŸíŸÅŸêÿ±Ÿí ŸàŸéÿßÿ±Ÿíÿ≠ŸéŸÖŸí ŸàŸéÿ£ŸéŸÜŸíÿ™Ÿé ÿÆŸéŸäŸíÿ±Ÿè ÿßŸÑÿ±ŸéŸëÿßÿ≠ŸêŸÖŸêŸäŸÜŸé",transliteration:"Rabbighfir warham wa anta khayrur rahimeen",english:"My Lord, forgive and have mercy, for You are the Best of the merciful."},{id:7,title:"Dua for Guidance",arabic:"ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿßŸáŸíÿØŸêŸÜŸêŸä ŸàŸéÿ≥ŸéÿØŸêŸëÿØŸíŸÜŸêŸä",transliteration:"Allahumma ihdini wa saddidni",english:"O Allah, guide me and keep me steadfast."},{id:8,title:"Dua for Acceptance of Fasting",arabic:"ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ™ŸéŸÇŸéÿ®ŸéŸëŸÑŸí ŸÖŸêŸÜŸéŸëÿß ÿ•ŸêŸÜŸéŸëŸÉŸé ÿ£ŸéŸÜŸíÿ™Ÿé ÿßŸÑÿ≥ŸéŸëŸÖŸêŸäÿπŸè ÿßŸÑŸíÿπŸéŸÑŸêŸäŸÖŸè",transliteration:"Allahumma taqabbal ŸÖŸÜÿß innaka antas-samee‚Äôul aleem",english:"O Allah, accept from us. Indeed, You are the All-Hearing, All-Knowing."}]),Dt=async()=>(await fe(200),[]),Mt=async(t="Chennai")=>(await fe(100),{sehar:"4:52 AM",iftar:"6:24 PM",area:t}),Et=async(t,l)=>(await fe(1e3),{success:!0,user:{email:t,role:t.includes("admin")?"admin":"seeker",name:t.split("@")[0],token:"token-"+Date.now()}}),Lt=async(t,l)=>(await fe(500),{success:!0,bookingId:`BK-${Date.now()}`,message:"Spot booked successfully!"}),ce={fetchPoints:St,fetchDuas:Ot,fetchEvents:Dt,fetchTimings:Mt,fetchRamzanTimings:kt,fetchAllRamzanTimings:Ct,login:Et,bookSpot:Lt};function $t({point:t,user:l,userLocation:s,onClose:o,onSuccess:d,onLoginClick:c}){const[u,n]=a.useState(!0),[N,b]=a.useState([]),[i,p]=a.useState(null),[x,f]=a.useState(null),[A,v]=a.useState(1),[_,S]=a.useState(!1);a.useEffect(()=>{(async()=>{n(!0);const z=t.provider_id||t.id,F={};s!=null&&s.lat&&(s!=null&&s.lng)&&(F.lat=s.lat,F.lng=s.lng);const E=await _t(z,F);E.success&&(p(E.provider),b(E.offerings||[])),n(!1)})()},[t,s]);const g=m=>{const z=["th","st","nd","rd"],F=m%100;return m+(z[(F-20)%10]||z[F]||z[0])},P=async()=>{if(!x){h.error("Please select a date");return}S(!0);try{const m=await Rt(x.id,A);m.success?(h.success("Spot Booked!",{description:`Booking code: ${m.booking.booking_code}`}),d==null||d(`Spot booked for ${g(x.ramzan_day)} Ramzan!`)):h.error("Booking Failed",{description:m.message})}catch(m){m.status===401?(h.error("Please login to book"),c==null||c()):h.error("Booking Failed",{description:m.message})}finally{S(!1)}};return l?e.jsx("div",{className:"fixed inset-0 z-100 flex items-end justify-center bg-slate-900/30 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-10 max-h-[90vh] w-full max-w-md overflow-hidden rounded-3xl border border-slate-100 bg-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 p-4",children:[e.jsx("h2",{className:"text-lg font-black text-slate-900",children:"Reserve Sehri"}),e.jsx("button",{onClick:o,className:"rounded-full p-2 text-slate-400 hover:bg-slate-100",children:e.jsx(ne,{size:18})})]}),e.jsxs("div",{className:"bg-emerald-50 px-4 py-3",children:[e.jsx("p",{className:"font-black text-emerald-800",children:(i==null?void 0:i.name)||t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-emerald-600",children:[e.jsx("span",{children:(i==null?void 0:i.area)||t.area}),(i==null?void 0:i.distance)!==null&&(i==null?void 0:i.distance)!==void 0&&e.jsxs("span",{className:"flex items-center gap-0.5 rounded bg-emerald-100 px-1.5 py-0.5 text-emerald-700",children:[e.jsx(oe,{size:10})," ",i.distance," km"]})]})]}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto p-4",children:u?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(G,{size:24,className:"animate-spin text-emerald-600"})}):N.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(ve,{size:32,className:"mx-auto mb-2 text-slate-300"}),e.jsx("p",{className:"text-sm text-slate-500",children:"No available dates"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"mb-3 text-xs font-bold text-slate-500",children:"Select a date:"}),N.map(m=>e.jsxs("button",{disabled:!m.is_bookable,onClick:()=>f(m),className:`w-full rounded-xl border p-3 text-left transition-all ${(x==null?void 0:x.id)===m.id?"border-emerald-500 bg-emerald-50 ring-2 ring-emerald-200":m.is_bookable?"border-slate-200 bg-white hover:border-emerald-300 hover:bg-emerald-50/50":"cursor-not-allowed border-slate-100 bg-slate-50 opacity-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 text-xs font-black text-emerald-700",children:g(m.ramzan_day)}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold text-slate-800",children:[m.formatted_date,e.jsxs("span",{className:"ml-1 text-[10px] font-normal text-slate-400",children:["(",m.day_name,")"]})]}),e.jsx("p",{className:"text-[10px] text-slate-500",children:m.meal_type})]})]}),e.jsxs("div",{className:"text-right",children:[(x==null?void 0:x.id)===m.id&&e.jsx(Le,{size:16,className:"text-emerald-600"}),!x||x.id!==m.id?e.jsx("span",{className:`text-xs font-bold ${m.is_bookable?"text-emerald-600":"text-red-500"}`,children:m.is_bookable?`${m.available_slots} spots`:"Full"}):null]})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-1.5 text-[10px] text-slate-500",children:[m.timing&&e.jsxs("span",{className:"flex items-center gap-0.5 rounded bg-slate-100 px-1.5 py-0.5",children:[e.jsx(me,{size:10})," ",m.timing]}),e.jsx("span",{className:`rounded px-1.5 py-0.5 ${m.price_type==="free"?"bg-emerald-100 text-emerald-600":"bg-amber-100 text-amber-600"}`,children:m.price_type==="free"?"Free":`‚Çπ${m.price_amount}`})]}),e.jsxs("p",{className:"mt-2 text-[10px] text-slate-400 italic",children:['"',m.menu_items,'"']})]},m.id))]})}),x&&e.jsxs("div",{className:"border-t border-slate-100 bg-slate-50 p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between rounded-xl bg-white p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{size:16,className:"text-slate-400"}),e.jsx("span",{className:"text-sm font-bold text-slate-700",children:"No. of Persons"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>v(m=>Math.max(1,m-1)),className:"rounded-lg bg-slate-100 p-1.5 text-slate-600 hover:bg-slate-200",children:e.jsx(lt,{size:14})}),e.jsx("span",{className:"w-6 text-center text-sm font-black text-slate-900",children:A}),e.jsx("button",{type:"button",onClick:()=>v(m=>Math.min(x.available_slots,Math.min(10,m+1))),className:"rounded-lg bg-slate-100 p-1.5 text-slate-600 hover:bg-slate-200",children:e.jsx($e,{size:14})})]})]}),e.jsxs("div",{className:"mb-4 flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-slate-500",children:[g(x.ramzan_day)," Ramzan ‚Ä¢ ",x.meal_type]}),e.jsx("span",{className:"font-bold text-slate-900",children:x.price_type==="free"?"Free":`‚Çπ${(x.price_amount||0)*A}`})]}),e.jsx("button",{onClick:P,disabled:_,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",children:_?e.jsxs(e.Fragment,{children:[e.jsx(G,{size:16,className:"animate-spin"}),"Booking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{size:16}),"Confirm Booking"]})})]})]})}):e.jsx("div",{className:"fixed inset-0 z-100 flex items-end justify-center bg-slate-900/30 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-10 w-full max-w-md rounded-3xl border border-slate-100 bg-white p-6 shadow-lg",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Book Spot"}),e.jsx("button",{onClick:o,className:"rounded-full p-2 text-slate-400 hover:bg-slate-100",children:e.jsx(ne,{size:18})})]}),e.jsxs("div",{className:"mb-6 rounded-xl bg-emerald-50 p-4",children:[e.jsx("p",{className:"font-black text-emerald-800",children:t.name}),e.jsx("p",{className:"text-xs text-emerald-600",children:t.area})]}),e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:[e.jsx(Re,{size:32,className:"mx-auto mb-3 text-slate-400"}),e.jsx("p",{className:"font-bold text-slate-700",children:"Login Required"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Please login or register to reserve Sehri"}),e.jsx("button",{onClick:()=>{o(),c==null||c()},className:"mt-4 rounded-xl bg-emerald-600 px-6 py-2.5 text-sm font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:"Login / Register"})]})]})})}function It({timings:t,ramzanTiming:l,points:s,onBook:o,availableAreas:d=[],onFilterChange:c,loading:u}){const[n,N]=a.useState(""),[b,i]=a.useState(""),[p,x]=a.useState(!1),f=()=>{const g=new Date,P=new Date("2026-02-19"),m=new Date("2026-03-20");return g>=P&&g<=m},A=s.filter(g=>g.name.toLowerCase().includes(n.toLowerCase())||g.menu.toLowerCase().includes(n.toLowerCase())),v=g=>{i(g),c&&c({area:g})},_=()=>{i(""),N(""),c&&c({})},S=g=>{if(!g)return"--:--";const[P,m]=g.split(":"),z=parseInt(P),F=z>=12?"PM":"AM";return`${z%12||12}:${m} ${F}`};return e.jsxs("div",{className:"space-y-6",children:[l&&f()&&e.jsxs("section",{className:"rounded-2xl bg-gradient-to-br from-emerald-50 to-teal-50 p-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{size:16,className:"text-emerald-600"}),e.jsxs("h2",{className:"text-sm font-black tracking-tight text-slate-900",children:["Day ",l.ramzan_day," - Prayer Times"]})]}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:new Date(l.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"rounded-xl bg-white/80 p-3 text-center shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:"Sehri Ends"}),e.jsx("p",{className:"text-lg font-black text-emerald-700",children:S(l.sehar_time)})]}),e.jsxs("div",{className:"rounded-xl bg-white/80 p-3 text-center shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:"Iftar"}),e.jsx("p",{className:"text-lg font-black text-orange-600",children:S(l.iftar_time)})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2 sm:grid-cols-6",children:[{name:"Fajr",time:l.fajr},{name:"Zohar",time:l.zohar},{name:"Asar",time:l.asar},{name:"Magrib",time:l.magrib},{name:"Isha",time:l.isha},{name:"Taraweeh",time:l.taraweeh}].map(g=>e.jsxs("div",{className:"rounded-lg bg-white/60 px-2 py-1.5 text-center",children:[e.jsx("p",{className:"text-[10px] font-medium text-slate-500",children:g.name}),e.jsx("p",{className:"text-xs font-bold text-slate-700",children:S(g.time)})]},g.name))})]}),!l&&f()&&e.jsxs("section",{children:[e.jsx("h2",{className:"mb-3 text-sm font-black tracking-tight text-slate-900",children:"Today's Timings"}),e.jsx(yt,{timings:t,compact:!0})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{size:16,className:"text-emerald-600"}),e.jsx("h2",{className:"text-sm font-black tracking-tight text-slate-900",children:"Sehri Locations"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"rounded-lg bg-slate-100 px-2 py-0.5 text-xs font-bold text-slate-600",children:u?"...":`${A.length} nearby`}),e.jsxs("button",{onClick:()=>x(!p),className:`flex items-center gap-1 rounded-lg px-2 py-0.5 text-xs font-bold transition-colors ${p||b?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600"}`,children:[e.jsx(rt,{size:12}),"Filter"]})]})]}),p&&e.jsxs("div",{className:"mb-4 rounded-xl border border-slate-200 bg-slate-50 p-3",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-bold text-slate-700",children:"Filter by Area"}),b&&e.jsxs("button",{onClick:_,className:"flex items-center gap-1 text-xs text-slate-500 hover:text-slate-700",children:[e.jsx(ne,{size:12})," Clear"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.length>0?d.map(g=>e.jsxs("button",{onClick:()=>v(g===b?"":g),className:`flex items-center gap-1 rounded-full px-3 py-1 text-xs font-medium transition-colors ${b===g?"bg-emerald-600 text-white":"bg-white text-slate-600 hover:bg-emerald-50"}`,children:[e.jsx(oe,{size:10}),g]},g)):e.jsx("p",{className:"text-xs text-slate-400",children:"No areas available"})})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(nt,{size:16,className:"absolute top-1/2 left-3 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search Sehri Locations...",value:n,onChange:g=>N(g.target.value),className:"w-full rounded-xl border border-slate-200 bg-white py-2.5 pr-4 pl-9 text-sm font-medium text-slate-900 placeholder:text-slate-400 focus:border-emerald-300 focus:ring-2 focus:ring-emerald-100 focus:outline-none"})]}),u?e.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:e.jsx("div",{className:"animate-pulse",children:e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Loading hosts..."})})}):A.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:A.map(g=>e.jsx(bt,{point:g,onBook:o,compact:!0},g.id))}):e.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"No Sehri found"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Try a different search term or clear filters"})]})]})]})}const qt="ramzania_user";function Tt({user:t,onUserUpdate:l}){const[s,o]=a.useState({place_name:"",contact:"",alternate_contact:"",street:"",area:"",city:"",pincode:"",latitude:"",longitude:""}),[d,c]=a.useState(!1),[u,n]=a.useState({type:"",text:""}),[N,b]=a.useState(!1),[i,p]=a.useState(!1);a.useEffect(()=>{t&&o({place_name:t.place_name||"",contact:t.contact||"",alternate_contact:t.alternate_contact||"",street:t.street||"",area:t.area||"",city:t.city||"",pincode:t.pincode||"",latitude:t.latitude||"",longitude:t.longitude||""})},[t]);const x=S=>{const{name:g,value:P}=S.target;o(m=>({...m,[g]:P}))},f=a.useCallback(()=>{if(!navigator.geolocation){n({type:"error",text:"Geolocation not supported by your browser"});return}n({type:"info",text:"Getting your location..."}),navigator.geolocation.getCurrentPosition(S=>{o(g=>({...g,latitude:S.coords.latitude.toFixed(6),longitude:S.coords.longitude.toFixed(6)})),n({type:"success",text:"Location updated!"}),setTimeout(()=>n({type:"",text:""}),2e3)},S=>{n({type:"error",text:"Failed to get location: "+S.message})},{enableHighAccuracy:!0,timeout:1e4})},[]),A=()=>{const S=s.latitude||19.076,g=s.longitude||72.8777;window.open(`https://www.google.com/maps/search/?api=1&query=${S},${g}`,"_blank"),n({type:"info",text:"Copy the coordinates from Google Maps URL and paste them in the fields above"})},v=async S=>{var g,P;S.preventDefault(),c(!0),n({type:"",text:""});try{const m=await J.updateProfile({user_id:t.id,place_name:s.place_name,contact:s.contact,alternate_contact:s.alternate_contact||null,street:s.street,area:s.area,city:s.city,pincode:s.pincode,latitude:s.latitude?parseFloat(s.latitude):null,longitude:s.longitude?parseFloat(s.longitude):null});if(m.data.success){n({type:"success",text:"Profile updated successfully!"});const z={...t,...m.data.user};localStorage.setItem(qt,JSON.stringify(z)),l&&l(z)}else n({type:"error",text:m.data.message||"Update failed"})}catch(m){console.error("Profile update error:",m),n({type:"error",text:((P=(g=m.response)==null?void 0:g.data)==null?void 0:P.message)||"Failed to update profile"})}finally{c(!1)}},_=()=>{s.latitude&&s.longitude&&window.open(`https://www.google.com/maps?q=${s.latitude},${s.longitude}`,"_blank")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Host Settings"}),e.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Update your place details and contact information"})]}),u.text&&e.jsx("div",{className:`rounded-lg p-3 text-sm ${u.type==="success"?"border border-emerald-200 bg-emerald-50 text-emerald-700":u.type==="error"?"border border-red-200 bg-red-50 text-red-700":"border border-blue-200 bg-blue-50 text-blue-700"}`,children:u.text}),e.jsxs("form",{onSubmit:v,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Place Name"}),e.jsx("input",{type:"text",name:"place_name",value:s.place_name,onChange:x,placeholder:"e.g., Shah's Kitchen",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"This name will be shown to guests"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Primary Contact"}),e.jsx("input",{type:"tel",name:"contact",value:s.contact,onChange:x,placeholder:"+91 98765 43210",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Alternate Number"}),e.jsx("input",{type:"tel",name:"alternate_contact",value:s.alternate_contact,onChange:x,placeholder:"Optional",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Street Address"}),e.jsx("input",{type:"text",name:"street",value:s.street,onChange:x,placeholder:"Building, Street name",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Area"}),e.jsx("input",{type:"text",name:"area",value:s.area,onChange:x,placeholder:"e.g., Bandra West",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"City"}),e.jsx("input",{type:"text",name:"city",value:s.city,onChange:x,placeholder:"e.g., Mumbai",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Pincode"}),e.jsx("input",{type:"text",name:"pincode",value:s.pincode,onChange:x,placeholder:"e.g., 400050",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700",children:"Location Coordinates"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Helps guests navigate to your place"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:f,className:"rounded-lg bg-emerald-50 px-3 py-1.5 text-xs font-medium text-emerald-600 transition-colors hover:bg-emerald-100",children:"üìç Use GPS"}),e.jsx("button",{type:"button",onClick:A,className:"rounded-lg bg-blue-50 px-3 py-1.5 text-xs font-medium text-blue-600 transition-colors hover:bg-blue-100",children:"üó∫Ô∏è Open Maps"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-500",children:"Latitude"}),e.jsx("input",{type:"number",name:"latitude",value:s.latitude,onChange:x,placeholder:"e.g., 19.0760",step:"0.000001",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-500",children:"Longitude"}),e.jsx("input",{type:"number",name:"longitude",value:s.longitude,onChange:x,placeholder:"e.g., 72.8777",step:"0.000001",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]})]}),s.latitude&&s.longitude&&e.jsxs("button",{type:"button",onClick:_,className:"mt-3 flex w-full items-center justify-center gap-2 rounded-xl bg-slate-50 py-2 text-sm font-medium text-slate-600 transition-colors hover:bg-slate-100",children:[e.jsxs("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"View Current Location on Map"]})]}),e.jsx("button",{type:"submit",disabled:d,className:"mt-6 w-full rounded-xl bg-emerald-600 py-3 font-bold text-white transition-all hover:bg-emerald-700 focus:ring-4 focus:ring-emerald-100 disabled:cursor-not-allowed disabled:opacity-50",children:d?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})]})]})}async function Bt(t,l){try{const o=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${t}&lon=${l}&zoom=18&addressdetails=1`,{headers:{"Accept-Language":"en"}})).json();if(o!=null&&o.address){const{road:d,suburb:c,neighbourhood:u,city:n,town:N,village:b,state_district:i,state:p,postcode:x,county:f}=o.address;return{street:d||"",area:c||u||f||"",city:n||N||b||i||"",pincode:x||"",state:p||""}}return null}catch(s){return console.error("Reverse geocoding failed:",s),null}}function Gt({user:t,onLogin:l,onNavigate:s}){const[o,d]=a.useState("REGISTER"),[c,u]=a.useState(!1),[n,N]=a.useState(""),[b,i]=a.useState(""),[p,x]=a.useState(""),[f,A]=a.useState(""),[v,_]=a.useState(""),[S,g]=a.useState(""),[P,m]=a.useState(""),[z,F]=a.useState(""),[E,L]=a.useState(""),[O,T]=a.useState(""),[X,H]=a.useState(null),[te,se]=a.useState(null),[Q,k]=a.useState(!1),[B,Z]=a.useState(["","","","","",""]),ee=a.useRef([]),r=a.useCallback(async()=>{if(navigator.geolocation){k(!0);try{const C=await new Promise((Y,re)=>{navigator.geolocation.getCurrentPosition(Y,re,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),{latitude:D,longitude:M}=C.coords;H(D),se(M);const q=await Bt(D,M);q&&(m(q.street),F(q.area),L(q.city),T(q.pincode))}catch(C){console.log("Location fetch failed:",C.message)}finally{k(!1)}}},[]);a.useEffect(()=>{t||r()},[t,r]);const R=(C,D)=>{var Y;const M=C.target.value;if(isNaN(M))return;const q=[...B];q[D]=M.slice(-1),Z(q),M&&D<5&&((Y=ee.current[D+1])==null||Y.focus())},I=(C,D)=>{var M;C.key==="Backspace"&&!B[D]&&D>0&&((M=ee.current[D-1])==null||M.focus())},ae=async C=>{var D,M;if(C.preventDefault(),N(""),p.length<6){N("Password must be at least 6 characters"),h.error("Validation Error",{description:"Password must be at least 6 characters"});return}u(!0);try{const q=await J.register({email:b,password:p,name:f,contact:v,role:"provider",place_name:S,street:P,area:z,city:E,pincode:O,latitude:X,longitude:te});if(q.success)h.success("OTP Sent!",{description:"Please check your email for the verification code"}),Z(["","","","","",""]),d("OTP");else{const Y=q.message||"Registration failed";N(Y),h.error("Registration Failed",{description:Y})}}catch(q){const Y=q.message||((M=(D=q.errors)==null?void 0:D.email)==null?void 0:M[0])||"Registration failed. Please try again.";N(Y),h.error("Registration Failed",{description:Y})}finally{u(!1)}},W=async()=>{const C=B.join("");if(!(C.length<6)){N(""),u(!0);try{const D=await J.verifyRegistrationOtp(b,C);if(D.success)D.token&&ke.set("auth_token",D.token),h.success("Account Verified!",{description:"Welcome to Ramzania!"}),l&&l(D.user);else{const M=D.message||"Invalid OTP";N(M),h.error("Verification Failed",{description:M})}}catch(D){const M=D.message||"OTP verification failed. Please try again.";N(M),h.error("Verification Failed",{description:M})}finally{u(!1)}}},ge=async()=>{u(!0),N("");try{const C=await J.resendRegistrationOtp(b);C.success?(h.success("OTP Resent!",{description:"Please check your email for the new code"}),Z(["","","","","",""])):(N(C.message||"Failed to resend OTP"),h.error("Failed",{description:C.message}))}catch{N("Failed to resend OTP. Please try again."),h.error("Failed",{description:"Failed to resend OTP"})}finally{u(!1)}},K="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-2.5 text-sm font-medium text-slate-800 placeholder-slate-400 outline-none transition-all focus:border-emerald-500 focus:bg-white focus:ring-1 focus:ring-emerald-500";return(t==null?void 0:t.role)==="provider"?e.jsx("div",{className:"pb-8",children:e.jsxs("div",{className:"rounded-2xl border border-emerald-200 bg-emerald-50 p-6 text-center",children:[e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-emerald-100",children:e.jsx(Ne,{size:28,className:"text-emerald-600"})})}),e.jsx("h2",{className:"mb-2 text-xl font-black text-emerald-700",children:"You're Already a Host!"}),e.jsx("p",{className:"mb-4 text-sm text-slate-600",children:"You're registered as a provider. Go to your dashboard to manage your Sehri offerings."}),e.jsx("button",{onClick:()=>s("dashboard"),className:"rounded-xl bg-emerald-600 px-6 py-2.5 font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:"Go to Dashboard"})]})}):o==="OTP"?e.jsxs("div",{className:"pb-8",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("div",{className:"mb-3 flex justify-center",children:e.jsx("div",{className:"rounded-full border border-emerald-200 bg-emerald-50 p-3",children:e.jsx(Ne,{size:28,className:"text-emerald-600"})})}),e.jsx("h1",{className:"mb-2 text-xl font-black text-emerald-700",children:"Verify Your Email"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Enter the 6-digit code sent to ",e.jsx("span",{className:"font-bold text-slate-700",children:b})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[n&&e.jsx("p",{className:"mb-4 rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:n}),e.jsx("div",{className:"mb-6 flex justify-between gap-2",children:B.map((C,D)=>e.jsx("input",{ref:M=>ee.current[D]=M,type:"text",inputMode:"numeric",maxLength:1,className:"h-12 w-full rounded-xl border border-slate-200 bg-slate-50 text-center text-lg font-bold transition-all outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500",value:C,onChange:M=>R(M,D),onKeyDown:M=>I(M,D)},D))}),e.jsx("button",{onClick:W,disabled:c||B.join("").length<6,className:"mb-3 w-full rounded-xl bg-emerald-600 py-3 font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:bg-emerald-400",children:c?e.jsx(G,{className:"mx-auto animate-spin",size:20}):"Verify & Create Account"}),e.jsx("button",{onClick:ge,disabled:c,className:"w-full text-center text-xs font-bold text-slate-400 uppercase hover:text-emerald-600",children:"Resend Code"}),e.jsx("button",{onClick:()=>d("REGISTER"),className:"mt-4 w-full text-center text-xs font-medium text-slate-400 hover:text-slate-600",children:"Back to Registration"})]})]}):e.jsxs("div",{className:"pb-8",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("div",{className:"mb-3 flex justify-center",children:e.jsx("div",{className:"rounded-full border border-emerald-200 bg-emerald-50 p-3",children:e.jsx(Ne,{size:28,className:"text-emerald-600"})})}),e.jsx("h1",{className:"mb-2 text-xl font-black text-emerald-700",children:"Register as Host"}),e.jsx("p",{className:"mx-auto max-w-sm text-sm text-slate-500",children:"Create your host account to start offering Sehri to the community this Ramadan."})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"mb-4 rounded-xl bg-emerald-50 px-4 py-3",children:[e.jsx("p",{className:"text-xs font-bold text-emerald-700",children:" Host Account"}),e.jsx("p",{className:"text-xs text-emerald-600",children:"Arrange Sehri for guests in your area"})]}),n&&e.jsx("p",{className:"mb-4 rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:n}),e.jsxs("form",{onSubmit:ae,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Email Address *"}),e.jsx("input",{type:"email",required:!0,placeholder:"your@email.com",className:K,value:b,onChange:C=>i(C.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Password *"}),e.jsx("input",{type:"password",required:!0,placeholder:"Min 6 characters",className:K,value:p,onChange:C=>x(C.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Full Name *"}),e.jsx("input",{type:"text",required:!0,placeholder:"Your name",className:K,value:f,onChange:C=>A(C.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Contact *"}),e.jsx("input",{type:"tel",required:!0,placeholder:"+91 XXXXX",className:K,value:v,onChange:C=>_(C.target.value)})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:["Place Name * ",e.jsx("span",{className:"font-normal text-slate-400",children:"(Masjid, Restaurant, etc.)"})]}),e.jsx("input",{type:"text",required:!0,placeholder:"e.g., Masjid-e-Khair",className:K,value:S,onChange:C=>g(C.target.value)})]})]}),e.jsxs("div",{className:"space-y-2 border-t border-slate-100 pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500",children:"Address Details"}),Q&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(G,{size:10,className:"animate-spin"}),"Fetching location..."]}),!Q&&E&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(oe,{size:10}),"Auto-filled"]})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Street / Door No",className:K,value:P,onChange:C=>m(C.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Area / Locality",className:K,value:z,onChange:C=>F(C.target.value)}),e.jsx("input",{type:"text",required:!0,placeholder:"City",className:K,value:E,onChange:C=>L(C.target.value)})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Pincode",className:K,value:O,onChange:C=>T(C.target.value)})]}),e.jsx("button",{type:"submit",disabled:c,className:"w-full rounded-xl bg-emerald-600 py-3 font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:bg-emerald-400",children:c?e.jsx(G,{className:"mx-auto animate-spin",size:20}):"Create Host Account "}),e.jsxs("p",{className:"text-center text-xs text-slate-400",children:["Already have an account?"," ",e.jsx("button",{type:"button",onClick:()=>s("find"),className:"font-bold text-emerald-600 hover:underline",children:"Sign In from Navbar"})]})]})]})]})}const Ht=()=>e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 002-2V2M7 2v20M21 15V2v0a5 5 0 00-5 5v6c0 1.1.9 2 2 2h3zm0 0v7"})}),Vt=()=>e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"})});function Ut({ramzanTiming:t,onNavigate:l,city:s="Chennai"}){const[o,d]=a.useState({hours:0,minutes:0}),[c,u]=a.useState([]);a.useEffect(()=>{if(t!=null&&t.sehar_time&&(t!=null&&t.iftar_time)){const[b,i]=t.sehar_time.split(":").map(Number),[p,x]=t.iftar_time.split(":").map(Number);let f=p*60+x-(b*60+i);f<0&&(f+=1440),d({hours:Math.floor(f/60),minutes:f%60})}},[t]),a.useEffect(()=>{if(t){const b=new Date("2026-02-19"),p=Math.max(1,Math.ceil((new Date-b)/(1e3*60*60*24))+1),x=[];for(let f=0;f<3;f++){const A=new Date(b);A.setDate(b.getDate()+p-1+f),x.push({date:A.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),sehri:t.sehar_time,iftar:t.iftar_time,day:p+f})}u(x)}},[t]);const n=b=>{if(!b)return"--:--";const[i,p]=b.split(":"),x=parseInt(i);return`${x>12?x-12:x}:${p} ${x>=12?"PM":"AM"}`},N=()=>t!=null&&t.ramzan_day?`${t.ramzan_day} Ramadan 1447 AH`:"Sha'ban 1447 AH";return e.jsxs("div",{className:"pb-8",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-emerald-600 to-emerald-700 px-6 py-8 text-white shadow-lg shadow-emerald-100",children:[e.jsx("div",{className:"absolute top-0 right-0 h-64 w-64 rounded-full bg-white/5 blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 h-48 w-48 rounded-full bg-white/5 blur-3xl"}),e.jsxs("div",{className:"relative z-10 mb-4 inline-flex items-center gap-2 rounded-full bg-white/20 px-3 py-1",children:[e.jsx(ot,{size:12,className:"fill-yellow-300 text-yellow-300"}),e.jsx("span",{className:"text-xs font-bold",children:"Ramadan 2026"})]}),e.jsxs("h1",{className:"relative z-10 mb-3 text-2xl leading-tight font-black sm:text-3xl",children:["Community Sehri",e.jsx("br",{}),"Distribution"]}),e.jsxs("p",{className:"relative z-10 mb-6 max-w-sm text-sm text-emerald-100",children:["Connecting those in need with generous providers across ",s,". Find a nearby Sehri location."]}),e.jsxs("div",{className:"relative z-10 flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>l("find"),className:"flex items-center gap-2 rounded-xl bg-white px-5 py-2.5 font-bold text-emerald-700 transition-all hover:bg-emerald-50 active:scale-95",children:[e.jsx(Ht,{}),"Find Sehri"]}),e.jsxs("button",{onClick:()=>l("request"),className:"flex items-center gap-2 rounded-xl border-2 border-white/40 bg-transparent px-5 py-2.5 font-bold text-white transition-all hover:bg-white/10 active:scale-95",children:[e.jsx(Vt,{}),"Request Support"]})]})]}),e.jsxs("div",{className:"mt-6 rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"mb-1 text-xs font-medium text-slate-400",children:"Sehri"}),e.jsx("p",{className:"text-lg font-black text-emerald-600",children:n(t==null?void 0:t.sehar_time)})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"mb-1 text-[10px] font-bold tracking-wider text-slate-400 uppercase",children:"Roza Duration"}),e.jsxs("p",{className:"text-xl font-black text-slate-800",children:[o.hours,"h ",o.minutes,"m"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"mb-1 text-xs font-medium text-slate-400",children:"Iftar"}),e.jsx("p",{className:"text-lg font-black text-emerald-600",children:n(t==null?void 0:t.iftar_time)})]})]}),e.jsx("p",{className:"mt-3 border-t border-slate-100 pt-3 text-center text-xs text-slate-400",children:N()})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[e.jsx(ue,{size:14,className:"text-emerald-600"}),e.jsx("h3",{className:"text-sm font-bold text-slate-700",children:"Next 3 Days"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:c.map((b,i)=>e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-emerald-50/50 p-3 text-center",children:[e.jsx("p",{className:"mb-2 text-xs font-medium text-slate-500",children:b.date}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] text-slate-400 uppercase",children:"Sehri"}),e.jsx("p",{className:"text-sm font-bold text-emerald-600",children:n(b.sehri)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] text-slate-400 uppercase",children:"Iftar"}),e.jsx("p",{className:"text-sm font-bold text-emerald-600",children:n(b.iftar)})]})]})]},i))})]}),e.jsxs("div",{className:"mt-6 rounded-2xl border border-slate-200 bg-white p-5",children:[e.jsx("p",{className:"mb-1 text-xs text-slate-400",children:"Ramzania is an initiative of"}),e.jsx("h3",{className:"mb-3 text-base font-black text-emerald-600",children:"Community Volunteers"}),e.jsx("h4",{className:"mb-2 text-sm font-bold text-slate-700",children:"Our Mission & Purpose"}),e.jsx("p",{className:"text-sm leading-relaxed text-slate-500",children:"Ramadan is a month of giving and community. While Iftar is often a communal affair, Sehri (the pre-dawn meal) can be challenging for students, travelers, and those living in hostels or PG accommodations."})]}),e.jsxs("div",{className:"mt-6 rounded-2xl border border-emerald-200 bg-emerald-50 p-5 text-center",children:[e.jsx("h3",{className:"mb-2 text-base font-bold text-slate-800",children:"Are you a provider?"}),e.jsx("p",{className:"mb-4 text-sm text-slate-500",children:"If your Masjid or organization is distributing Sehri this Ramadan, please list your details to help us guide people to you."}),e.jsx("button",{onClick:()=>l("join"),className:"rounded-xl bg-emerald-600 px-6 py-2.5 font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:"Register as Provider"})]}),e.jsx("footer",{className:"mt-8 text-center",children:e.jsx("p",{className:"text-xs text-slate-400",children:" 2026 Ramzania.com | The Last Meal Before Dawn"})})]})}function Yt(){const[t,l]=a.useState([]),[s,o]=a.useState(!0),[d,c]=a.useState(null),u=i=>{const p=["th","st","nd","rd"],x=i%100;return i+(p[(x-20)%10]||p[x]||p[0])},n=async()=>{o(!0);try{const i=await At();i.success?l(i.bookings||[]):h.error(i.message||"Failed to load bookings")}catch{h.error("Failed to load bookings")}finally{o(!1)}};a.useEffect(()=>{n()},[]);const N=async i=>{if(globalThis.confirm("Are you sure you want to cancel this booking?")){c(i);try{const p=await zt(i);p.success?(h.success("Booking cancelled"),l(x=>x.map(f=>f.id===i?{...f,status:"cancelled"}:f))):h.error(p.message||"Failed to cancel")}catch{h.error("Failed to cancel booking")}finally{c(null)}}},b=i=>{switch(i){case"confirmed":return"bg-emerald-100 text-emerald-700";case"completed":return"bg-blue-100 text-blue-700";case"cancelled":return"bg-red-100 text-red-700";default:return"bg-slate-100 text-slate-700"}};return s?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(G,{size:32,className:"animate-spin text-emerald-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-slate-900",children:"My Reservations"}),e.jsxs("p",{className:"text-xs text-slate-500",children:[t.length," Sehri reservation(s)"]})]}),e.jsx("button",{onClick:n,className:"rounded-lg bg-slate-100 p-2 text-slate-600 transition-all hover:bg-slate-200 active:scale-95",children:e.jsx(Ie,{size:16})})]}),t.length===0?e.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-16 text-center",children:[e.jsx(Me,{size:48,className:"mx-auto mb-4 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-600",children:"No Sehri reservations yet"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Browse hosts & reserve your Sehri from Home"})]}):e.jsx("div",{className:"space-y-4",children:t.map(i=>e.jsxs("div",{className:`rounded-2xl border bg-white p-4 shadow-sm ${i.status==="cancelled"?"border-slate-200 opacity-60":"border-slate-100"}`,children:[e.jsxs("div",{className:"mb-3 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-black text-slate-900",children:i.provider_name}),e.jsxs("div",{className:"mt-1 flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(oe,{size:12}),i.area]})]}),e.jsx("span",{className:`rounded-lg px-2 py-1 text-[10px] font-bold uppercase ${b(i.status)}`,children:i.status})]}),e.jsxs("div",{className:"rounded-xl bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 font-bold text-emerald-700",children:[u(i.ramzan_day)," Ramzan"]}),e.jsxs("span",{className:"flex items-center gap-1 text-slate-500",children:[e.jsx(ue,{size:12}),i.formatted_date]}),e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5 text-[10px] font-bold text-slate-600",children:i.meal_type})]}),i.timing&&e.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-slate-500",children:[e.jsx(me,{size:12}),i.timing]}),e.jsxs("p",{className:"mt-2 text-xs text-slate-500 italic",children:['"',i.menu_items,'"']})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-600",children:[e.jsxs("span",{className:"font-bold",children:["üë• ",i.quantity," person(s)"]}),e.jsx("span",{className:"font-bold",children:i.price_type==="free"||i.total_amount===0?"üÜì Free":`üí∞ ‚Çπ${i.total_amount}`})]}),e.jsx("span",{className:"rounded bg-slate-100 px-2 py-1 font-mono text-[10px] text-slate-500",children:i.booking_code})]}),i.status==="confirmed"&&e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs("a",{href:`tel:${i.provider_phone}`,className:"flex flex-1 items-center justify-center gap-1.5 rounded-xl border border-slate-200 bg-white py-2 text-xs font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-95",children:[e.jsx(Ae,{size:14})," Call Host"]}),e.jsxs("button",{onClick:()=>N(i.id),disabled:d===i.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-xs font-bold text-red-600 transition-all hover:bg-red-100 active:scale-95 disabled:opacity-50",children:[d===i.id?e.jsx(G,{size:14,className:"animate-spin"}):e.jsx(ne,{size:14}),"Cancel"]})]}),e.jsxs("p",{className:"mt-3 text-[10px] text-slate-400",children:["Booked on ",i.booked_at]})]},i.id))})]})}const de={LIST:"/offerings",CREATE:"/offerings",BULK_CREATE:"/offerings/bulk",UPDATE:t=>`/offerings/${t}`,DELETE:t=>`/offerings/${t}`,STATS:"/offerings/stats"},xe={getAll:async()=>U.get(de.LIST),create:async t=>U.post(de.CREATE,t),bulkCreate:async t=>U.post(de.BULK_CREATE,{offerings:t}),update:async(t,l)=>U.put(de.UPDATE(t),l),delete:async t=>U.delete(de.DELETE(t)),getStats:async()=>U.get(de.STATS)},ye=30,Xt=new Date("2026-02-19"),Kt=()=>Array.from({length:ye},(t,l)=>{const s=l+1,o=new Date(Xt);return o.setDate(o.getDate()+l),{day:s,date:o,dateStr:o.toLocaleDateString("en-IN",{day:"numeric",month:"short"}),fullDate:o.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})}}),Ce=Kt();function Wt({onClose:t,onSave:l,editingPoint:s,loading:o}){var H,te,se,Q;const[d,c]=a.useState("single"),[u,n]=a.useState(s?[s.ramzan_day]:[1]),[N]=a.useState("sehar"),[b,i]=a.useState((s==null?void 0:s.menu_items)||""),[p,x]=a.useState(((H=s==null?void 0:s.capacity)==null?void 0:H.toString())||"50"),[f,A]=a.useState((s==null?void 0:s.price_type)||"free"),[v,_]=a.useState(((te=s==null?void 0:s.price_amount)==null?void 0:te.toString())||""),[S,g]=a.useState(((se=s==null?void 0:s.timing_from)==null?void 0:se.slice(0,5))||"04:00"),[P,m]=a.useState(((Q=s==null?void 0:s.timing_to)==null?void 0:Q.slice(0,5))||"05:30"),[z,F]=a.useState((s==null?void 0:s.message)||""),E="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",L="w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",O=k=>{n(d==="single"?[k]:B=>B.includes(k)?B.filter(Z=>Z!==k):[...B,k])},T=()=>{u.length===ye?n([]):n(Array.from({length:ye},(k,B)=>B+1))},X=k=>{if(k.preventDefault(),u.length===0){h.error("Please select at least one day");return}if(!b.trim()){h.error("Please enter menu items");return}const B={meal_type:N,menu_items:b.trim(),capacity:Number.parseInt(p)||50,price_type:f,price_amount:f==="paid"?Number.parseFloat(v)||0:null,timing_from:S,timing_to:P,message:z.trim()||null};if(s)l({...B,id:s.id});else if(d==="single")l({...B,ramzan_day:u[0]});else{const Z=u.map(ee=>({...B,ramzan_day:ee}));l({bulk:!0,offerings:Z})}};return e.jsx("div",{className:"fixed inset-0 z-100 flex items-start justify-center overflow-y-auto bg-slate-900/40 px-4 pt-4 pb-24 backdrop-blur-sm sm:items-center sm:pb-4",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-4 sm:slide-in-from-bottom-0 sm:zoom-in-95 w-full max-w-lg rounded-2xl bg-white p-6 shadow-xl sm:my-auto",children:[e.jsxs("div",{className:"mb-5 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-black text-slate-900",children:[s?"Edit":"Add"," Sehar Offering"]}),e.jsx("button",{onClick:t,className:"rounded-full p-1.5 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(ne,{size:18})})]}),e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[!s&&e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{type:"button",onClick:()=>{c("single"),n([1])},className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${d==="single"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Single Day"}),e.jsx("button",{type:"button",onClick:()=>c("bulk"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${d==="bulk"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Multiple Days"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsxs("label",{className:"block text-xs font-bold text-slate-500",children:[e.jsx(ue,{size:12,className:"mr-1 inline"}),d==="single"?"Select Ramzan Day":"Select Days"]}),d==="bulk"&&!s&&e.jsx("button",{type:"button",onClick:T,className:"text-[10px] font-bold text-emerald-600 hover:underline",children:u.length===ye?"Deselect All":"Select All"})]}),d==="single"||s?e.jsx("select",{value:u[0],onChange:k=>n([Number.parseInt(k.target.value)]),className:E,disabled:!!s,children:Ce.map(k=>e.jsxs("option",{value:k.day,children:["Day ",k.day," - ",k.fullDate]},k.day))}):e.jsx("div",{className:"grid max-h-32 grid-cols-5 gap-1.5 overflow-y-auto rounded-xl border border-slate-200 bg-slate-50 p-2",children:Ce.map(k=>e.jsx("button",{type:"button",onClick:()=>O(k.day),className:`rounded-lg px-2 py-1.5 text-[10px] font-bold transition-all ${u.includes(k.day)?"bg-emerald-600 text-white":"bg-white text-slate-600 hover:bg-emerald-50"}`,children:k.day},k.day))}),d==="bulk"&&u.length>0&&e.jsxs("p",{className:"mt-1 text-[10px] text-emerald-600",children:[u.length," days selected"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(ve,{size:12,className:"mr-1 inline"}),"Meal Type"]}),e.jsx("div",{className:"rounded-xl border border-slate-200 bg-emerald-50 px-4 py-3 text-sm font-bold text-emerald-700",children:"Sehar (Pre-dawn meal)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Menu Items *"}),e.jsx("textarea",{required:!0,placeholder:"e.g., Biryani, Kheer, Dates, Rooh Afza, Chai...",className:E+" resize-none",rows:2,value:b,onChange:k=>i(k.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(pe,{size:12,className:"mr-1 inline"}),"Capacity *"]}),e.jsx("input",{type:"number",required:!0,min:"1",max:"10000",placeholder:"No. of people",className:L,value:p,onChange:k=>x(k.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(xt,{size:12,className:"mr-1 inline"}),"Price Type"]}),e.jsxs("select",{value:f,onChange:k=>A(k.target.value),className:L,children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"paid",children:"Paid"})]})]})]}),f==="paid"&&e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Amount per person (‚Çπ)"}),e.jsx("input",{type:"number",required:!0,min:"1",placeholder:"Enter amount",className:L,value:v,onChange:k=>_(k.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(me,{size:12,className:"mr-1 inline"}),"Service Timings"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"time",className:L,value:S,onChange:k=>g(k.target.value)}),e.jsx("input",{type:"time",className:L,value:P,onChange:k=>m(k.target.value)})]}),e.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"From - To (e.g., 4:00 AM - 5:30 AM)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(mt,{size:12,className:"mr-1 inline"}),"Additional Message (Optional)"]}),e.jsx("textarea",{placeholder:"Any special instructions or notes...",className:E+" resize-none",rows:2,value:z,onChange:k=>F(k.target.value)})]}),e.jsx("button",{type:"submit",disabled:o,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",children:o?e.jsxs(e.Fragment,{children:[e.jsx(G,{size:16,className:"animate-spin"}),"Saving..."]}):s?"Update Offering":d==="bulk"?`Add ${u.length} Offering${u.length>1?"s":""}`:"Add Offering"})]})]})})}function Jt({user:t}){const[l,s]=a.useState("offerings"),[o,d]=a.useState(!1),[c,u]=a.useState(null),[n,N]=a.useState([]),[b,i]=a.useState([]),[p,x]=a.useState({total:0,confirmed:0,completed:0,cancelled:0}),[f,A]=a.useState("all"),[v,_]=a.useState(!1),[S,g]=a.useState(!1),[P,m]=a.useState(!1),[z,F]=a.useState(null),[E,L]=a.useState({total_offerings:0,total_capacity:0,total_booked:0});a.useEffect(()=>{O(),T(),X()},[]),a.useEffect(()=>{X()},[f]);const O=async()=>{_(!0);try{const r=await xe.getAll();r.success&&N(r.offerings||[])}catch{h.error("Failed to load offerings")}finally{_(!1)}},T=async()=>{try{const r=await xe.getStats();r.success&&L(r.stats)}catch(r){console.error("Failed to load stats",r)}},X=async()=>{g(!0);try{const r=await Pt(f);r.success&&(i(r.bookings||[]),r.stats&&x(r.stats))}catch{h.error("Failed to load bookings")}finally{g(!1)}},H=async(r,R)=>{F(r);try{const I=await Ft(r,R);I.success?(h.success("Status updated"),i(ae=>ae.map(W=>W.id===r?{...W,status:R}:W)),await X(),await T()):h.error(I.message||"Failed to update status")}catch{h.error("Failed to update status")}finally{F(null)}},te=E.total_offerings||n.length,se=p.total||0,Q=p.confirmed||0,k=async r=>{m(!0);try{if(r.bulk){const R=await xe.bulkCreate(r.offerings);R.success?(h.success(`${R.created_count} offerings created successfully!`),await O(),await T(),d(!1)):h.error(R.message||"Failed to create offerings")}else if(r.id){const R=await xe.update(r.id,r);R.success?(h.success("Offering updated successfully"),await O(),await T(),d(!1)):h.error(R.message||"Failed to update offering")}else{const R=await xe.create(r);R.success?(h.success("Offering created successfully"),await O(),await T(),d(!1)):h.error(R.message||"Failed to create offering")}}catch(R){h.error(R.message||"An error occurred")}finally{m(!1),u(null)}},B=async r=>{if(window.confirm("Delete this food offering?"))try{const R=await xe.delete(r);R.success?(h.success("Offering deleted"),await O(),await T()):h.error(R.message||"Failed to delete")}catch{h.error("Failed to delete offering")}},Z=r=>{switch(r){case"confirmed":return"bg-emerald-50 text-emerald-600";case"completed":return"bg-blue-50 text-blue-600";case"cancelled":return"bg-red-50 text-red-500";default:return"bg-slate-100 text-slate-500"}},ee=r=>{const R=["th","st","nd","rd"],I=r%100;return r+(R[(I-20)%10]||R[I]||R[0])};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-slate-900",children:"Host Dashboard"}),e.jsx("p",{className:"text-xs font-medium text-slate-500",children:(t==null?void 0:t.place_name)||"Manage your Sehri distribution"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"rounded-xl bg-emerald-50 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-emerald-600",children:te}),e.jsx("p",{className:"text-[10px] font-bold text-emerald-700 uppercase",children:"Offerings"})]}),e.jsxs("div",{className:"rounded-xl bg-slate-100 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-slate-700",children:se}),e.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:"Bookings"})]}),e.jsxs("div",{className:"rounded-xl bg-blue-50 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-blue-600",children:Q}),e.jsx("p",{className:"text-[10px] font-bold text-blue-700 uppercase",children:"Confirmed"})]})]}),e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{onClick:()=>s("offerings"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${l==="offerings"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Food Offerings"}),e.jsx("button",{onClick:()=>s("bookings"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${l==="bookings"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Bookings"})]}),l==="offerings"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-bold text-slate-700",children:"My Offerings"}),e.jsxs("button",{onClick:()=>{u(null),d(!0)},className:"flex items-center gap-1.5 rounded-lg bg-emerald-600 px-3 py-2 text-xs font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:[e.jsx($e,{size:14}),"Add Day"]})]}),v?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(G,{size:24,className:"animate-spin text-emerald-600"})}):e.jsx("div",{className:"space-y-3",children:n.length>0?n.sort((r,R)=>r.ramzan_day-R.ramzan_day).map(r=>{var I,ae;const R=Ce.find(W=>W.day===r.ramzan_day);return e.jsxs("div",{className:"rounded-xl border border-slate-100 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 text-xs font-black text-emerald-700",children:[ee(r.ramzan_day)," Ramzan"]}),e.jsx("span",{className:"text-[10px] text-slate-400",children:R==null?void 0:R.fullDate}),e.jsx("span",{className:"rounded bg-slate-100 px-1.5 py-0.5 text-[9px] font-bold text-slate-600 uppercase",children:r.meal_type})]}),e.jsx("span",{className:`rounded-lg px-2 py-0.5 text-[9px] font-black uppercase ${r.price_type==="free"?"bg-emerald-50 text-emerald-600":"bg-amber-50 text-amber-600"}`,children:r.price_type==="free"?"Free":`‚Çπ${r.price_amount}`})]}),e.jsxs("p",{className:"mt-2 text-xs text-slate-600 italic",children:['"',r.menu_items,'"']}),r.message&&e.jsxs("p",{className:"mt-1 text-[10px] text-slate-400",children:["üí¨ ",r.message]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-3 text-[10px] text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{size:10}),r.booked_count||0,"/",r.capacity]}),e.jsx("span",{className:`${(r.booked_count||0)>=r.capacity?"text-red-500":"text-emerald-600"}`,children:(r.booked_count||0)>=r.capacity?"Full":`${r.capacity-(r.booked_count||0)} left`}),r.timing_from&&r.timing_to&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(me,{size:10}),(I=r.timing_from)==null?void 0:I.slice(0,5)," - ",(ae=r.timing_to)==null?void 0:ae.slice(0,5)]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between border-t border-slate-50 pt-3",children:[e.jsx("span",{className:`rounded px-1.5 py-0.5 text-[9px] font-bold uppercase ${r.status==="active"?"bg-emerald-50 text-emerald-600":"bg-slate-100 text-slate-500"}`,children:r.status}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>{u(r),d(!0)},className:"rounded-lg p-1.5 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(it,{size:14})}),e.jsx("button",{onClick:()=>B(r.id),className:"rounded-lg p-1.5 text-slate-400 hover:bg-red-50 hover:text-red-500",children:e.jsx(ct,{size:14})})]})]})]},r.id)}):e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-12 text-center",children:[e.jsx(ve,{size:32,className:"mx-auto mb-3 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-500",children:"No offerings yet"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Add food offerings for specific Ramzan days"})]})})]}),l==="bookings"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-bold text-slate-700",children:"Manage Bookings"}),e.jsxs("button",{onClick:X,disabled:S,className:"flex items-center gap-1.5 rounded-lg bg-slate-100 px-3 py-2 text-xs font-bold text-slate-600 transition-all hover:bg-slate-200 active:scale-95 disabled:opacity-50",children:[e.jsx(Ie,{size:14,className:S?"animate-spin":""}),"Refresh"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"all",label:"All",count:p.total},{value:"confirmed",label:"Confirmed",count:p.confirmed},{value:"completed",label:"Completed",count:p.completed},{value:"cancelled",label:"Cancelled",count:p.cancelled}].map(r=>e.jsxs("button",{onClick:()=>A(r.value),className:`rounded-lg px-3 py-1.5 text-[10px] font-bold transition-all ${f===r.value?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[r.label," (",r.count||0,")"]},r.value))}),S?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(G,{size:24,className:"animate-spin text-emerald-600"})}):e.jsx("div",{className:"space-y-3",children:b.length>0?b.map(r=>{var R,I;return e.jsxs("div",{className:`rounded-xl border bg-white p-4 transition-all ${r.status==="cancelled"?"border-slate-200 opacity-70":"border-slate-100"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900",children:r.seeker_name}),e.jsxs("div",{className:"mt-1 flex flex-col gap-1 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{size:12}),e.jsx("a",{href:`tel:${r.seeker_phone}`,className:"hover:text-emerald-600",children:r.seeker_phone})]}),r.seeker_email&&e.jsx("span",{className:"text-[10px] text-slate-400",children:r.seeker_email})]})]}),e.jsx("span",{className:`rounded-lg px-2 py-1 text-[10px] font-bold uppercase ${Z(r.status)}`,children:r.status})]}),r.menu_items&&e.jsxs("p",{className:"mt-2 text-xs text-slate-500 italic",children:['"',r.menu_items,'"']}),e.jsxs("div",{className:"mt-3 rounded-lg bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 font-bold text-emerald-700",children:[ee(r.ramzan_day)," Ramzan"]}),e.jsxs("span",{className:"flex items-center gap-1 text-slate-500",children:[e.jsx(ue,{size:12}),r.formatted_date]}),e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5 text-[10px] font-bold text-slate-600 uppercase",children:r.meal_type})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs text-slate-600",children:[e.jsxs("span",{className:"flex items-center gap-1 font-bold",children:[e.jsx(pe,{size:12}),r.quantity," person(s)"]}),e.jsx("span",{className:"font-bold",children:r.total_amount>0?`‚Çπ${r.total_amount}`:"Free"}),r.timing_from&&r.timing_to&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(me,{size:12}),(R=r.timing_from)==null?void 0:R.slice(0,5)," - ",(I=r.timing_to)==null?void 0:I.slice(0,5)]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsx("span",{className:"rounded bg-slate-100 px-2 py-1 font-mono text-[10px] text-slate-500",children:r.booking_code}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:["Booked: ",new Date(r.created_at).toLocaleDateString("en-IN")]})]}),r.status==="confirmed"&&e.jsxs("div",{className:"mt-4 flex gap-2 border-t border-slate-100 pt-4",children:[e.jsxs("button",{onClick:()=>H(r.id,"completed"),disabled:z===r.id,className:"flex flex-1 items-center justify-center gap-1.5 rounded-xl bg-emerald-600 py-2 text-xs font-bold text-white transition-all hover:bg-emerald-700 active:scale-95 disabled:opacity-50",children:[z===r.id?e.jsx(G,{size:14,className:"animate-spin"}):e.jsx(ze,{size:14}),"Mark Completed"]}),e.jsxs("button",{onClick:()=>H(r.id,"cancelled"),disabled:z===r.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-xs font-bold text-red-600 transition-all hover:bg-red-100 active:scale-95 disabled:opacity-50",children:[e.jsx(dt,{size:14}),"Cancel"]})]}),r.status==="cancelled"&&e.jsx("div",{className:"mt-3 border-t border-slate-100 pt-3",children:e.jsxs("button",{onClick:()=>H(r.id,"confirmed"),disabled:z===r.id,className:"flex items-center gap-1.5 text-xs font-bold text-emerald-600 hover:text-emerald-700",children:[z===r.id?e.jsx(G,{size:12,className:"animate-spin"}):e.jsx(Le,{size:12}),"Restore Booking"]})})]},r.id)}):e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-12 text-center",children:[e.jsx(pe,{size:32,className:"mx-auto mb-3 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-500",children:f==="all"?"No bookings yet":`No ${f} bookings`}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Guest reservations will appear here"})]})})]}),o&&e.jsx(Wt,{onClose:()=>{d(!1),u(null)},onSave:k,editingPoint:c,loading:P})]})}const qe="ramzania_support_request",Zt=()=>{const t=localStorage.getItem(qe);if(!t)return!1;const{date:l}=JSON.parse(t),s=new Date().toDateString();return l===s},Qt=t=>{localStorage.setItem(qe,JSON.stringify({date:new Date().toDateString(),requestId:t}))};function es({user:t,onNavigate:l}){const[s,o]=a.useState({name:(t==null?void 0:t.name)||"",phone:(t==null?void 0:t.contact)||"",email:"",area:"",address:"",family_size:"1",days_needed:"",message:""}),[d,c]=a.useState(!1),[u,n]=a.useState(!1);a.useEffect(()=>{Zt()&&n(!0)},[]);const N=i=>{const{name:p,value:x}=i.target;o(f=>({...f,[p]:x}))},b=async i=>{var p,x;if(i.preventDefault(),!s.name||!s.phone||!s.area){h.error("Please fill all required fields");return}c(!0);try{const f=await U.post("/support-requests",{...s,user_id:(t==null?void 0:t.id)||null}),A=f.data||f;A.success||A.request_id?(Qt(A.request_id),n(!0),h.success("Request submitted!",{description:"Our volunteers will reach out soon."})):h.error("Failed to submit request",{description:A.message||"Please try again"})}catch(f){console.error("Support request error:",f),h.error("Failed to submit request",{description:((x=(p=f.response)==null?void 0:p.data)==null?void 0:x.message)||f.message||"Please try again"})}finally{c(!1)}};return u?e.jsx("div",{className:"pb-8",children:e.jsxs("div",{className:"rounded-2xl border border-emerald-200 bg-emerald-50 p-6 text-center",children:[e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-emerald-100",children:e.jsx(ze,{size:32,className:"text-emerald-600"})})}),e.jsx("h2",{className:"mb-2 text-xl font-black text-emerald-700",children:"Request Submitted!"}),e.jsx("p",{className:"mb-4 text-sm text-slate-600",children:"Thank you for reaching out. Our community volunteers will contact you soon to help with your Sehri needs."}),e.jsx("p",{className:"mb-6 text-xs text-slate-400",children:"You can submit another request tomorrow if needed."}),e.jsx("button",{onClick:()=>l("find"),className:"rounded-xl bg-emerald-600 px-6 py-2.5 font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:"Browse Sehri Providers"})]})}):e.jsxs("div",{className:"pb-8",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h1",{className:"mb-2 text-xl font-black text-emerald-700",children:"Request Sehri Support"}),e.jsxs("p",{className:"mx-auto max-w-sm text-sm text-slate-500",children:["If you don't find a Sehri provider near you in our"," ",e.jsx("button",{onClick:()=>l("find"),className:"font-bold text-emerald-600 hover:underline",children:"Find Sehri"})," ","section, please fill this form. Our community volunteers will try to reach you."]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsx("h2",{className:"mb-1 text-base font-bold text-slate-800",children:"Assistance Form"}),e.jsxs("p",{className:"mb-5 text-xs text-slate-400",children:["Fields marked with ",e.jsx("span",{className:"text-red-500",children:"*"})," are required."]}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium text-slate-600",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"name",value:s.name,onChange:N,placeholder:"Enter your name",className:"w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-2.5 text-slate-800 placeholder-slate-400 transition-all outline-none focus:border-emerald-500 focus:bg-white focus:ring-1 focus:ring-emerald-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium text-slate-600",children:["Contact Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",name:"phone",value:s.phone,onChange:N,placeholder:"+91 XXXXX XXXXX",className:"w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-2.5 text-slate-800 placeholder-slate-400 transition-all outline-none focus:border-emerald-500 focus:bg-white focus:ring-1 focus:ring-emerald-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium text-slate-600",children:["Email ",e.jsx("span",{className:"text-slate-400",children:"(Optional)"})]}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:N,placeholder:"your@email.com",className:"w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-2.5 text-slate-800 placeholder-slate-400 transition-all outline-none focus:border-emerald-500 focus:bg-white focus:ring-1 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium text-slate-600",children:["Area / Locality ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"area",value:s.area,onChange:N,placeholder:"e.g., T. Nagar, Anna Nagar",className:"w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-2.5 text-slate-800 placeholder-slate-400 transition-all outline-none focus:border-emerald-500 focus:bg-white focus:ring-1 focus:ring-emerald-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium text-slate-600",children:["Full Address ",e.jsx("span",{className:"text-slate-400",children:"(Optional)"})]}),e.jsx("textarea",{name:"address",value:s.address,onChange:N,placeholder:"Complete address for directions...",rows:2,className:"w-full resize-none rounded-xl border border-slate-200 bg-slate-50 px-4 py-2.5 text-slate-800 placeholder-slate-400 transition-all outline-none focus:border-emerald-500 focus:bg-white focus:ring-1 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-slate-600",children:"Number of People"}),e.jsxs("select",{name:"family_size",value:s.family_size,onChange:N,className:"w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-2.5 text-slate-800 transition-all outline-none focus:border-emerald-500 focus:bg-white focus:ring-1 focus:ring-emerald-500",children:[e.jsx("option",{value:"1",children:"1 Person"}),e.jsx("option",{value:"2",children:"2 People"}),e.jsx("option",{value:"3",children:"3 People"}),e.jsx("option",{value:"4",children:"4 People"}),e.jsx("option",{value:"5+",children:"5+ People"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium text-slate-600",children:["Days Needed ",e.jsx("span",{className:"text-slate-400",children:"(Optional)"})]}),e.jsx("input",{type:"text",name:"days_needed",value:s.days_needed,onChange:N,placeholder:"e.g., Entire Ramadan, or specific dates",className:"w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-2.5 text-slate-800 placeholder-slate-400 transition-all outline-none focus:border-emerald-500 focus:bg-white focus:ring-1 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium text-slate-600",children:["Additional Message ",e.jsx("span",{className:"text-slate-400",children:"(Optional)"})]}),e.jsx("textarea",{name:"message",value:s.message,onChange:N,placeholder:"Any special requirements or notes...",rows:3,className:"w-full resize-none rounded-xl border border-slate-200 bg-slate-50 px-4 py-2.5 text-slate-800 placeholder-slate-400 transition-all outline-none focus:border-emerald-500 focus:bg-white focus:ring-1 focus:ring-emerald-500"})]}),e.jsx("button",{type:"submit",disabled:d,className:"w-full rounded-xl bg-emerald-600 py-3 font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:cursor-not-allowed disabled:bg-emerald-400",children:d?"Submitting...":"Submit Request"})]})]})]})}function ts({message:t,onClose:l}){return t?e.jsxs("div",{className:"animate-in fade-in slide-in-from-top-10 fixed top-8 left-1/2 z-[200] flex -translate-x-1/2 items-center gap-3 rounded-full bg-slate-950 px-8 py-4 text-white shadow-2xl",children:[e.jsx(ze,{className:"text-emerald-400",size:18}),e.jsx("span",{className:"text-sm font-black tracking-tight",children:t}),e.jsx("button",{onClick:l,className:"text-slate-500 transition-colors hover:text-white",children:e.jsx(ne,{size:16})})]}):null}const je="ramzania_user_location";async function ss(t,l){try{const o=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${t}&lon=${l}&zoom=14&addressdetails=1`,{headers:{"Accept-Language":"en"}})).json();if(o&&o.address){const{suburb:d,neighbourhood:c,city:u,town:n,village:N,state_district:b,state:i,country:p}=o.address;return{raw:o,area:d||c||u||n||N||b||""||"Unknown Area",fullAddress:o.display_name||"",city:u||n||N||b||"",state:i||"",country:p||"",addressDetails:o.address}}return null}catch(s){return console.error("Reverse geocoding failed:",s),null}}function as(){const[t,l]=a.useState(null),[s,o]=a.useState(null),[d,c]=a.useState(!1),[u,n]=a.useState(null),[N,b]=a.useState("prompt");a.useEffect(()=>{navigator.permissions&&navigator.permissions.query({name:"geolocation"}).then(v=>{b(v.state),v.onchange=()=>{b(v.state)}})},[]),a.useEffect(()=>{const v=localStorage.getItem(je);if(v)try{const _=JSON.parse(v);_.lat&&_.lng&&l({lat:_.lat,lng:_.lng}),_.address&&o(_.address)}catch{localStorage.removeItem(je)}},[]),a.useEffect(()=>{N==="granted"&&!t&&p()},[N]);const i=a.useCallback((v,_)=>{l(v),o(_),localStorage.setItem(je,JSON.stringify({lat:v.lat,lng:v.lng,address:_,timestamp:Date.now()}))},[]),p=a.useCallback(async()=>{if(!navigator.geolocation){n("Geolocation is not supported");return}c(!0),n(null),navigator.geolocation.getCurrentPosition(async v=>{const _={lat:v.coords.latitude,lng:v.coords.longitude},S=await ss(_.lat,_.lng);i(_,S),c(!1)},v=>{v.code===v.PERMISSION_DENIED?(n("Location permission denied"),b("denied")):v.code===v.POSITION_UNAVAILABLE?n("Location unavailable"):v.code===v.TIMEOUT?n("Location request timed out"):n("Enable GPS to see distance"),c(!1)},{timeout:1e4,enableHighAccuracy:!0})},[i]),x=a.useCallback(()=>{p()},[p]),f=a.useCallback((v,_)=>{if(!t)return null;const S=6371,g=(v-t.lat)*Math.PI/180,P=(_-t.lng)*Math.PI/180,m=Math.sin(g/2)*Math.sin(g/2)+Math.cos(t.lat*Math.PI/180)*Math.cos(v*Math.PI/180)*Math.sin(P/2)*Math.sin(P/2),z=2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m));return S*z},[t]),A=a.useCallback(()=>{l(null),o(null),localStorage.removeItem(je)},[]);return{location:t,address:s,isLocating:d,error:u,permissionStatus:N,requestLocation:x,calculateDistance:f,clearLocation:A}}const ls=()=>new Date().toISOString().split("T")[0];function rs(){const[t,l]=a.useState([]),[s,o]=a.useState([]),[d,c]=a.useState([]),[u,n]=a.useState({sehar:"04:52 AM",iftar:"06:24 PM",area:"Chennai"}),[N,b]=a.useState(null),[i,p]=a.useState(!0),[x,f]=a.useState(null),[A,v]=a.useState([]),[_,S]=a.useState({area:"",place:""}),g=a.useRef(!1),P=a.useCallback(async(F={})=>{var E;try{const L=await ce.fetchPoints(F);l(L.providers||[]),v(((E=L.filters)==null?void 0:E.areas)||[])}catch(L){console.error("Failed to fetch offerings:",L)}},[]),m=a.useCallback(async(F={})=>{var E;p(!0),f(null);try{const L=await ce.fetchPoints(F);l(L.providers||[]),v(((E=L.filters)==null?void 0:E.areas)||[]),p(!1),Promise.all([ce.fetchDuas(),ce.fetchEvents(),ce.fetchTimings(),ce.fetchRamzanTimings(null,ls())]).then(([O,T,X,H])=>{o(O),c(T),n(X),H.success&&H.timing&&b(H.timing)}).catch(O=>{console.error("Failed to fetch secondary data:",O)})}catch(L){f(L.message||"Failed to fetch data"),p(!1)}},[]);a.useEffect(()=>{g.current||(g.current=!0,m())},[]);const z=a.useCallback(async F=>{S(F),await P(F)},[P]);return{points:t,duas:s,events:d,timings:u,ramzanTiming:N,loading:i,error:x,availableAreas:A,filters:_,refetch:()=>m(_),refetchWithFilters:z,setFilters:z}}const Se="ramzania_user";function ms(){const[t,l]=a.useState(null),[s,o]=a.useState(!1),[d,c]=a.useState("home"),[u,n]=a.useState(null),[N,b]=a.useState(null),{points:i,timings:p,ramzanTiming:x,availableAreas:f,refetchWithFilters:A,loading:v}=rs(),{location:_,address:S,isLocating:g,requestLocation:P}=as();a.useEffect(()=>{const O=localStorage.getItem(Se);if(O){const T=JSON.parse(O);l(T),c(T.role==="provider"?"dashboard":"home")}},[]);const m=O=>{l(O),localStorage.setItem(Se,JSON.stringify(O)),o(!1),c(O.role==="provider"?"dashboard":"home")},z=()=>{localStorage.removeItem(Se),l(null),c("home")},F=O=>{b(O),n(null)},E=O=>{c(O)},L=()=>{if((t==null?void 0:t.role)==="provider")switch(d){case"settings":return e.jsx(Tt,{user:t,onUserUpdate:m});case"dashboard":default:return e.jsx(Jt,{user:t})}switch(d){case"find":return e.jsx(It,{timings:p,ramzanTiming:x,points:i,onBook:n,availableAreas:f,onFilterChange:A,loading:v});case"request":return e.jsx(es,{user:t,onNavigate:E});case"join":return e.jsx(Gt,{user:t,onLogin:m,onNavigate:E});case"bookings":return e.jsx(Yt,{});case"home":default:return e.jsx(Ut,{ramzanTiming:x,onNavigate:E,city:(S==null?void 0:S.city)||"Chennai"})}};return e.jsxs("div",{className:"min-h-screen bg-white pb-20 font-sans text-slate-900 selection:bg-emerald-100 sm:pb-16",children:[e.jsx(gt,{user:t,onLogout:z,onJoinClick:()=>o(!0),address:S,isLocating:g,onRequestLocation:P}),e.jsx("main",{className:"mx-auto max-w-lg px-4 py-6 sm:max-w-2xl sm:px-6 sm:py-8",children:L()}),e.jsx(ft,{activeView:d,onViewChange:c,userRole:t==null?void 0:t.role,user:t}),s&&e.jsx(wt,{onClose:()=>o(!1),onSuccess:m}),u&&e.jsx($t,{point:u,user:t,userLocation:_,onClose:()=>n(null),onSuccess:F,onLoginClick:()=>{n(null),o(!0)}}),e.jsx(ts,{message:N,onClose:()=>b(null)})]})}export{ms as default};
