import{j as e}from"./vendor-ui-B2jkoGl9.js";import{L as T,j as pe,f as Ke,k as Ne,h as Ye,B as ye,g as Je,H as Ae,T as Oe,l as Ee,m as We,n as Ze,o as oe,U as fe,P as ve,p as Qe,q as Xe,r as xe,X as te,s as es,a as Fe,t as ie,u as we,v as ne,w as ss,x as Te,y as ts,S as as,z as ls,D as rs,R as De,E as Me,G as ns,I as is,J as os,K as cs}from"./vendor-other-CCHQrPD6.js";import{a as V,s as Ce,t as h,b as I}from"./index-C8s5R53M.js";import{a}from"./vendor-react-Cc-oBOCu.js";import"./vendor-recharts-LMBWezzC.js";function ds({user:s,onLogout:l,onJoinClick:r,address:n,isLocating:i,onRequestLocation:c}){return e.jsx("nav",{className:"sticky top-0 z-50 w-full border-b border-slate-100/50 bg-white/70 px-4 py-3 backdrop-blur-xl sm:px-6 sm:py-4",children:e.jsxs("div",{className:"mx-auto flex max-w-6xl items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-emerald-600 text-lg font-black text-white shadow-lg shadow-emerald-100 sm:h-10 sm:w-10 sm:rounded-2xl sm:text-xl",children:"R"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-lg leading-none font-black tracking-tighter sm:text-xl",children:["RAMZAN",e.jsx("span",{className:"text-emerald-600",children:"IA"})]}),e.jsx("button",{onClick:c,className:"mt-0.5 flex items-center gap-1 text-[9px] font-bold tracking-wide text-slate-400 transition-colors hover:text-emerald-600",children:i?e.jsxs(e.Fragment,{children:[e.jsx(T,{size:8,className:"animate-spin"}),e.jsx("span",{children:"Locating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{size:8}),e.jsx("span",{className:"max-w-[120px] truncate sm:max-w-[180px]",children:(n==null?void 0:n.city)||(n==null?void 0:n.area)||"Set Location"})]})})]})]}),e.jsx("div",{className:"flex items-center gap-3 sm:gap-4",children:s?e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsxs("div",{className:"hidden text-right sm:block",children:[e.jsx("p",{className:"text-xs font-black text-slate-900",children:s.name}),e.jsx("p",{className:"text-[10px] font-bold text-emerald-600 uppercase",children:s.role==="provider"?"HOST":"GUEST"})]}),e.jsx("button",{onClick:l,className:"flex h-9 w-9 items-center justify-center rounded-xl border border-slate-200 bg-slate-50 text-slate-400 transition-all hover:text-red-500 sm:h-10 sm:w-10 sm:rounded-2xl","aria-label":"Logout",children:e.jsx(Ke,{size:16,className:"sm:h-[18px] sm:w-[18px]"})})]}):e.jsxs("button",{onClick:r,className:"flex items-center justify-center gap-1.5 rounded-xl bg-emerald-600 px-4 py-2 text-xs font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-95 sm:gap-2 sm:rounded-2xl sm:px-5 sm:text-sm",children:[e.jsx(Ne,{size:14,className:"sm:h-4 sm:w-4"}),"Join"]})})]})})}const xs=[{id:"home",label:"Home",icon:Ae},{id:"duas",label:"Duas",icon:Ee},{id:"events",label:"Events",icon:ye}],ms=[{id:"home",label:"Home",icon:Ae},{id:"bookings",label:"Reserved",icon:Oe},{id:"duas",label:"Duas",icon:Ee},{id:"events",label:"Events",icon:ye}],us=[{id:"dashboard",label:"Dashboard",icon:Ye},{id:"events",label:"Events",icon:ye},{id:"settings",label:"Settings",icon:Je}];function hs({activeView:s,onViewChange:l,userRole:r="seeker",user:n=null}){let i;return r==="provider"?i=us:n?i=ms:i=xs,e.jsxs(e.Fragment,{children:[e.jsx("nav",{className:"fixed bottom-0 z-50 flex w-full items-center justify-around border-t border-slate-100 bg-white px-6 py-3 pb-6 shadow-[0_-10px_30px_rgba(0,0,0,0.03)] sm:hidden",children:i.map(c=>e.jsxs("button",{onClick:()=>l(c.id),className:`flex flex-col items-center gap-1 rounded-xl px-4 py-2 transition-all ${s===c.id?"bg-emerald-50 text-emerald-600":"text-slate-400 hover:text-slate-600"}`,"aria-label":c.label,children:[e.jsx(c.icon,{size:20}),e.jsx("span",{className:"text-[10px] font-bold",children:c.label})]},c.id))}),e.jsx("div",{className:"fixed bottom-6 left-1/2 z-50 hidden -translate-x-1/2 sm:block",children:e.jsx("div",{className:"flex gap-1 rounded-2xl bg-slate-950 p-1.5 text-white shadow-2xl shadow-slate-950/20",children:i.map(c=>e.jsx("button",{onClick:()=>l(c.id),className:`rounded-xl px-6 py-2.5 text-[10px] font-black tracking-wider uppercase transition-all ${s===c.id?"bg-emerald-600 text-white":"text-slate-400 hover:text-white"}`,children:c.label},c.id))})})]})}function ps({time:s,compact:l=!1}){return e.jsxs("div",{className:`group relative overflow-hidden border-none bg-emerald-600 text-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-emerald-200/40 ${l?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsx(We,{size:l?60:100,className:"absolute -top-4 -right-4 text-emerald-500/30 transition-transform duration-500 group-hover:scale-110"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("span",{className:`block font-black tracking-wider text-emerald-200 uppercase ${l?"mb-1 text-[8px]":"mb-8 text-[10px]"}`,children:"Imsak (Sehar)"}),e.jsx("h4",{className:`font-black tracking-tight ${l?"text-3xl":"text-5xl"}`,children:s}),!l&&e.jsx("p",{className:"mt-1 text-sm font-medium text-emerald-100/80",children:"Stop eating and intend to fast."})]})]})}function fs({time:s,compact:l=!1}){return e.jsxs("div",{className:`group relative overflow-hidden border-none bg-slate-950 text-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-slate-200/40 ${l?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsx(Ze,{size:l?60:100,className:"absolute -top-4 -right-4 text-slate-800/50 transition-transform duration-500 group-hover:rotate-12"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("span",{className:`block font-black tracking-wider text-slate-400 uppercase ${l?"mb-1 text-[8px]":"mb-8 text-[10px]"}`,children:"Maghrib (Iftar)"}),e.jsx("h4",{className:`font-black tracking-tight ${l?"text-3xl":"text-5xl"}`,children:s}),!l&&e.jsx("p",{className:"mt-1 text-sm font-medium text-slate-400/80",children:"Break your fast with the sun's set."})]})]})}function gs({timings:s,compact:l=!1}){return e.jsxs("div",{className:`grid grid-cols-2 ${l?"gap-3":"gap-4"}`,children:[e.jsx(ps,{time:s.sehar,compact:l}),e.jsx(fs,{time:s.iftar,compact:l})]})}function bs({point:s,onBook:l,compact:r=!1}){const n=i=>{const c=["th","st","nd","rd"],x=i%100;return i+(c[(x-20)%10]||c[x]||c[0])};return e.jsxs("div",{className:`flex flex-col border border-t-4 border-slate-100 border-t-emerald-500 bg-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-slate-200/40 ${r?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsxs("div",{className:`flex items-start justify-between ${r?"mb-2":"mb-4"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`leading-tight font-black text-slate-900 ${r?"text-base":"text-xl"}`,children:s.name}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[s.next_available_day&&e.jsxs("span",{className:"rounded-md bg-emerald-100 px-1.5 py-0.5 text-[10px] font-bold text-emerald-700",children:["Next: ",n(s.next_available_day)," Ramzan"]}),s.next_available_date&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-slate-400",children:[e.jsx(oe,{size:10}),s.next_available_date]})]})]}),e.jsx("span",{className:`rounded-lg font-black uppercase ${r?"px-1.5 py-0.5 text-[8px]":"rounded-xl px-2 py-1 text-[9px]"} ${s.price===0?"bg-emerald-50 text-emerald-600":"bg-amber-50 text-amber-600"}`,children:s.price===0?"Free":`From â‚¹${s.price}`})]}),e.jsx("div",{className:`flex-1 bg-slate-50 text-slate-600 ${r?"mb-3 rounded-xl p-3 text-xs leading-relaxed":"mb-6 rounded-2xl p-4 text-sm leading-relaxed"}`,children:e.jsxs("span",{className:"italic",children:['"',s.menu,'"']})}),e.jsxs("div",{className:"mb-3 flex flex-wrap items-center gap-2 text-[10px] text-slate-500",children:[s.total_offerings&&e.jsxs("span",{className:"flex items-center gap-1 rounded bg-emerald-50 px-1.5 py-0.5 text-emerald-600",children:[e.jsx(fe,{size:10})," ",s.total_offerings," days"]}),s.total_slots!==void 0&&e.jsxs("span",{className:"rounded bg-slate-100 px-1.5 py-0.5",children:["ðŸ‘¥ ",s.total_slots," total spots"]}),s.meal_types&&e.jsx("span",{className:"rounded bg-slate-100 px-1.5 py-0.5 uppercase",children:s.meal_types.includes(",")?"Sehar & Iftar":s.meal_types}),s.area&&e.jsxs("span",{className:"rounded bg-slate-100 px-1.5 py-0.5",children:["ðŸ“ ",s.area]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>globalThis.open(`tel:${s.phone}`),className:`flex items-center justify-center gap-1.5 rounded-xl border border-slate-200 bg-white font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-95 ${r?"px-3 py-2 text-xs":"px-6 py-3.5 text-sm"}`,children:[e.jsx(ve,{size:r?12:16})," Call"]}),e.jsxs("button",{onClick:()=>globalThis.open(`https://wa.me/${s.phone.replaceAll(/\D/g,"")}`),className:`flex items-center justify-center gap-1.5 rounded-xl border border-emerald-100 bg-white font-bold text-emerald-600 transition-all hover:bg-emerald-50 active:scale-95 ${r?"px-3 py-2 text-xs":"px-6 py-3.5 text-sm"}`,children:[e.jsx(Qe,{size:r?12:16})," Chat"]})]}),e.jsx("button",{onClick:()=>l(s),disabled:!s.isBookable,className:`flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-95 disabled:bg-emerald-300 disabled:opacity-50 ${r?"px-3 py-2 text-xs":"px-6 py-3.5 text-sm"}`,children:s.isBookable?"Reserve Sehri":"Info Only"})]})]})}function js({dua:s}){return e.jsxs("div",{className:"space-y-6 rounded-[2.5rem] border border-slate-100 bg-white p-10 shadow-sm transition-all duration-500 hover:shadow-xl hover:shadow-slate-200/40",children:[e.jsx("h4",{className:"text-[10px] font-black tracking-widest text-emerald-600 uppercase",children:s.title}),e.jsx("p",{className:"text-right text-4xl leading-[1.8] font-bold text-slate-900",dir:"rtl",children:s.arabic}),e.jsxs("div",{className:"space-y-2 border-t border-slate-50 pt-6",children:[e.jsxs("p",{className:"text-sm font-bold text-emerald-700 italic",children:['"',s.transliteration,'"']}),e.jsx("p",{className:"text-sm font-medium text-slate-400",children:s.english})]})]})}function Ns({event:s,onInterested:l}){return e.jsxs("div",{className:"flex flex-col justify-between gap-6 rounded-[2.5rem] border border-slate-100 bg-white p-6 shadow-sm transition-all duration-500 hover:shadow-xl hover:shadow-emerald-100/30 md:flex-row md:items-center",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"rounded-full bg-emerald-50 px-3 py-1 text-[10px] font-black text-emerald-600 uppercase",children:s.date}),e.jsx("span",{className:"rounded-full bg-slate-50 px-3 py-1 text-[10px] font-black text-slate-400 uppercase",children:s.time})]}),e.jsx("h3",{className:"text-2xl font-black text-slate-900",children:s.title}),e.jsxs("p",{className:"text-sm font-medium text-slate-400",children:[e.jsx(pe,{size:12,className:"mr-1 inline"})," ",s.location," â€¢ ",e.jsx(Xe,{size:12,className:"mr-1 inline"})," ",s.speaker]})]}),e.jsx("button",{onClick:()=>l==null?void 0:l(s),className:"flex items-center justify-center gap-2 rounded-2xl bg-slate-900 px-6 py-3.5 text-sm font-bold text-white transition-all hover:bg-slate-800 active:scale-95",children:"Interested"})]})}async function ys(s,l){try{const n=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${l}&zoom=18&addressdetails=1`,{headers:{"Accept-Language":"en"}})).json();if(n!=null&&n.address){const{road:i,suburb:c,neighbourhood:x,city:o,town:_,village:y,state_district:d,state:u,postcode:k,county:w}=n.address;return{street:i||"",area:c||x||w||"",city:o||_||y||d||"",pincode:k||"",state:u||""}}return null}catch(r){return console.error("Reverse geocoding failed:",r),null}}function vs({onClose:s,onSuccess:l}){const[r,n]=a.useState("CHOICE"),[i,c]=a.useState(!1),[x,o]=a.useState(""),[_,y]=a.useState(""),[d,u]=a.useState(""),[k,w]=a.useState("seeker"),[R,j]=a.useState(""),[v,A]=a.useState(""),[P,p]=a.useState(""),[z,C]=a.useState(""),[O,B]=a.useState(""),[Z,$]=a.useState(""),[D,q]=a.useState(""),[L,Q]=a.useState(""),[H,U]=a.useState(""),[K,Y]=a.useState(!1),[g,M]=a.useState(""),[t,N]=a.useState(""),[E,J]=a.useState(""),[W,ke]=a.useState(""),[ae,de]=a.useState(["","","","","",""]),[le,Se]=a.useState(""),ge=a.useRef([]),_e=a.useCallback(async()=>{if(navigator.geolocation){Y(!0);try{const m=await new Promise((F,Ue)=>{navigator.geolocation.getCurrentPosition(F,Ue,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),{latitude:f,longitude:b}=m.coords,S=await ys(f,b);S&&($(S.street),q(S.area),Q(S.city),U(S.pincode))}catch(m){console.log("Location fetch failed:",m.message)}finally{Y(!1)}}},[]);a.useEffect(()=>{r==="REGISTER"&&_e()},[r,_e]);const Pe=(m,f)=>{var F;const b=m.target.value;if(isNaN(b))return;const S=[...ae];S[f]=b.slice(-1),de(S),b&&f<5&&((F=ge.current[f+1])==null||F.focus())},Ie=(m,f)=>{var b;m.key==="Backspace"&&!ae[f]&&f>0&&((b=ge.current[f-1])==null||b.focus())},$e=async m=>{var f,b;m.preventDefault(),o(""),c(!0);try{const S=await V.login({email:_,password:d});if(S.success)S.token&&Ce.set("auth_token",S.token),h.success("Welcome back!",{description:`Logged in as ${S.user.name}`}),l(S.user);else{const F=S.message||"Login failed";o(F),h.error("Login Failed",{description:F})}}catch(S){const F=S.message||((b=(f=S.errors)==null?void 0:f.email)==null?void 0:b[0])||"Login failed. Please try again.";o(F),h.error("Login Failed",{description:F})}finally{c(!1)}},Le=async m=>{var f,b;if(m.preventDefault(),o(""),v.length<6){o("Password must be at least 6 characters"),h.error("Validation Error",{description:"Password must be at least 6 characters"});return}c(!0);try{const S=await V.register({email:R,password:v,name:P,contact:z,role:k,place_name:k==="provider"?O:null,street:Z,area:D,city:L,pincode:H});if(S.success)h.success("OTP Sent!",{description:"Please check your email for the verification code"}),Se("register"),de(["","","","","",""]),n("OTP");else{const F=S.message||"Registration failed";o(F),h.error("Registration Failed",{description:F})}}catch(S){const F=S.message||((b=(f=S.errors)==null?void 0:f.email)==null?void 0:b[0])||"Registration failed. Please try again.";o(F),h.error("Registration Failed",{description:F})}finally{c(!1)}},Be=async m=>{if(m.preventDefault(),o(""),!g){o("Please enter your email"),h.error("Email Required",{description:"Please enter your registered email address"});return}c(!0);try{const f=await V.forgotPassword(g);if(f.success)h.success("OTP Sent!",{description:"Please check your email for the reset code"}),Se("forgot"),de(["","","","","",""]),n("OTP");else{const b=f.message||"Failed to send OTP";o(b),h.error("Failed",{description:b})}}catch(f){const b=f.message||"Failed to send OTP. Please try again.";o(b),h.error("Failed",{description:b})}finally{c(!1)}},qe=async()=>{const m=ae.join("");if(!(m.length<6)){o(""),c(!0);try{if(le==="register"){const f=await V.verifyRegistrationOtp(R,m);if(f.success)f.token&&Ce.set("auth_token",f.token),h.success("Account Verified!",{description:"Welcome to Ramzania!"}),l(f.user);else{const b=f.message||"Invalid OTP";o(b),h.error("Verification Failed",{description:b})}}else if(le==="forgot"){const f=await V.verifyForgotPasswordOtp(g,m);if(f.success)h.success("OTP Verified!",{description:"Now set your new password"}),ke(f.reset_token),n("RESET_PASSWORD");else{const b=f.message||"Invalid OTP";o(b),h.error("Verification Failed",{description:b})}}}catch(f){const b=f.message||"OTP verification failed. Please try again.";o(b),h.error("Verification Failed",{description:b})}finally{c(!1)}}},Ge=async m=>{if(m.preventDefault(),o(""),t.length<6){o("Password must be at least 6 characters"),h.error("Validation Error",{description:"Password must be at least 6 characters"});return}if(t!==E){o("Passwords do not match"),h.error("Validation Error",{description:"Passwords do not match"});return}c(!0);try{const f=await V.resetPassword(g,W,t,E);if(f.success)h.success("Password Reset!",{description:"You can now login with your new password"}),n("LOGIN"),o(""),M(""),N(""),J(""),ke("");else{const b=f.message||"Password reset failed";o(b),h.error("Reset Failed",{description:b})}}catch(f){const b=f.message||"Password reset failed. Please try again.";o(b),h.error("Reset Failed",{description:b})}finally{c(!1)}},Ve=async()=>{c(!0),o("");try{let m;if(le==="register"?m=await V.resendRegistrationOtp(R):m=await V.forgotPassword(g),m.success)h.success("OTP Resent!",{description:"Please check your email for the new code"}),de(["","","","","",""]);else{const f=m.message||"Failed to resend OTP";o(f),h.error("Failed",{description:f})}}catch{const f="Failed to resend OTP. Please try again.";o(f),h.error("Failed",{description:f})}finally{c(!1)}},re="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",G="w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",X="flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 px-4 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",He={CHOICE:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-black tracking-tight text-slate-900",children:"Join Ramzania"}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Your portal to community Sehar & Iftar."}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("button",{className:X,onClick:()=>n("LOGIN"),children:"Sign In"}),e.jsx("button",{className:"flex w-full items-center justify-center gap-2 rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-[0.98]",onClick:()=>n("REGISTER"),children:"Create Account"})]})]}),LOGIN:e.jsxs("form",{onSubmit:$e,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n("CHOICE"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(xe,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Sign In"})]}),x&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:x}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"email",required:!0,placeholder:"Email address",className:re,value:_,onChange:m=>y(m.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Password",className:re,value:d,onChange:m=>u(m.target.value)})]}),e.jsx("button",{type:"submit",disabled:i,className:X,children:i?e.jsx(T,{className:"animate-spin",size:18}):"Sign In"}),e.jsx("button",{type:"button",onClick:()=>n("FORGOT"),className:"w-full text-center text-[10px] font-bold tracking-wide text-slate-400 uppercase hover:text-emerald-600",children:"Forgot Password?"})]}),REGISTER:e.jsxs("form",{onSubmit:Le,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n("CHOICE"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(xe,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Create Account"})]}),x&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:x}),e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{type:"button",onClick:()=>w("seeker"),className:`flex-1 rounded-lg py-2.5 text-xs font-bold transition-all ${k==="seeker"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"ðŸ½ï¸ Guest"}),e.jsx("button",{type:"button",onClick:()=>w("provider"),className:`flex-1 rounded-lg py-2.5 text-xs font-bold transition-all ${k==="provider"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"ðŸ  Host"})]}),e.jsx("p",{className:"text-[10px] font-medium text-slate-400",children:k==="seeker"?"Find & reserve Sehri near you":"Arrange Sehri for guests in your area"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"email",required:!0,placeholder:"Email address",className:G,value:R,onChange:m=>j(m.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Password (min 6 chars)",className:G,value:v,onChange:m=>A(m.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Full Name",className:G,value:P,onChange:m=>p(m.target.value)}),e.jsx("input",{type:"tel",required:!0,placeholder:"Contact Number",className:G,value:z,onChange:m=>C(m.target.value)})]}),k==="provider"&&e.jsx("input",{type:"text",required:!0,placeholder:"Place Name (e.g., Restaurant, Masjid,..)",className:G,value:O,onChange:m=>B(m.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500",children:"Address Details"}),K&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(T,{size:10,className:"animate-spin"}),"Fetching location..."]}),!K&&L&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(pe,{size:10}),"Auto-filled"]})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Street / Door No",className:G,value:Z,onChange:m=>$(m.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Area / Locality",className:G,value:D,onChange:m=>q(m.target.value)}),e.jsx("input",{type:"text",required:!0,placeholder:"City",className:G,value:L,onChange:m=>Q(m.target.value)})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Pincode",className:G,value:H,onChange:m=>U(m.target.value)})]}),e.jsx("button",{type:"submit",disabled:i,className:X,children:i?e.jsx(T,{className:"animate-spin",size:18}):"Continue â†’"})]}),FORGOT:e.jsxs("form",{onSubmit:Be,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n("LOGIN"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(xe,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Reset Password"})]}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Enter your email to receive a verification code."}),x&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:x}),e.jsx("input",{type:"email",required:!0,placeholder:"Registered email",className:re,value:g,onChange:m=>M(m.target.value)}),e.jsx("button",{type:"submit",disabled:i,className:X,children:i?e.jsx(T,{className:"animate-spin",size:18}):"Send OTP"})]}),OTP:e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n(le==="register"?"REGISTER":"FORGOT"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(xe,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Verify Email"})]}),e.jsxs("p",{className:"text-sm font-medium text-slate-500",children:["Enter the 6-digit code sent to ",e.jsx("span",{className:"font-bold text-slate-700",children:le==="register"?R:g})]}),x&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:x}),e.jsx("div",{className:"flex justify-between gap-2",children:ae.map((m,f)=>e.jsx("input",{ref:b=>ge.current[f]=b,type:"text",inputMode:"numeric",maxLength:1,className:"h-12 w-full rounded-xl border border-slate-200 bg-slate-50 text-center text-lg font-bold transition-all outline-none focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",value:m,onChange:b=>Pe(b,f),onKeyDown:b=>Ie(b,f)},f))}),e.jsx("button",{type:"button",onClick:qe,disabled:i||ae.join("").length<6,className:X,children:i?e.jsx(T,{className:"animate-spin",size:18}):"Verify"}),e.jsx("button",{type:"button",onClick:Ve,disabled:i,className:"w-full text-center text-[10px] font-bold tracking-wide text-slate-400 uppercase hover:text-emerald-600",children:"Resend Code"})]}),RESET_PASSWORD:e.jsxs("form",{onSubmit:Ge,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(es,{size:20,className:"text-emerald-600"}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"New Password"})]}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Create a new password for your account."}),x&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:x}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"password",required:!0,placeholder:"New Password (min 6 chars)",className:re,value:t,onChange:m=>N(m.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Confirm Password",className:re,value:E,onChange:m=>J(m.target.value)})]}),e.jsx("button",{type:"submit",disabled:i,className:X,children:i?e.jsx(T,{className:"animate-spin",size:18}):"Reset Password"})]})};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-slate-900/40 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-4 w-full max-w-md rounded-2xl border border-slate-100 bg-white p-6 shadow-xl sm:rounded-3xl sm:p-8",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-emerald-50 text-emerald-600",children:e.jsx(Ne,{size:20})}),e.jsx("button",{onClick:s,className:"rounded-full p-2 text-slate-300 transition-all hover:bg-slate-100 hover:text-slate-500",children:e.jsx(te,{size:18})})]}),He[r]]})})}const ce=s=>new Promise(l=>setTimeout(l,s)),ws=async()=>{try{const s=await I.get("/home/offerings",{auth:!1});return s.success&&s.providers?s.providers:ze()}catch(s){return console.error("Failed to fetch providers from API, using mock data:",s),ze()}},ks=async s=>{try{const l=await I.get(`/home/provider/${s}/offerings`,{auth:!1});return l.success?l:{success:!1,offerings:[]}}catch(l){return console.error("Failed to fetch provider offerings:",l),{success:!1,offerings:[]}}},Ss=async(s,l)=>I.post("/bookings",{offering_id:s,quantity:l}),_s=async()=>I.get("/bookings/my"),Cs=async s=>I.post(`/bookings/${s}/cancel`),zs=async(s="all")=>{const l=s==="all"?"/bookings/provider":`/bookings/provider?status=${s}`;return I.get(l)},Rs=async(s,l)=>I.put(`/bookings/${s}/status`,{status:l}),ze=()=>[{id:1,provider_id:1,name:"Masjid-e-Noor",area:"T. Nagar",phone:"+919000000001",price:0,isBookable:!0,total_offerings:10,total_slots:250,next_available_day:1,next_available_date:"Feb 19",meal_types:"sehar",menu:"Available for 10 days"},{id:2,provider_id:2,name:"Triplicane Big Masjid",area:"Triplicane",phone:"+919000000002",price:0,isBookable:!0,total_offerings:15,total_slots:300,next_available_day:1,next_available_date:"Feb 19",meal_types:"sehar,iftar",menu:"Available for 15 days"},{id:3,provider_id:3,name:"Ambur Private Kitchen",area:"Mount Road",phone:"+919000000003",price:120,isBookable:!0,total_offerings:5,total_slots:100,next_available_day:1,next_available_date:"Feb 19",meal_types:"sehar",menu:"Available for 5 days"}],As=async()=>(await ce(200),[{id:1,title:"Dua for Suhoor",arabic:"ÙˆÙŽØ¨ÙØµÙŽÙˆÙ’Ù…Ù ØºÙŽØ¯Ù Ù†ÙŽÙ‘ÙˆÙŽÙŠÙ’ØªÙ Ù…ÙÙ†Ù’ Ø´ÙŽÙ‡Ù’Ø±Ù Ø±ÙŽÙ…ÙŽØ¶ÙŽØ§Ù†ÙŽ",transliteration:"Wa bi-sawmi ghadinn nawaitu min shahri ramadan",english:"I intend to keep the fast for tomorrow in the month of Ramadan."},{id:2,title:"Dua for Iftar",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ Ø¥ÙÙ†ÙÙ‘ÙŠ Ù„ÙŽÙƒÙŽ ØµÙÙ…Ù’ØªÙ ÙˆÙŽØ¨ÙÙƒÙŽ Ø¢Ù…ÙŽÙ†Ù’ØªÙ ÙˆÙŽØ¹ÙŽÙ„ÙŽÙŠÙ’ÙƒÙŽ ØªÙŽÙˆÙŽÙƒÙŽÙ‘Ù„Ù’ØªÙ ÙˆÙŽØ¹ÙŽÙ„ÙŽÙ‰ Ø±ÙØ²Ù’Ù‚ÙÙƒÙŽ Ø£ÙŽÙÙ’Ø·ÙŽØ±Ù’ØªÙ",transliteration:"Allahumma inni laka sumtu, wa bika aamantu, wa 'alayka tawakkaltu, wa 'ala rizqika aftartu",english:"O Allah! I fasted for You and I believe in You and I put my trust in You and I break my fast with Your sustenance."}]),Os=async()=>(await ce(200),[{id:1,title:"Ramzan Lecture Series",location:"Anna Nagar Masjid",date:"Feb 15, 2026",time:"10:30 PM",speaker:"Shaykh Abdullah",description:"A series on the virtues of the last 10 days."},{id:2,title:"Community Iftar Meet",location:"Marina Beach",date:"Feb 12, 2026",time:"6:00 PM",speaker:"Open Event",description:"Bachelors meet-up for a shared Iftar experience."}]),Es=async(s="Chennai")=>(await ce(100),{sehar:"4:52 AM",iftar:"6:24 PM",area:s}),Fs=async(s,l)=>(await ce(1e3),{success:!0,user:{email:s,role:s.includes("admin")?"admin":"seeker",name:s.split("@")[0],token:"token-"+Date.now()}}),Ts=async(s,l)=>(await ce(500),{success:!0,bookingId:`BK-${Date.now()}`,message:"Spot booked successfully!"}),me={fetchPoints:ws,fetchDuas:As,fetchEvents:Os,fetchTimings:Es,login:Fs,bookSpot:Ts};function Ds({point:s,user:l,onClose:r,onSuccess:n,onLoginClick:i}){const[c,x]=a.useState(!0),[o,_]=a.useState([]),[y,d]=a.useState(null),[u,k]=a.useState(null),[w,R]=a.useState(1),[j,v]=a.useState(!1);a.useEffect(()=>{(async()=>{x(!0);const z=s.provider_id||s.id,C=await ks(z);C.success&&(d(C.provider),_(C.offerings||[])),x(!1)})()},[s]);const A=p=>{const z=["th","st","nd","rd"],C=p%100;return p+(z[(C-20)%10]||z[C]||z[0])},P=async()=>{if(!u){h.error("Please select a date");return}v(!0);try{const p=await Ss(u.id,w);p.success?(h.success("Spot Booked!",{description:`Booking code: ${p.booking.booking_code}`}),n==null||n(`Spot booked for ${A(u.ramzan_day)} Ramzan!`)):h.error("Booking Failed",{description:p.message})}catch(p){p.status===401?(h.error("Please login to book"),i==null||i()):h.error("Booking Failed",{description:p.message})}finally{v(!1)}};return l?e.jsx("div",{className:"fixed inset-0 z-100 flex items-end justify-center bg-slate-900/30 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-10 max-h-[90vh] w-full max-w-md overflow-hidden rounded-3xl border border-slate-100 bg-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 p-4",children:[e.jsx("h2",{className:"text-lg font-black text-slate-900",children:"Reserve Sehri"}),e.jsx("button",{onClick:r,className:"rounded-full p-2 text-slate-400 hover:bg-slate-100",children:e.jsx(te,{size:18})})]}),e.jsxs("div",{className:"bg-emerald-50 px-4 py-3",children:[e.jsx("p",{className:"font-black text-emerald-800",children:(y==null?void 0:y.name)||s.name}),e.jsx("p",{className:"text-xs text-emerald-600",children:(y==null?void 0:y.area)||s.area})]}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto p-4",children:c?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(T,{size:24,className:"animate-spin text-emerald-600"})}):o.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(fe,{size:32,className:"mx-auto mb-2 text-slate-300"}),e.jsx("p",{className:"text-sm text-slate-500",children:"No available dates"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"mb-3 text-xs font-bold text-slate-500",children:"Select a date:"}),o.map(p=>e.jsxs("button",{disabled:!p.is_bookable,onClick:()=>k(p),className:`w-full rounded-xl border p-3 text-left transition-all ${(u==null?void 0:u.id)===p.id?"border-emerald-500 bg-emerald-50 ring-2 ring-emerald-200":p.is_bookable?"border-slate-200 bg-white hover:border-emerald-300 hover:bg-emerald-50/50":"cursor-not-allowed border-slate-100 bg-slate-50 opacity-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 text-xs font-black text-emerald-700",children:A(p.ramzan_day)}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold text-slate-800",children:[p.formatted_date,e.jsxs("span",{className:"ml-1 text-[10px] font-normal text-slate-400",children:["(",p.day_name,")"]})]}),e.jsx("p",{className:"text-[10px] text-slate-500",children:p.meal_type})]})]}),e.jsxs("div",{className:"text-right",children:[(u==null?void 0:u.id)===p.id&&e.jsx(Fe,{size:16,className:"text-emerald-600"}),!u||u.id!==p.id?e.jsx("span",{className:`text-xs font-bold ${p.is_bookable?"text-emerald-600":"text-red-500"}`,children:p.is_bookable?`${p.available_slots} spots`:"Full"}):null]})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-1.5 text-[10px] text-slate-500",children:[p.timing&&e.jsxs("span",{className:"flex items-center gap-0.5 rounded bg-slate-100 px-1.5 py-0.5",children:[e.jsx(ie,{size:10})," ",p.timing]}),p.delivery_available&&e.jsxs("span",{className:"flex items-center gap-0.5 rounded bg-emerald-100 px-1.5 py-0.5 text-emerald-600",children:[e.jsx(we,{size:10})," Delivery"]}),e.jsx("span",{className:`rounded px-1.5 py-0.5 ${p.price_type==="free"?"bg-emerald-100 text-emerald-600":"bg-amber-100 text-amber-600"}`,children:p.price_type==="free"?"Free":`â‚¹${p.price_amount}`})]}),e.jsxs("p",{className:"mt-2 text-[10px] text-slate-400 italic",children:['"',p.menu_items,'"']})]},p.id))]})}),u&&e.jsxs("div",{className:"border-t border-slate-100 bg-slate-50 p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between rounded-xl bg-white p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{size:16,className:"text-slate-400"}),e.jsx("span",{className:"text-sm font-bold text-slate-700",children:"No. of Persons"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>R(p=>Math.max(1,p-1)),className:"rounded-lg bg-slate-100 p-1.5 text-slate-600 hover:bg-slate-200",children:e.jsx(ss,{size:14})}),e.jsx("span",{className:"w-6 text-center text-sm font-black text-slate-900",children:w}),e.jsx("button",{type:"button",onClick:()=>R(p=>Math.min(u.available_slots,Math.min(10,p+1))),className:"rounded-lg bg-slate-100 p-1.5 text-slate-600 hover:bg-slate-200",children:e.jsx(Te,{size:14})})]})]}),e.jsxs("div",{className:"mb-4 flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-slate-500",children:[A(u.ramzan_day)," Ramzan â€¢ ",u.meal_type]}),e.jsx("span",{className:"font-bold text-slate-900",children:u.price_type==="free"?"Free":`â‚¹${(u.price_amount||0)*w}`})]}),e.jsx("button",{onClick:P,disabled:j,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",children:j?e.jsxs(e.Fragment,{children:[e.jsx(T,{size:16,className:"animate-spin"}),"Booking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{size:16}),"Confirm Booking"]})})]})]})}):e.jsx("div",{className:"fixed inset-0 z-100 flex items-end justify-center bg-slate-900/30 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-10 w-full max-w-md rounded-3xl border border-slate-100 bg-white p-6 shadow-lg",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Book Spot"}),e.jsx("button",{onClick:r,className:"rounded-full p-2 text-slate-400 hover:bg-slate-100",children:e.jsx(te,{size:18})})]}),e.jsxs("div",{className:"mb-6 rounded-xl bg-emerald-50 p-4",children:[e.jsx("p",{className:"font-black text-emerald-800",children:s.name}),e.jsx("p",{className:"text-xs text-emerald-600",children:s.area})]}),e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:[e.jsx(Ne,{size:32,className:"mx-auto mb-3 text-slate-400"}),e.jsx("p",{className:"font-bold text-slate-700",children:"Login Required"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Please login or register to reserve Sehri"}),e.jsx("button",{onClick:()=>{r(),i==null||i()},className:"mt-4 rounded-xl bg-emerald-600 px-6 py-2.5 text-sm font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:"Login / Register"})]})]})})}function Ms({timings:s,points:l,onBook:r}){const[n,i]=a.useState(""),c=l.filter(x=>x.name.toLowerCase().includes(n.toLowerCase())||x.menu.toLowerCase().includes(n.toLowerCase()));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"mb-3 text-sm font-black tracking-tight text-slate-900",children:"Today's Timings"}),e.jsx(gs,{timings:s,compact:!0})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ts,{size:16,className:"text-emerald-600"}),e.jsx("h2",{className:"text-sm font-black tracking-tight text-slate-900",children:"Sehri Hosts"})]}),e.jsxs("span",{className:"rounded-lg bg-slate-100 px-2 py-0.5 text-xs font-bold text-slate-600",children:[c.length," nearby"]})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(as,{size:16,className:"absolute top-1/2 left-3 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search hosts...",value:n,onChange:x=>i(x.target.value),className:"w-full rounded-xl border border-slate-200 bg-white py-2.5 pr-4 pl-9 text-sm font-medium text-slate-900 placeholder:text-slate-400 focus:border-emerald-300 focus:ring-2 focus:ring-emerald-100 focus:outline-none"})]}),c.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:c.map(x=>e.jsx(bs,{point:x,onBook:r,compact:!0},x.id))}):e.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"No Sehri hosts found"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Try a different search term"})]})]})]})}const ee={LIST:"/offerings",CREATE:"/offerings",BULK_CREATE:"/offerings/bulk",UPDATE:s=>`/offerings/${s}`,DELETE:s=>`/offerings/${s}`,STATS:"/offerings/stats"},se={getAll:async()=>I.get(ee.LIST),create:async s=>I.post(ee.CREATE,s),bulkCreate:async s=>I.post(ee.BULK_CREATE,{offerings:s}),update:async(s,l)=>I.put(ee.UPDATE(s),l),delete:async s=>I.delete(ee.DELETE(s)),getStats:async()=>I.get(ee.STATS)},he=30,Ps=new Date("2026-02-19"),Is=()=>Array.from({length:he},(s,l)=>{const r=l+1,n=new Date(Ps);return n.setDate(n.getDate()+l),{day:r,date:n,dateStr:n.toLocaleDateString("en-IN",{day:"numeric",month:"short"}),fullDate:n.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})}}),je=Is();function $s({onClose:s,onSave:l,editingPoint:r,loading:n}){var H,U,K,Y;const[i,c]=a.useState("single"),[x,o]=a.useState(r?[r.ramzan_day]:[1]),[_]=a.useState("sehar"),[y,d]=a.useState((r==null?void 0:r.menu_items)||""),[u,k]=a.useState(((H=r==null?void 0:r.capacity)==null?void 0:H.toString())||"50"),[w,R]=a.useState((r==null?void 0:r.price_type)||"free"),[j,v]=a.useState(((U=r==null?void 0:r.price_amount)==null?void 0:U.toString())||""),[A,P]=a.useState((r==null?void 0:r.delivery_available)||!1),[p,z]=a.useState(((K=r==null?void 0:r.timing_from)==null?void 0:K.slice(0,5))||"04:00"),[C,O]=a.useState(((Y=r==null?void 0:r.timing_to)==null?void 0:Y.slice(0,5))||"05:30"),[B,Z]=a.useState((r==null?void 0:r.message)||""),$="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",D="w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",q=g=>{o(i==="single"?[g]:M=>M.includes(g)?M.filter(t=>t!==g):[...M,g])},L=()=>{x.length===he?o([]):o(Array.from({length:he},(g,M)=>M+1))},Q=g=>{if(g.preventDefault(),x.length===0){h.error("Please select at least one day");return}if(!y.trim()){h.error("Please enter menu items");return}const M={meal_type:_,menu_items:y.trim(),capacity:Number.parseInt(u)||50,price_type:w,price_amount:w==="paid"?Number.parseFloat(j)||0:null,delivery_available:A,timing_from:p,timing_to:C,message:B.trim()||null};if(r)l({...M,id:r.id});else if(i==="single")l({...M,ramzan_day:x[0]});else{const t=x.map(N=>({...M,ramzan_day:N}));l({bulk:!0,offerings:t})}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-slate-900/40 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-4 sm:slide-in-from-bottom-0 sm:zoom-in-95 max-h-[90vh] w-full max-w-lg overflow-y-auto rounded-2xl bg-white p-6 shadow-xl",children:[e.jsxs("div",{className:"mb-5 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-black text-slate-900",children:[r?"Edit":"Add"," Sehar Offering"]}),e.jsx("button",{onClick:s,className:"rounded-full p-1.5 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(te,{size:18})})]}),e.jsxs("form",{onSubmit:Q,className:"space-y-4",children:[!r&&e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{type:"button",onClick:()=>{c("single"),o([1])},className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${i==="single"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Single Day"}),e.jsx("button",{type:"button",onClick:()=>c("bulk"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${i==="bulk"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Multiple Days"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsxs("label",{className:"block text-xs font-bold text-slate-500",children:[e.jsx(oe,{size:12,className:"mr-1 inline"}),i==="single"?"Select Ramzan Day":"Select Days"]}),i==="bulk"&&!r&&e.jsx("button",{type:"button",onClick:L,className:"text-[10px] font-bold text-emerald-600 hover:underline",children:x.length===he?"Deselect All":"Select All"})]}),i==="single"||r?e.jsx("select",{value:x[0],onChange:g=>o([Number.parseInt(g.target.value)]),className:$,disabled:!!r,children:je.map(g=>e.jsxs("option",{value:g.day,children:["Day ",g.day," - ",g.fullDate]},g.day))}):e.jsx("div",{className:"grid max-h-32 grid-cols-5 gap-1.5 overflow-y-auto rounded-xl border border-slate-200 bg-slate-50 p-2",children:je.map(g=>e.jsx("button",{type:"button",onClick:()=>q(g.day),className:`rounded-lg px-2 py-1.5 text-[10px] font-bold transition-all ${x.includes(g.day)?"bg-emerald-600 text-white":"bg-white text-slate-600 hover:bg-emerald-50"}`,children:g.day},g.day))}),i==="bulk"&&x.length>0&&e.jsxs("p",{className:"mt-1 text-[10px] text-emerald-600",children:[x.length," days selected"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(fe,{size:12,className:"mr-1 inline"}),"Meal Type"]}),e.jsx("div",{className:"rounded-xl border border-slate-200 bg-emerald-50 px-4 py-3 text-sm font-bold text-emerald-700",children:"Sehar (Pre-dawn meal)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Menu Items *"}),e.jsx("textarea",{required:!0,placeholder:"e.g., Biryani, Kheer, Dates, Rooh Afza, Chai...",className:$+" resize-none",rows:2,value:y,onChange:g=>d(g.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(ne,{size:12,className:"mr-1 inline"}),"Capacity *"]}),e.jsx("input",{type:"number",required:!0,min:"1",max:"10000",placeholder:"No. of people",className:D,value:u,onChange:g=>k(g.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(os,{size:12,className:"mr-1 inline"}),"Price Type"]}),e.jsxs("select",{value:w,onChange:g=>R(g.target.value),className:D,children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"paid",children:"Paid"})]})]})]}),w==="paid"&&e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Amount per person (â‚¹)"}),e.jsx("input",{type:"number",required:!0,min:"1",placeholder:"Enter amount",className:D,value:j,onChange:g=>v(g.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(ie,{size:12,className:"mr-1 inline"}),"Service Timings"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"time",className:D,value:p,onChange:g=>z(g.target.value)}),e.jsx("input",{type:"time",className:D,value:C,onChange:g=>O(g.target.value)})]}),e.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"From - To (e.g., 4:00 AM - 5:30 AM)"})]}),e.jsxs("div",{className:"flex items-center gap-3 rounded-xl border border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("input",{type:"checkbox",id:"delivery",checked:A,onChange:g=>P(g.target.checked),className:"h-4 w-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-500"}),e.jsxs("label",{htmlFor:"delivery",className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[e.jsx(we,{size:16,className:"text-slate-400"}),"Delivery Available"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(cs,{size:12,className:"mr-1 inline"}),"Additional Message (Optional)"]}),e.jsx("textarea",{placeholder:"Any special instructions or notes...",className:$+" resize-none",rows:2,value:B,onChange:g=>Z(g.target.value)})]}),e.jsx("button",{type:"submit",disabled:n,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",children:n?e.jsxs(e.Fragment,{children:[e.jsx(T,{size:16,className:"animate-spin"}),"Saving..."]}):r?"Update Offering":i==="bulk"?`Add ${x.length} Offering${x.length>1?"s":""}`:"Add Offering"})]})]})})}function Ls({user:s}){const[l,r]=a.useState("offerings"),[n,i]=a.useState(!1),[c,x]=a.useState(null),[o,_]=a.useState([]),[y,d]=a.useState([]),[u,k]=a.useState({total:0,confirmed:0,completed:0,cancelled:0,no_show:0}),[w,R]=a.useState("all"),[j,v]=a.useState(!1),[A,P]=a.useState(!1),[p,z]=a.useState(!1),[C,O]=a.useState(null),[B,Z]=a.useState({total_offerings:0,total_capacity:0,total_booked:0});a.useEffect(()=>{$(),D(),q()},[]),a.useEffect(()=>{q()},[w]);const $=async()=>{v(!0);try{const t=await se.getAll();t.success&&_(t.offerings||[])}catch{h.error("Failed to load offerings")}finally{v(!1)}},D=async()=>{try{const t=await se.getStats();t.success&&Z(t.stats)}catch(t){console.error("Failed to load stats",t)}},q=async()=>{P(!0);try{const t=await zs(w);t.success&&(d(t.bookings||[]),t.stats&&k(t.stats))}catch{h.error("Failed to load bookings")}finally{P(!1)}},L=async(t,N)=>{O(t);try{const E=await Rs(t,N);E.success?(h.success("Status updated"),d(J=>J.map(W=>W.id===t?{...W,status:N}:W)),await q(),await D()):h.error(E.message||"Failed to update status")}catch{h.error("Failed to update status")}finally{O(null)}},Q=B.total_offerings||o.length,H=u.total||0,U=u.confirmed||0,K=async t=>{z(!0);try{if(t.bulk){const N=await se.bulkCreate(t.offerings);N.success?(h.success(`${N.created_count} offerings created successfully!`),await $(),await D(),i(!1)):h.error(N.message||"Failed to create offerings")}else if(t.id){const N=await se.update(t.id,t);N.success?(h.success("Offering updated successfully"),await $(),await D(),i(!1)):h.error(N.message||"Failed to update offering")}else{const N=await se.create(t);N.success?(h.success("Offering created successfully"),await $(),await D(),i(!1)):h.error(N.message||"Failed to create offering")}}catch(N){h.error(N.message||"An error occurred")}finally{z(!1),x(null)}},Y=async t=>{if(window.confirm("Delete this food offering?"))try{const N=await se.delete(t);N.success?(h.success("Offering deleted"),await $(),await D()):h.error(N.message||"Failed to delete")}catch{h.error("Failed to delete offering")}},g=t=>{switch(t){case"confirmed":return"bg-emerald-50 text-emerald-600";case"completed":return"bg-blue-50 text-blue-600";case"cancelled":return"bg-red-50 text-red-500";case"no_show":return"bg-amber-50 text-amber-600";default:return"bg-slate-100 text-slate-500"}},M=t=>{const N=["th","st","nd","rd"],E=t%100;return t+(N[(E-20)%10]||N[E]||N[0])};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-slate-900",children:"Host Dashboard"}),e.jsx("p",{className:"text-xs font-medium text-slate-500",children:(s==null?void 0:s.place_name)||"Manage your Sehri distribution"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"rounded-xl bg-emerald-50 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-emerald-600",children:Q}),e.jsx("p",{className:"text-[10px] font-bold text-emerald-700 uppercase",children:"Offerings"})]}),e.jsxs("div",{className:"rounded-xl bg-slate-100 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-slate-700",children:H}),e.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:"Bookings"})]}),e.jsxs("div",{className:"rounded-xl bg-blue-50 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-blue-600",children:U}),e.jsx("p",{className:"text-[10px] font-bold text-blue-700 uppercase",children:"Confirmed"})]})]}),e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{onClick:()=>r("offerings"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${l==="offerings"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Food Offerings"}),e.jsx("button",{onClick:()=>r("bookings"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${l==="bookings"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Bookings"})]}),l==="offerings"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-bold text-slate-700",children:"My Offerings"}),e.jsxs("button",{onClick:()=>{x(null),i(!0)},className:"flex items-center gap-1.5 rounded-lg bg-emerald-600 px-3 py-2 text-xs font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:[e.jsx(Te,{size:14}),"Add Day"]})]}),j?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(T,{size:24,className:"animate-spin text-emerald-600"})}):e.jsx("div",{className:"space-y-3",children:o.length>0?o.sort((t,N)=>t.ramzan_day-N.ramzan_day).map(t=>{var E,J;const N=je.find(W=>W.day===t.ramzan_day);return e.jsxs("div",{className:"rounded-xl border border-slate-100 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 text-xs font-black text-emerald-700",children:[M(t.ramzan_day)," Ramzan"]}),e.jsx("span",{className:"text-[10px] text-slate-400",children:N==null?void 0:N.fullDate}),e.jsx("span",{className:"rounded bg-slate-100 px-1.5 py-0.5 text-[9px] font-bold text-slate-600 uppercase",children:t.meal_type})]}),e.jsx("span",{className:`rounded-lg px-2 py-0.5 text-[9px] font-black uppercase ${t.price_type==="free"?"bg-emerald-50 text-emerald-600":"bg-amber-50 text-amber-600"}`,children:t.price_type==="free"?"Free":`â‚¹${t.price_amount}`})]}),e.jsxs("p",{className:"mt-2 text-xs text-slate-600 italic",children:['"',t.menu_items,'"']}),t.message&&e.jsxs("p",{className:"mt-1 text-[10px] text-slate-400",children:["ðŸ’¬ ",t.message]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-3 text-[10px] text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ne,{size:10}),t.booked_count||0,"/",t.capacity]}),e.jsx("span",{className:`${(t.booked_count||0)>=t.capacity?"text-red-500":"text-emerald-600"}`,children:(t.booked_count||0)>=t.capacity?"Full":`${t.capacity-(t.booked_count||0)} left`}),t.timing_from&&t.timing_to&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ie,{size:10}),(E=t.timing_from)==null?void 0:E.slice(0,5)," - ",(J=t.timing_to)==null?void 0:J.slice(0,5)]}),t.delivery_available&&e.jsxs("span",{className:"flex items-center gap-1 text-emerald-600",children:[e.jsx(we,{size:10}),"Delivery"]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between border-t border-slate-50 pt-3",children:[e.jsx("span",{className:`rounded px-1.5 py-0.5 text-[9px] font-bold uppercase ${t.status==="active"?"bg-emerald-50 text-emerald-600":"bg-slate-100 text-slate-500"}`,children:t.status}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>{x(t),i(!0)},className:"rounded-lg p-1.5 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(ls,{size:14})}),e.jsx("button",{onClick:()=>Y(t.id),className:"rounded-lg p-1.5 text-slate-400 hover:bg-red-50 hover:text-red-500",children:e.jsx(rs,{size:14})})]})]})]},t.id)}):e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-12 text-center",children:[e.jsx(fe,{size:32,className:"mx-auto mb-3 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-500",children:"No offerings yet"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Add food offerings for specific Ramzan days"})]})})]}),l==="bookings"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-bold text-slate-700",children:"Manage Bookings"}),e.jsxs("button",{onClick:q,disabled:A,className:"flex items-center gap-1.5 rounded-lg bg-slate-100 px-3 py-2 text-xs font-bold text-slate-600 transition-all hover:bg-slate-200 active:scale-95 disabled:opacity-50",children:[e.jsx(De,{size:14,className:A?"animate-spin":""}),"Refresh"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"all",label:"All",count:u.total},{value:"confirmed",label:"Confirmed",count:u.confirmed},{value:"completed",label:"Completed",count:u.completed},{value:"cancelled",label:"Cancelled",count:u.cancelled},{value:"no_show",label:"No Show",count:u.no_show}].map(t=>e.jsxs("button",{onClick:()=>R(t.value),className:`rounded-lg px-3 py-1.5 text-[10px] font-bold transition-all ${w===t.value?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[t.label," (",t.count||0,")"]},t.value))}),A?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(T,{size:24,className:"animate-spin text-emerald-600"})}):e.jsx("div",{className:"space-y-3",children:y.length>0?y.map(t=>{var N,E;return e.jsxs("div",{className:`rounded-xl border bg-white p-4 transition-all ${t.status==="cancelled"||t.status==="no_show"?"border-slate-200 opacity-70":"border-slate-100"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900",children:t.seeker_name}),e.jsxs("div",{className:"mt-1 flex flex-col gap-1 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{size:12}),e.jsx("a",{href:`tel:${t.seeker_phone}`,className:"hover:text-emerald-600",children:t.seeker_phone})]}),t.seeker_email&&e.jsx("span",{className:"text-[10px] text-slate-400",children:t.seeker_email})]})]}),e.jsx("span",{className:`rounded-lg px-2 py-1 text-[10px] font-bold uppercase ${g(t.status)}`,children:t.status})]}),t.menu_items&&e.jsxs("p",{className:"mt-2 text-xs text-slate-500 italic",children:['"',t.menu_items,'"']}),e.jsxs("div",{className:"mt-3 rounded-lg bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 font-bold text-emerald-700",children:[M(t.ramzan_day)," Ramzan"]}),e.jsxs("span",{className:"flex items-center gap-1 text-slate-500",children:[e.jsx(oe,{size:12}),t.formatted_date]}),e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5 text-[10px] font-bold text-slate-600 uppercase",children:t.meal_type})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs text-slate-600",children:[e.jsxs("span",{className:"flex items-center gap-1 font-bold",children:[e.jsx(ne,{size:12}),t.quantity," person(s)"]}),e.jsx("span",{className:"font-bold",children:t.total_amount>0?`â‚¹${t.total_amount}`:"Free"}),t.timing_from&&t.timing_to&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ie,{size:12}),(N=t.timing_from)==null?void 0:N.slice(0,5)," - ",(E=t.timing_to)==null?void 0:E.slice(0,5)]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsx("span",{className:"rounded bg-slate-100 px-2 py-1 font-mono text-[10px] text-slate-500",children:t.booking_code}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:["Booked: ",new Date(t.created_at).toLocaleDateString("en-IN")]})]}),t.status==="confirmed"&&e.jsxs("div",{className:"mt-4 flex gap-2 border-t border-slate-100 pt-4",children:[e.jsxs("button",{onClick:()=>L(t.id,"completed"),disabled:C===t.id,className:"flex flex-1 items-center justify-center gap-1.5 rounded-xl bg-emerald-600 py-2 text-xs font-bold text-white transition-all hover:bg-emerald-700 active:scale-95 disabled:opacity-50",children:[C===t.id?e.jsx(T,{size:14,className:"animate-spin"}):e.jsx(Me,{size:14}),"Mark Completed"]}),e.jsxs("button",{onClick:()=>L(t.id,"no_show"),disabled:C===t.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-amber-200 bg-amber-50 px-4 py-2 text-xs font-bold text-amber-600 transition-all hover:bg-amber-100 active:scale-95 disabled:opacity-50",children:[e.jsx(ns,{size:14}),"No Show"]}),e.jsxs("button",{onClick:()=>L(t.id,"cancelled"),disabled:C===t.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-xs font-bold text-red-600 transition-all hover:bg-red-100 active:scale-95 disabled:opacity-50",children:[e.jsx(is,{size:14}),"Cancel"]})]}),(t.status==="cancelled"||t.status==="no_show")&&e.jsx("div",{className:"mt-3 border-t border-slate-100 pt-3",children:e.jsxs("button",{onClick:()=>L(t.id,"confirmed"),disabled:C===t.id,className:"flex items-center gap-1.5 text-xs font-bold text-emerald-600 hover:text-emerald-700",children:[C===t.id?e.jsx(T,{size:12,className:"animate-spin"}):e.jsx(Fe,{size:12}),"Restore Booking"]})})]},t.id)}):e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-12 text-center",children:[e.jsx(ne,{size:32,className:"mx-auto mb-3 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-500",children:w==="all"?"No bookings yet":`No ${w} bookings`}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Guest reservations will appear here"})]})})]}),n&&e.jsx($s,{onClose:()=>{i(!1),x(null)},onSave:K,editingPoint:c,loading:p})]})}function Bs(){const[s,l]=a.useState([]),[r,n]=a.useState(!0),[i,c]=a.useState(null),x=d=>{const u=["th","st","nd","rd"],k=d%100;return d+(u[(k-20)%10]||u[k]||u[0])},o=async()=>{n(!0);try{const d=await _s();d.success?l(d.bookings||[]):h.error(d.message||"Failed to load bookings")}catch{h.error("Failed to load bookings")}finally{n(!1)}};a.useEffect(()=>{o()},[]);const _=async d=>{if(globalThis.confirm("Are you sure you want to cancel this booking?")){c(d);try{const u=await Cs(d);u.success?(h.success("Booking cancelled"),l(k=>k.map(w=>w.id===d?{...w,status:"cancelled"}:w))):h.error(u.message||"Failed to cancel")}catch{h.error("Failed to cancel booking")}finally{c(null)}}},y=d=>{switch(d){case"confirmed":return"bg-emerald-100 text-emerald-700";case"completed":return"bg-blue-100 text-blue-700";case"cancelled":return"bg-red-100 text-red-700";case"no_show":return"bg-amber-100 text-amber-700";default:return"bg-slate-100 text-slate-700"}};return r?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(T,{size:32,className:"animate-spin text-emerald-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-slate-900",children:"My Reservations"}),e.jsxs("p",{className:"text-xs text-slate-500",children:[s.length," Sehri reservation(s)"]})]}),e.jsx("button",{onClick:o,className:"rounded-lg bg-slate-100 p-2 text-slate-600 transition-all hover:bg-slate-200 active:scale-95",children:e.jsx(De,{size:16})})]}),s.length===0?e.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-16 text-center",children:[e.jsx(Oe,{size:48,className:"mx-auto mb-4 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-600",children:"No Sehri reservations yet"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Browse hosts & reserve your Sehri from Home"})]}):e.jsx("div",{className:"space-y-4",children:s.map(d=>e.jsxs("div",{className:`rounded-2xl border bg-white p-4 shadow-sm ${d.status==="cancelled"?"border-slate-200 opacity-60":"border-slate-100"}`,children:[e.jsxs("div",{className:"mb-3 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-black text-slate-900",children:d.provider_name}),e.jsxs("div",{className:"mt-1 flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(pe,{size:12}),d.area]})]}),e.jsx("span",{className:`rounded-lg px-2 py-1 text-[10px] font-bold uppercase ${y(d.status)}`,children:d.status})]}),e.jsxs("div",{className:"rounded-xl bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 font-bold text-emerald-700",children:[x(d.ramzan_day)," Ramzan"]}),e.jsxs("span",{className:"flex items-center gap-1 text-slate-500",children:[e.jsx(oe,{size:12}),d.formatted_date]}),e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5 text-[10px] font-bold text-slate-600",children:d.meal_type})]}),d.timing&&e.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-slate-500",children:[e.jsx(ie,{size:12}),d.timing]}),e.jsxs("p",{className:"mt-2 text-xs text-slate-500 italic",children:['"',d.menu_items,'"']})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-600",children:[e.jsxs("span",{className:"font-bold",children:["ðŸ‘¥ ",d.quantity," person(s)"]}),e.jsx("span",{className:"font-bold",children:d.price_type==="free"||d.total_amount===0?"ðŸ†“ Free":`ðŸ’° â‚¹${d.total_amount}`})]}),e.jsx("span",{className:"rounded bg-slate-100 px-2 py-1 font-mono text-[10px] text-slate-500",children:d.booking_code})]}),d.status==="confirmed"&&e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs("a",{href:`tel:${d.provider_phone}`,className:"flex flex-1 items-center justify-center gap-1.5 rounded-xl border border-slate-200 bg-white py-2 text-xs font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-95",children:[e.jsx(ve,{size:14})," Call Host"]}),e.jsxs("button",{onClick:()=>_(d.id),disabled:i===d.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-xs font-bold text-red-600 transition-all hover:bg-red-100 active:scale-95 disabled:opacity-50",children:[i===d.id?e.jsx(T,{size:14,className:"animate-spin"}):e.jsx(te,{size:14}),"Cancel"]})]}),e.jsxs("p",{className:"mt-3 text-[10px] text-slate-400",children:["Booked on ",d.booked_at]})]},d.id))})]})}function qs({duas:s}){return e.jsxs("div",{className:"space-y-12",children:[e.jsxs("h2",{className:"text-5xl font-black tracking-tighter text-slate-950 md:text-7xl",children:["Daily ",e.jsx("span",{className:"text-emerald-600",children:"Duas."})]}),e.jsx("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2",children:s.map(l=>e.jsx(js,{dua:l},l.id))}),s.length===0&&e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-lg font-bold text-slate-400",children:"No duas available"})})]})}function Re({events:s,onInterested:l}){return e.jsxs("div",{className:"space-y-12",children:[e.jsxs("h2",{className:"text-5xl font-black tracking-tighter text-slate-950 md:text-7xl",children:["Community ",e.jsx("span",{className:"text-emerald-600",children:"Events."})]}),e.jsx("div",{className:"space-y-4",children:s.map(r=>e.jsx(Ns,{event:r,onInterested:l},r.id))}),s.length===0&&e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("p",{className:"text-lg font-bold text-slate-400",children:"No events scheduled"}),e.jsx("p",{className:"text-sm text-slate-300",children:"Check back later for upcoming events"})]})]})}function Gs({message:s,onClose:l}){return s?e.jsxs("div",{className:"animate-in fade-in slide-in-from-top-10 fixed top-8 left-1/2 z-[200] flex -translate-x-1/2 items-center gap-3 rounded-full bg-slate-950 px-8 py-4 text-white shadow-2xl",children:[e.jsx(Me,{className:"text-emerald-400",size:18}),e.jsx("span",{className:"text-sm font-black tracking-tight",children:s}),e.jsx("button",{onClick:l,className:"text-slate-500 transition-colors hover:text-white",children:e.jsx(te,{size:16})})]}):null}const ue="ramzania_user_location";async function Vs(s,l){try{const n=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${l}&zoom=14&addressdetails=1`,{headers:{"Accept-Language":"en"}})).json();if(n&&n.address){const{suburb:i,neighbourhood:c,city:x,town:o,village:_,state_district:y,state:d,country:u}=n.address;return{raw:n,area:i||c||x||o||_||y||""||"Unknown Area",fullAddress:n.display_name||"",city:x||o||_||y||"",state:d||"",country:u||"",addressDetails:n.address}}return null}catch(r){return console.error("Reverse geocoding failed:",r),null}}function Hs(){const[s,l]=a.useState(null),[r,n]=a.useState(null),[i,c]=a.useState(!1),[x,o]=a.useState(null),[_,y]=a.useState("prompt");a.useEffect(()=>{navigator.permissions&&navigator.permissions.query({name:"geolocation"}).then(j=>{y(j.state),j.onchange=()=>{y(j.state)}})},[]),a.useEffect(()=>{const j=localStorage.getItem(ue);if(j)try{const v=JSON.parse(j);v.lat&&v.lng&&l({lat:v.lat,lng:v.lng}),v.address&&n(v.address)}catch{localStorage.removeItem(ue)}},[]),a.useEffect(()=>{_==="granted"&&!s&&u()},[_]);const d=a.useCallback((j,v)=>{l(j),n(v),localStorage.setItem(ue,JSON.stringify({lat:j.lat,lng:j.lng,address:v,timestamp:Date.now()}))},[]),u=a.useCallback(async()=>{if(!navigator.geolocation){o("Geolocation is not supported");return}c(!0),o(null),navigator.geolocation.getCurrentPosition(async j=>{const v={lat:j.coords.latitude,lng:j.coords.longitude},A=await Vs(v.lat,v.lng);d(v,A),c(!1)},j=>{j.code===j.PERMISSION_DENIED?(o("Location permission denied"),y("denied")):j.code===j.POSITION_UNAVAILABLE?o("Location unavailable"):j.code===j.TIMEOUT?o("Location request timed out"):o("Enable GPS to see distance"),c(!1)},{timeout:1e4,enableHighAccuracy:!0})},[d]),k=a.useCallback(()=>{u()},[u]),w=a.useCallback((j,v)=>{if(!s)return null;const A=6371,P=(j-s.lat)*Math.PI/180,p=(v-s.lng)*Math.PI/180,z=Math.sin(P/2)*Math.sin(P/2)+Math.cos(s.lat*Math.PI/180)*Math.cos(j*Math.PI/180)*Math.sin(p/2)*Math.sin(p/2),C=2*Math.atan2(Math.sqrt(z),Math.sqrt(1-z));return A*C},[s]),R=a.useCallback(()=>{l(null),n(null),localStorage.removeItem(ue)},[]);return{location:s,address:r,isLocating:i,error:x,permissionStatus:_,requestLocation:k,calculateDistance:w,clearLocation:R}}function Us(){const[s,l]=a.useState([]),[r,n]=a.useState([]),[i,c]=a.useState([]),[x,o]=a.useState({sehar:"04:52 AM",iftar:"06:24 PM",area:"Chennai"}),[_,y]=a.useState(!0),[d,u]=a.useState(null),k=a.useCallback(async()=>{y(!0),u(null);try{const[w,R,j,v]=await Promise.all([me.fetchPoints(),me.fetchDuas(),me.fetchEvents(),me.fetchTimings()]);l(w),n(R),c(j),o(v)}catch(w){u(w.message||"Failed to fetch data")}finally{y(!1)}},[]);return a.useEffect(()=>{k()},[k]),{points:s,duas:r,events:i,timings:x,loading:_,error:d,refetch:k}}const be="ramzania_user";function Xs(){const[s,l]=a.useState(null),[r,n]=a.useState(!1),[i,c]=a.useState("home"),[x,o]=a.useState(null),[_,y]=a.useState(null),{points:d,duas:u,events:k,timings:w}=Us(),{address:R,isLocating:j,requestLocation:v}=Hs();a.useEffect(()=>{const O=localStorage.getItem(be);if(O){const B=JSON.parse(O);l(B),c(B.role==="provider"?"dashboard":"home")}},[]);const A=O=>{l(O),localStorage.setItem(be,JSON.stringify(O)),n(!1),c(O.role==="provider"?"dashboard":"home")},P=()=>{localStorage.removeItem(be),l(null),c("home")},p=O=>{y(O),o(null)},z=O=>{y(`Marked interest for ${O.title}`)},C=()=>{if((s==null?void 0:s.role)==="provider")switch(i){case"events":return e.jsx(Re,{events:k,onInterested:z});case"settings":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-black text-slate-900",children:"Settings"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Host settings coming soon..."})]});case"dashboard":default:return e.jsx(Ls,{user:s})}switch(i){case"duas":return e.jsx(qs,{duas:u});case"events":return e.jsx(Re,{events:k,onInterested:z});case"bookings":return e.jsx(Bs,{});case"home":default:return e.jsx(Ms,{timings:w,points:d,onBook:o})}};return e.jsxs("div",{className:"min-h-screen bg-white pb-20 font-sans text-slate-900 selection:bg-emerald-100 sm:pb-16",children:[e.jsx(ds,{user:s,onLogout:P,onJoinClick:()=>n(!0),address:R,isLocating:j,onRequestLocation:v}),e.jsx("main",{className:"mx-auto max-w-lg px-4 py-6 sm:max-w-2xl sm:px-6 sm:py-8",children:C()}),e.jsx(hs,{activeView:i,onViewChange:c,userRole:s==null?void 0:s.role,user:s}),r&&e.jsx(vs,{onClose:()=>n(!1),onSuccess:A}),x&&e.jsx(Ds,{point:x,user:s,onClose:()=>o(null),onSuccess:p,onLoginClick:()=>{o(null),n(!0)}}),e.jsx(Gs,{message:_,onClose:()=>y(null)})]})}export{Xs as default};
