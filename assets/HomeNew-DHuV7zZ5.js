import{j as e}from"./vendor-ui-B2jkoGl9.js";import{h as Je,B as Ne,g as Ze,H as Oe,T as Ee,j as Pe,L as I,k as X,f as Qe,l as ve,U as Xe,m as de,n as fe,P as we,o as es,p as ss,q as ts,r as ue,X as Q,s as as,a as Me,t as re,u as ce,v as ls,w as De,x as rs,y as ns,S as is,R as $e,z as os,D as cs,E as Te,G as ds,I as xs,J as ms}from"./vendor-other-DK_X32fy.js";import{a as l}from"./vendor-react-Cc-oBOCu.js";import{a as V,s as Ae,t as f,b as q}from"./index-BeQ1iwyV.js";import"./vendor-recharts-LMBWezzC.js";const us=[{id:"home",label:"Home",icon:Oe},{id:"duas",label:"Duas",icon:Pe},{id:"events",label:"Events",icon:Ne}],hs=[{id:"home",label:"Home",icon:Oe},{id:"bookings",label:"Reserved",icon:Ee},{id:"duas",label:"Duas",icon:Pe},{id:"events",label:"Events",icon:Ne}],ps=[{id:"dashboard",label:"Dashboard",icon:Je},{id:"events",label:"Events",icon:Ne},{id:"settings",label:"Settings",icon:Ze}];function fs({activeView:s,onViewChange:a,userRole:t="seeker",user:n=null}){let o;return t==="provider"?o=ps:n?o=hs:o=us,e.jsxs(e.Fragment,{children:[e.jsx("nav",{className:"fixed bottom-0 z-50 flex w-full items-center justify-around border-t border-slate-100 bg-white px-6 py-3 pb-6 shadow-[0_-10px_30px_rgba(0,0,0,0.03)] sm:hidden",children:o.map(c=>e.jsxs("button",{onClick:()=>a(c.id),className:`flex flex-col items-center gap-1 rounded-xl px-4 py-2 transition-all ${s===c.id?"bg-emerald-50 text-emerald-600":"text-slate-400 hover:text-slate-600"}`,"aria-label":c.label,children:[e.jsx(c.icon,{size:20}),e.jsx("span",{className:"text-[10px] font-bold",children:c.label})]},c.id))}),e.jsx("div",{className:"fixed bottom-6 left-1/2 z-50 hidden -translate-x-1/2 sm:block",children:e.jsx("div",{className:"flex gap-1 rounded-2xl bg-slate-950 p-1.5 text-white shadow-2xl shadow-slate-950/20",children:o.map(c=>e.jsx("button",{onClick:()=>a(c.id),className:`rounded-xl px-6 py-2.5 text-[10px] font-black tracking-wider uppercase transition-all ${s===c.id?"bg-emerald-600 text-white":"text-slate-400 hover:text-white"}`,children:c.label},c.id))})})]})}function gs({user:s,onLogout:a,onJoinClick:t,address:n,isLocating:o,onRequestLocation:c}){return e.jsx("nav",{className:"sticky top-0 z-50 w-full border-b border-slate-100/50 bg-white/70 px-4 py-3 backdrop-blur-xl sm:px-6 sm:py-4",children:e.jsxs("div",{className:"mx-auto flex max-w-6xl items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center overflow-hidden rounded-xl bg-emerald-50 shadow-lg shadow-emerald-100 sm:h-10 sm:w-10 sm:rounded-2xl",children:e.jsx("img",{src:"/icon.svg",alt:"Ramzania",className:"h-7 w-7 sm:h-8 sm:w-8"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-lg leading-none font-black tracking-tighter sm:text-xl",children:["RAMZAN",e.jsx("span",{className:"text-emerald-600",children:"IA"})]}),e.jsx("button",{onClick:c,className:"mt-0.5 flex items-center gap-1 text-[9px] font-bold tracking-wide text-slate-400 transition-colors hover:text-emerald-600",children:o?e.jsxs(e.Fragment,{children:[e.jsx(I,{size:8,className:"animate-spin"}),e.jsx("span",{children:"Locating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{size:8}),e.jsx("span",{className:"max-w-[120px] truncate sm:max-w-[180px]",children:(n==null?void 0:n.city)||(n==null?void 0:n.area)||"Set Location"})]})})]})]}),e.jsx("div",{className:"flex items-center gap-3 sm:gap-4",children:s?e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsxs("div",{className:"hidden text-right sm:block",children:[e.jsx("p",{className:"text-xs font-black text-slate-900",children:s.name}),e.jsx("p",{className:"text-[10px] font-bold text-emerald-600 uppercase",children:s.role==="provider"?"HOST":"GUEST"})]}),e.jsx("button",{onClick:a,className:"flex h-9 w-9 items-center justify-center rounded-xl border border-slate-200 bg-slate-50 text-slate-400 transition-all hover:text-red-500 sm:h-10 sm:w-10 sm:rounded-2xl","aria-label":"Logout",children:e.jsx(Qe,{size:16,className:"sm:h-[18px] sm:w-[18px]"})})]}):e.jsxs("button",{onClick:t,className:"flex items-center justify-center gap-1.5 rounded-xl bg-emerald-600 px-4 py-2 text-xs font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-95 sm:gap-2 sm:rounded-2xl sm:px-5 sm:text-sm",children:[e.jsx(ve,{size:14,className:"sm:h-4 sm:w-4"}),"Join"]})})]})})}function bs({dua:s}){return e.jsxs("div",{className:"space-y-6 rounded-[2.5rem] border border-slate-100 bg-white p-10 shadow-sm transition-all duration-500 hover:shadow-xl hover:shadow-slate-200/40",children:[e.jsx("h4",{className:"text-[10px] font-black tracking-widest text-emerald-600 uppercase",children:s.title}),e.jsx("p",{className:"text-right text-4xl leading-[1.8] font-bold text-slate-900",dir:"rtl",children:s.arabic}),e.jsxs("div",{className:"space-y-2 border-t border-slate-50 pt-6",children:[e.jsxs("p",{className:"text-sm font-bold text-emerald-700 italic",children:['"',s.transliteration,'"']}),e.jsx("p",{className:"text-sm font-medium text-slate-400",children:s.english})]})]})}function js({event:s,onInterested:a}){return e.jsxs("div",{className:"flex flex-col justify-between gap-6 rounded-[2.5rem] border border-slate-100 bg-white p-6 shadow-sm transition-all duration-500 hover:shadow-xl hover:shadow-emerald-100/30 md:flex-row md:items-center",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"rounded-full bg-emerald-50 px-3 py-1 text-[10px] font-black text-emerald-600 uppercase",children:s.date}),e.jsx("span",{className:"rounded-full bg-slate-50 px-3 py-1 text-[10px] font-black text-slate-400 uppercase",children:s.time})]}),e.jsx("h3",{className:"text-2xl font-black text-slate-900",children:s.title}),e.jsxs("p",{className:"text-sm font-medium text-slate-400",children:[e.jsx(X,{size:12,className:"mr-1 inline"})," ",s.location," â€¢ ",e.jsx(Xe,{size:12,className:"mr-1 inline"})," ",s.speaker]})]}),e.jsx("button",{onClick:()=>a==null?void 0:a(s),className:"flex items-center justify-center gap-2 rounded-2xl bg-slate-900 px-6 py-3.5 text-sm font-bold text-white transition-all hover:bg-slate-800 active:scale-95",children:"Interested"})]})}function ys({point:s,onBook:a,compact:t=!1}){const n=o=>{const c=["th","st","nd","rd"],p=o%100;return o+(c[(p-20)%10]||c[p]||c[0])};return e.jsxs("div",{className:`flex flex-col border border-t-4 border-slate-100 border-t-emerald-500 bg-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-slate-200/40 ${t?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsxs("div",{className:`flex items-start justify-between ${t?"mb-2":"mb-4"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`leading-tight font-black text-slate-900 ${t?"text-base":"text-xl"}`,children:s.name}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[s.next_available_day&&e.jsxs("span",{className:"rounded-md bg-emerald-100 px-1.5 py-0.5 text-[10px] font-bold text-emerald-700",children:["Next: ",n(s.next_available_day)," Ramzan"]}),s.next_available_date&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-slate-400",children:[e.jsx(de,{size:10}),s.next_available_date]})]})]}),e.jsx("span",{className:`rounded-lg font-black uppercase ${t?"px-1.5 py-0.5 text-[8px]":"rounded-xl px-2 py-1 text-[9px]"} ${s.price===0?"bg-emerald-50 text-emerald-600":"bg-amber-50 text-amber-600"}`,children:s.price===0?"Free":`From â‚¹${s.price}`})]}),e.jsxs("div",{className:`flex-1 bg-slate-50 text-slate-600 ${t?"mb-3 rounded-xl p-3 text-xs leading-relaxed":"mb-6 rounded-2xl p-4 text-sm leading-relaxed"}`,children:[s.menu_items&&e.jsx("p",{className:"font-medium text-slate-700",children:s.menu_items}),s.message&&e.jsxs("p",{className:"mt-1 text-[11px] text-slate-500 italic",children:['"',s.message,'"']}),!s.menu_items&&!s.message&&e.jsx("span",{className:"text-slate-400 italic",children:"Menu details available on booking"})]}),e.jsxs("div",{className:"mb-3 flex flex-wrap items-center gap-2 text-[10px] text-slate-500",children:[s.distance!==null&&s.distance!==void 0&&e.jsxs("span",{className:"flex items-center gap-1 rounded bg-blue-50 px-1.5 py-0.5 font-bold text-blue-600",children:["ðŸ“ ",s.distance," km"]}),s.total_offerings&&e.jsxs("span",{className:"flex items-center gap-1 rounded bg-emerald-50 px-1.5 py-0.5 text-emerald-600",children:[e.jsx(fe,{size:10})," ",s.total_offerings," days"]}),s.area&&e.jsxs("span",{className:"rounded bg-slate-100 px-1.5 py-0.5",children:["ðŸ“ ",s.area]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:`grid gap-2 ${s.latitude&&s.longitude?"grid-cols-3":"grid-cols-2"}`,children:[e.jsxs("button",{onClick:()=>globalThis.open(`tel:${s.phone}`),className:`flex items-center justify-center gap-1.5 rounded-xl border border-slate-200 bg-white font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-95 ${t?"px-2 py-2 text-xs":"px-4 py-3.5 text-sm"}`,children:[e.jsx(we,{size:t?12:16})," Call"]}),e.jsxs("button",{onClick:()=>globalThis.open(`https://wa.me/${s.phone.replaceAll(/\D/g,"")}`),className:`flex items-center justify-center gap-1.5 rounded-xl border border-emerald-100 bg-white font-bold text-emerald-600 transition-all hover:bg-emerald-50 active:scale-95 ${t?"px-2 py-2 text-xs":"px-4 py-3.5 text-sm"}`,children:[e.jsx(es,{size:t?12:16})," Chat"]}),s.latitude&&s.longitude&&e.jsxs("button",{onClick:()=>globalThis.open(`https://www.google.com/maps/dir/?api=1&destination=${s.latitude},${s.longitude}`),className:`flex items-center justify-center gap-1.5 rounded-xl border border-blue-100 bg-white font-bold text-blue-600 transition-all hover:bg-blue-50 active:scale-95 ${t?"px-2 py-2 text-xs":"px-4 py-3.5 text-sm"}`,children:[e.jsx(X,{size:t?12:16})," Map"]})]}),e.jsx("button",{onClick:()=>a(s),disabled:!s.isBookable,className:`flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-95 disabled:bg-emerald-300 disabled:opacity-50 ${t?"px-3 py-2 text-xs":"px-6 py-3.5 text-sm"}`,children:s.isBookable?"Reserve Sehri":"Info Only"})]})]})}function Ns({time:s,compact:a=!1}){return e.jsxs("div",{className:`group relative overflow-hidden border-none bg-emerald-600 text-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-emerald-200/40 ${a?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsx(ss,{size:a?60:100,className:"absolute -top-4 -right-4 text-emerald-500/30 transition-transform duration-500 group-hover:scale-110"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("span",{className:`block font-black tracking-wider text-emerald-200 uppercase ${a?"mb-1 text-[8px]":"mb-8 text-[10px]"}`,children:"Imsak (Sehar)"}),e.jsx("h4",{className:`font-black tracking-tight ${a?"text-3xl":"text-5xl"}`,children:s}),!a&&e.jsx("p",{className:"mt-1 text-sm font-medium text-emerald-100/80",children:"Stop eating and intend to fast."})]})]})}function vs({time:s,compact:a=!1}){return e.jsxs("div",{className:`group relative overflow-hidden border-none bg-slate-950 text-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-slate-200/40 ${a?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsx(ts,{size:a?60:100,className:"absolute -top-4 -right-4 text-slate-800/50 transition-transform duration-500 group-hover:rotate-12"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("span",{className:`block font-black tracking-wider text-slate-400 uppercase ${a?"mb-1 text-[8px]":"mb-8 text-[10px]"}`,children:"Maghrib (Iftar)"}),e.jsx("h4",{className:`font-black tracking-tight ${a?"text-3xl":"text-5xl"}`,children:s}),!a&&e.jsx("p",{className:"mt-1 text-sm font-medium text-slate-400/80",children:"Break your fast with the sun's set."})]})]})}function ws({timings:s,compact:a=!1}){return e.jsxs("div",{className:`grid grid-cols-2 ${a?"gap-3":"gap-4"}`,children:[e.jsx(Ns,{time:s.sehar,compact:a}),e.jsx(vs,{time:s.iftar,compact:a})]})}async function ks(s,a){try{const n=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${a}&zoom=18&addressdetails=1`,{headers:{"Accept-Language":"en"}})).json();if(n!=null&&n.address){const{road:o,suburb:c,neighbourhood:p,city:i,town:z,village:S,state_district:d,state:y,postcode:m,county:C}=n.address;return{street:o||"",area:c||p||C||"",city:i||z||S||d||"",pincode:m||"",state:y||""}}return null}catch(t){return console.error("Reverse geocoding failed:",t),null}}function Ss({onClose:s,onSuccess:a}){const[t,n]=l.useState("CHOICE"),[o,c]=l.useState(!1),[p,i]=l.useState(""),[z,S]=l.useState(""),[d,y]=l.useState(""),[m,C]=l.useState("seeker"),[R,b]=l.useState(""),[N,w]=l.useState(""),[u,F]=l.useState(""),[x,_]=l.useState(""),[A,M]=l.useState(""),[E,$]=l.useState(""),[B,P]=l.useState(""),[T,Y]=l.useState(""),[K,W]=l.useState(""),[v,G]=l.useState(null),[J,ee]=l.useState(null),[r,k]=l.useState(!1),[D,Z]=l.useState(""),[U,ke]=l.useState(""),[ge,Se]=l.useState(""),[Le,Ce]=l.useState(""),[ne,me]=l.useState(["","","","","",""]),[ie,_e]=l.useState(""),be=l.useRef([]),ze=l.useCallback(async()=>{if(navigator.geolocation){k(!0);try{const h=await new Promise((L,We)=>{navigator.geolocation.getCurrentPosition(L,We,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),{latitude:g,longitude:j}=h.coords;G(g),ee(j);const O=await ks(g,j);O&&($(O.street),P(O.area),Y(O.city),W(O.pincode))}catch(h){console.log("Location fetch failed:",h.message)}finally{k(!1)}}},[]);l.useEffect(()=>{t==="REGISTER"&&ze()},[t,ze]);const Ie=(h,g)=>{var L;const j=h.target.value;if(isNaN(j))return;const O=[...ne];O[g]=j.slice(-1),me(O),j&&g<5&&((L=be.current[g+1])==null||L.focus())},Be=(h,g)=>{var j;h.key==="Backspace"&&!ne[g]&&g>0&&((j=be.current[g-1])==null||j.focus())},qe=async h=>{var g,j;h.preventDefault(),i(""),c(!0);try{const O=await V.login({email:z,password:d});if(O.success)O.token&&Ae.set("auth_token",O.token),f.success("Welcome back!",{description:`Logged in as ${O.user.name}`}),a(O.user);else{const L=O.message||"Login failed";i(L),f.error("Login Failed",{description:L})}}catch(O){const L=O.message||((j=(g=O.errors)==null?void 0:g.email)==null?void 0:j[0])||"Login failed. Please try again.";i(L),f.error("Login Failed",{description:L})}finally{c(!1)}},Ge=async h=>{var g,j;if(h.preventDefault(),i(""),N.length<6){i("Password must be at least 6 characters"),f.error("Validation Error",{description:"Password must be at least 6 characters"});return}c(!0);try{const O=await V.register({email:R,password:N,name:u,contact:x,role:m,place_name:m==="provider"?A:null,street:E,area:B,city:T,pincode:K,latitude:v,longitude:J});if(O.success)f.success("OTP Sent!",{description:"Please check your email for the verification code"}),_e("register"),me(["","","","","",""]),n("OTP");else{const L=O.message||"Registration failed";i(L),f.error("Registration Failed",{description:L})}}catch(O){const L=O.message||((j=(g=O.errors)==null?void 0:g.email)==null?void 0:j[0])||"Registration failed. Please try again.";i(L),f.error("Registration Failed",{description:L})}finally{c(!1)}},Ue=async h=>{if(h.preventDefault(),i(""),!D){i("Please enter your email"),f.error("Email Required",{description:"Please enter your registered email address"});return}c(!0);try{const g=await V.forgotPassword(D);if(g.success)f.success("OTP Sent!",{description:"Please check your email for the reset code"}),_e("forgot"),me(["","","","","",""]),n("OTP");else{const j=g.message||"Failed to send OTP";i(j),f.error("Failed",{description:j})}}catch(g){const j=g.message||"Failed to send OTP. Please try again.";i(j),f.error("Failed",{description:j})}finally{c(!1)}},He=async()=>{const h=ne.join("");if(!(h.length<6)){i(""),c(!0);try{if(ie==="register"){const g=await V.verifyRegistrationOtp(R,h);if(g.success)g.token&&Ae.set("auth_token",g.token),f.success("Account Verified!",{description:"Welcome to Ramzania!"}),a(g.user);else{const j=g.message||"Invalid OTP";i(j),f.error("Verification Failed",{description:j})}}else if(ie==="forgot"){const g=await V.verifyForgotPasswordOtp(D,h);if(g.success)f.success("OTP Verified!",{description:"Now set your new password"}),Ce(g.reset_token),n("RESET_PASSWORD");else{const j=g.message||"Invalid OTP";i(j),f.error("Verification Failed",{description:j})}}}catch(g){const j=g.message||"OTP verification failed. Please try again.";i(j),f.error("Verification Failed",{description:j})}finally{c(!1)}}},Ve=async h=>{if(h.preventDefault(),i(""),U.length<6){i("Password must be at least 6 characters"),f.error("Validation Error",{description:"Password must be at least 6 characters"});return}if(U!==ge){i("Passwords do not match"),f.error("Validation Error",{description:"Passwords do not match"});return}c(!0);try{const g=await V.resetPassword(D,Le,U,ge);if(g.success)f.success("Password Reset!",{description:"You can now login with your new password"}),n("LOGIN"),i(""),Z(""),ke(""),Se(""),Ce("");else{const j=g.message||"Password reset failed";i(j),f.error("Reset Failed",{description:j})}}catch(g){const j=g.message||"Password reset failed. Please try again.";i(j),f.error("Reset Failed",{description:j})}finally{c(!1)}},Ye=async()=>{c(!0),i("");try{let h;if(ie==="register"?h=await V.resendRegistrationOtp(R):h=await V.forgotPassword(D),h.success)f.success("OTP Resent!",{description:"Please check your email for the new code"}),me(["","","","","",""]);else{const g=h.message||"Failed to resend OTP";i(g),f.error("Failed",{description:g})}}catch{const g="Failed to resend OTP. Please try again.";i(g),f.error("Failed",{description:g})}finally{c(!1)}},oe="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",H="w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",se="flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 px-4 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",Ke={CHOICE:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/icon.svg",alt:"Ramzania",className:"h-12 w-12"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black tracking-tight text-slate-900",children:"Join Ramzania"}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Your portal to community Sehar."})]})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("button",{className:se,onClick:()=>n("LOGIN"),children:"Sign In"}),e.jsx("button",{className:"flex w-full items-center justify-center gap-2 rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-[0.98]",onClick:()=>n("REGISTER"),children:"Create Account"})]})]}),LOGIN:e.jsxs("form",{onSubmit:qe,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n("CHOICE"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ue,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Sign In"})]}),p&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:p}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"email",required:!0,placeholder:"Email address",className:oe,value:z,onChange:h=>S(h.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Password",className:oe,value:d,onChange:h=>y(h.target.value)})]}),e.jsx("button",{type:"submit",disabled:o,className:se,children:o?e.jsx(I,{className:"animate-spin",size:18}):"Sign In"}),e.jsx("button",{type:"button",onClick:()=>n("FORGOT"),className:"w-full text-center text-[10px] font-bold tracking-wide text-slate-400 uppercase hover:text-emerald-600",children:"Forgot Password?"})]}),REGISTER:e.jsxs("form",{onSubmit:Ge,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n("CHOICE"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ue,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Create Account"})]}),p&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:p}),e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{type:"button",onClick:()=>C("seeker"),className:`flex-1 rounded-lg py-2.5 text-xs font-bold transition-all ${m==="seeker"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"ðŸ½ï¸ Guest"}),e.jsx("button",{type:"button",onClick:()=>C("provider"),className:`flex-1 rounded-lg py-2.5 text-xs font-bold transition-all ${m==="provider"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"ðŸ  Host"})]}),e.jsx("p",{className:"text-[10px] font-medium text-slate-400",children:m==="seeker"?"Find & reserve Sehri near you":"Arrange Sehri for guests in your area"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"email",required:!0,placeholder:"Email address",className:H,value:R,onChange:h=>b(h.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Password (min 6 chars)",className:H,value:N,onChange:h=>w(h.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Full Name",className:H,value:u,onChange:h=>F(h.target.value)}),e.jsx("input",{type:"tel",required:!0,placeholder:"Contact Number",className:H,value:x,onChange:h=>_(h.target.value)})]}),m==="provider"&&e.jsx("input",{type:"text",required:!0,placeholder:"Place Name (e.g., Restaurant, Masjid,..)",className:H,value:A,onChange:h=>M(h.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500",children:"Address Details"}),r&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(I,{size:10,className:"animate-spin"}),"Fetching location..."]}),!r&&T&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(X,{size:10}),"Auto-filled"]})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Street / Door No",className:H,value:E,onChange:h=>$(h.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Area / Locality",className:H,value:B,onChange:h=>P(h.target.value)}),e.jsx("input",{type:"text",required:!0,placeholder:"City",className:H,value:T,onChange:h=>Y(h.target.value)})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Pincode",className:H,value:K,onChange:h=>W(h.target.value)})]}),e.jsx("button",{type:"submit",disabled:o,className:se,children:o?e.jsx(I,{className:"animate-spin",size:18}):"Continue â†’"})]}),FORGOT:e.jsxs("form",{onSubmit:Ue,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n("LOGIN"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ue,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Reset Password"})]}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Enter your email to receive a verification code."}),p&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:p}),e.jsx("input",{type:"email",required:!0,placeholder:"Registered email",className:oe,value:D,onChange:h=>Z(h.target.value)}),e.jsx("button",{type:"submit",disabled:o,className:se,children:o?e.jsx(I,{className:"animate-spin",size:18}):"Send OTP"})]}),OTP:e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n(ie==="register"?"REGISTER":"FORGOT"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ue,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Verify Email"})]}),e.jsxs("p",{className:"text-sm font-medium text-slate-500",children:["Enter the 6-digit code sent to ",e.jsx("span",{className:"font-bold text-slate-700",children:ie==="register"?R:D})]}),p&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:p}),e.jsx("div",{className:"flex justify-between gap-2",children:ne.map((h,g)=>e.jsx("input",{ref:j=>be.current[g]=j,type:"text",inputMode:"numeric",maxLength:1,className:"h-12 w-full rounded-xl border border-slate-200 bg-slate-50 text-center text-lg font-bold transition-all outline-none focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",value:h,onChange:j=>Ie(j,g),onKeyDown:j=>Be(j,g)},g))}),e.jsx("button",{type:"button",onClick:He,disabled:o||ne.join("").length<6,className:se,children:o?e.jsx(I,{className:"animate-spin",size:18}):"Verify"}),e.jsx("button",{type:"button",onClick:Ye,disabled:o,className:"w-full text-center text-[10px] font-bold tracking-wide text-slate-400 uppercase hover:text-emerald-600",children:"Resend Code"})]}),RESET_PASSWORD:e.jsxs("form",{onSubmit:Ve,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(as,{size:20,className:"text-emerald-600"}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"New Password"})]}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Create a new password for your account."}),p&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:p}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"password",required:!0,placeholder:"New Password (min 6 chars)",className:oe,value:U,onChange:h=>ke(h.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Confirm Password",className:oe,value:ge,onChange:h=>Se(h.target.value)})]}),e.jsx("button",{type:"submit",disabled:o,className:se,children:o?e.jsx(I,{className:"animate-spin",size:18}):"Reset Password"})]})};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-slate-900/40 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-4 w-full max-w-md rounded-2xl border border-slate-100 bg-white p-6 shadow-xl sm:rounded-3xl sm:p-8",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-emerald-50 text-emerald-600",children:e.jsx(ve,{size:20})}),e.jsx("button",{onClick:s,className:"rounded-full p-2 text-slate-300 transition-all hover:bg-slate-100 hover:text-slate-500",children:e.jsx(Q,{size:18})})]}),Ke[t]]})})}const xe=s=>new Promise(a=>setTimeout(a,s)),Cs=async(s={})=>{try{const a=new URLSearchParams;s.area&&a.append("area",s.area),s.place&&a.append("place",s.place);const t=a.toString(),n=`/home/offerings${t?`?${t}`:""}`,o=await q.get(n,{auth:!1});return o.success?{providers:o.providers||[],filters:o.filters||{},current_ramzan_day:o.current_ramzan_day,ramzan_start_date:o.ramzan_start_date}:{providers:Re(),filters:{}}}catch(a){return console.error("Failed to fetch providers from API, using mock data:",a),{providers:Re(),filters:{}}}},_s=async(s=null,a=null)=>{try{const t=new URLSearchParams;s&&t.append("day",s),a&&t.append("date",a);const n=t.toString(),o=n?`/home/timings?${n}`:"/home/timings",c=await q.get(o,{auth:!1});return c.success?c:{success:!1,timing:null}}catch(t){return console.error("Failed to fetch Ramzan timings:",t),{success:!1,timing:null}}},zs=async()=>{try{const s=await q.get("/home/timings/all",{auth:!1});return s.success?s.timings||[]:[]}catch(s){return console.error("Failed to fetch all Ramzan timings:",s),[]}},As=async(s,a={})=>{try{const t=new URLSearchParams;a.lat&&t.append("lat",a.lat),a.lng&&t.append("lng",a.lng);const n=t.toString(),o=`/home/provider/${s}/offerings${n?`?${n}`:""}`,c=await q.get(o,{auth:!1});return c.success?c:{success:!1,offerings:[]}}catch(t){return console.error("Failed to fetch provider offerings:",t),{success:!1,offerings:[]}}},Rs=async(s,a)=>q.post("/bookings",{offering_id:s,quantity:a}),Fs=async()=>q.get("/bookings/my"),Os=async s=>q.post(`/bookings/${s}/cancel`),Es=async(s="all")=>{const a=s==="all"?"/bookings/provider":`/bookings/provider?status=${s}`;return q.get(a)},Ps=async(s,a)=>q.put(`/bookings/${s}/status`,{status:a}),Re=()=>[],Ms=async()=>(await xe(200),[{id:1,title:"Dua for Suhoor (Intention for Fasting)",arabic:"ÙˆÙŽØ¨ÙØµÙŽÙˆÙ’Ù…Ù ØºÙŽØ¯Ù Ù†ÙŽÙˆÙŽÙŠÙ’ØªÙ Ù…ÙÙ†Ù’ Ø´ÙŽÙ‡Ù’Ø±Ù Ø±ÙŽÙ…ÙŽØ¶ÙŽØ§Ù†ÙŽ",transliteration:"Wa bisawmi ghadin nawaitu min shahri Ramadan",english:"I intend to fast tomorrow for the month of Ramadan."},{id:2,title:"Dua for Iftar (Breaking Fast)",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ Ø¥ÙÙ†ÙÙ‘ÙŠ Ù„ÙŽÙƒÙŽ ØµÙÙ…Ù’ØªÙ ÙˆÙŽØ¨ÙÙƒÙŽ Ø¢Ù…ÙŽÙ†Ù’ØªÙ ÙˆÙŽØ¹ÙŽÙ„ÙŽÙŠÙ’ÙƒÙŽ ØªÙŽÙˆÙŽÙƒÙŽÙ‘Ù„Ù’ØªÙ ÙˆÙŽØ¹ÙŽÙ„ÙŽÙ‰ Ø±ÙØ²Ù’Ù‚ÙÙƒÙŽ Ø£ÙŽÙÙ’Ø·ÙŽØ±Ù’ØªÙ",transliteration:"Allahumma inni laka sumtu wa bika aamantu wa â€˜alayka tawakkaltu wa â€˜ala rizqika aftartu",english:"O Allah, I fasted for You, I believe in You, I trust in You, and I break my fast with Your provision."},{id:3,title:"Dua After Breaking Fast (Authentic)",arabic:"Ø°ÙŽÙ‡ÙŽØ¨ÙŽ Ø§Ù„Ø¸ÙŽÙ‘Ù…ÙŽØ£Ù ÙˆÙŽØ§Ø¨Ù’ØªÙŽÙ„ÙŽÙ‘ØªÙ Ø§Ù„Ù’Ø¹ÙØ±ÙÙˆÙ‚Ù ÙˆÙŽØ«ÙŽØ¨ÙŽØªÙŽ Ø§Ù„Ù’Ø£ÙŽØ¬Ù’Ø±Ù Ø¥ÙÙ†Ù’ Ø´ÙŽØ§Ø¡ÙŽ Ø§Ù„Ù„ÙŽÙ‘Ù‡Ù",transliteration:"Dhahaba adh-dhamaâ€™u wabtallatil â€˜urooq wa thabatal ajru in sha Allah",english:"The thirst is gone, the veins are moistened, and the reward is confirmed, if Allah wills."},{id:4,title:"Dua for Laylatul Qadr",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ Ø¥ÙÙ†ÙŽÙ‘ÙƒÙŽ Ø¹ÙŽÙÙÙˆÙŒÙ‘ ØªÙØ­ÙØ¨ÙÙ‘ Ø§Ù„Ù’Ø¹ÙŽÙÙ’ÙˆÙŽ ÙÙŽØ§Ø¹Ù’ÙÙ Ø¹ÙŽÙ†ÙÙ‘ÙŠ",transliteration:"Allahumma innaka afuwwun tuhibbul afwa faâ€™fu anni",english:"O Allah, You are Most Forgiving, and You love forgiveness; so forgive me."},{id:5,title:"Dua for Forgiveness",arabic:"Ø£ÙŽØ³Ù’ØªÙŽØºÙ’ÙÙØ±Ù Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙŽ",transliteration:"Astaghfirullah",english:"I seek forgiveness from Allah."},{id:6,title:"Dua for Mercy",arabic:"Ø±ÙŽØ¨ÙÙ‘ Ø§ØºÙ’ÙÙØ±Ù’ ÙˆÙŽØ§Ø±Ù’Ø­ÙŽÙ…Ù’ ÙˆÙŽØ£ÙŽÙ†Ù’ØªÙŽ Ø®ÙŽÙŠÙ’Ø±Ù Ø§Ù„Ø±ÙŽÙ‘Ø§Ø­ÙÙ…ÙÙŠÙ†ÙŽ",transliteration:"Rabbighfir warham wa anta khayrur rahimeen",english:"My Lord, forgive and have mercy, for You are the Best of the merciful."},{id:7,title:"Dua for Guidance",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ Ø§Ù‡Ù’Ø¯ÙÙ†ÙÙŠ ÙˆÙŽØ³ÙŽØ¯ÙÙ‘Ø¯Ù’Ù†ÙÙŠ",transliteration:"Allahumma ihdini wa saddidni",english:"O Allah, guide me and keep me steadfast."},{id:8,title:"Dua for Acceptance of Fasting",arabic:"Ø§Ù„Ù„ÙŽÙ‘Ù‡ÙÙ…ÙŽÙ‘ ØªÙŽÙ‚ÙŽØ¨ÙŽÙ‘Ù„Ù’ Ù…ÙÙ†ÙŽÙ‘Ø§ Ø¥ÙÙ†ÙŽÙ‘ÙƒÙŽ Ø£ÙŽÙ†Ù’ØªÙŽ Ø§Ù„Ø³ÙŽÙ‘Ù…ÙÙŠØ¹Ù Ø§Ù„Ù’Ø¹ÙŽÙ„ÙÙŠÙ…Ù",transliteration:"Allahumma taqabbal Ù…Ù†Ø§ innaka antas-sameeâ€™ul aleem",english:"O Allah, accept from us. Indeed, You are the All-Hearing, All-Knowing."}]),Ds=async()=>(await xe(200),[]),$s=async(s="Chennai")=>(await xe(100),{sehar:"4:52 AM",iftar:"6:24 PM",area:s}),Ts=async(s,a)=>(await xe(1e3),{success:!0,user:{email:s,role:s.includes("admin")?"admin":"seeker",name:s.split("@")[0],token:"token-"+Date.now()}}),Ls=async(s,a)=>(await xe(500),{success:!0,bookingId:`BK-${Date.now()}`,message:"Spot booked successfully!"}),te={fetchPoints:Cs,fetchDuas:Ms,fetchEvents:Ds,fetchTimings:$s,fetchRamzanTimings:_s,fetchAllRamzanTimings:zs,login:Ts,bookSpot:Ls};function Is({point:s,user:a,userLocation:t,onClose:n,onSuccess:o,onLoginClick:c}){const[p,i]=l.useState(!0),[z,S]=l.useState([]),[d,y]=l.useState(null),[m,C]=l.useState(null),[R,b]=l.useState(1),[N,w]=l.useState(!1);l.useEffect(()=>{(async()=>{i(!0);const _=s.provider_id||s.id,A={};t!=null&&t.lat&&(t!=null&&t.lng)&&(A.lat=t.lat,A.lng=t.lng);const M=await As(_,A);M.success&&(y(M.provider),S(M.offerings||[])),i(!1)})()},[s,t]);const u=x=>{const _=["th","st","nd","rd"],A=x%100;return x+(_[(A-20)%10]||_[A]||_[0])},F=async()=>{if(!m){f.error("Please select a date");return}w(!0);try{const x=await Rs(m.id,R);x.success?(f.success("Spot Booked!",{description:`Booking code: ${x.booking.booking_code}`}),o==null||o(`Spot booked for ${u(m.ramzan_day)} Ramzan!`)):f.error("Booking Failed",{description:x.message})}catch(x){x.status===401?(f.error("Please login to book"),c==null||c()):f.error("Booking Failed",{description:x.message})}finally{w(!1)}};return a?e.jsx("div",{className:"fixed inset-0 z-100 flex items-end justify-center bg-slate-900/30 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-10 max-h-[90vh] w-full max-w-md overflow-hidden rounded-3xl border border-slate-100 bg-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 p-4",children:[e.jsx("h2",{className:"text-lg font-black text-slate-900",children:"Reserve Sehri"}),e.jsx("button",{onClick:n,className:"rounded-full p-2 text-slate-400 hover:bg-slate-100",children:e.jsx(Q,{size:18})})]}),e.jsxs("div",{className:"bg-emerald-50 px-4 py-3",children:[e.jsx("p",{className:"font-black text-emerald-800",children:(d==null?void 0:d.name)||s.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-emerald-600",children:[e.jsx("span",{children:(d==null?void 0:d.area)||s.area}),(d==null?void 0:d.distance)!==null&&(d==null?void 0:d.distance)!==void 0&&e.jsxs("span",{className:"flex items-center gap-0.5 rounded bg-emerald-100 px-1.5 py-0.5 text-emerald-700",children:[e.jsx(X,{size:10})," ",d.distance," km"]})]})]}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto p-4",children:p?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(I,{size:24,className:"animate-spin text-emerald-600"})}):z.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(fe,{size:32,className:"mx-auto mb-2 text-slate-300"}),e.jsx("p",{className:"text-sm text-slate-500",children:"No available dates"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"mb-3 text-xs font-bold text-slate-500",children:"Select a date:"}),z.map(x=>e.jsxs("button",{disabled:!x.is_bookable,onClick:()=>C(x),className:`w-full rounded-xl border p-3 text-left transition-all ${(m==null?void 0:m.id)===x.id?"border-emerald-500 bg-emerald-50 ring-2 ring-emerald-200":x.is_bookable?"border-slate-200 bg-white hover:border-emerald-300 hover:bg-emerald-50/50":"cursor-not-allowed border-slate-100 bg-slate-50 opacity-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 text-xs font-black text-emerald-700",children:u(x.ramzan_day)}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold text-slate-800",children:[x.formatted_date,e.jsxs("span",{className:"ml-1 text-[10px] font-normal text-slate-400",children:["(",x.day_name,")"]})]}),e.jsx("p",{className:"text-[10px] text-slate-500",children:x.meal_type})]})]}),e.jsxs("div",{className:"text-right",children:[(m==null?void 0:m.id)===x.id&&e.jsx(Me,{size:16,className:"text-emerald-600"}),!m||m.id!==x.id?e.jsx("span",{className:`text-xs font-bold ${x.is_bookable?"text-emerald-600":"text-red-500"}`,children:x.is_bookable?`${x.available_slots} spots`:"Full"}):null]})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-1.5 text-[10px] text-slate-500",children:[x.timing&&e.jsxs("span",{className:"flex items-center gap-0.5 rounded bg-slate-100 px-1.5 py-0.5",children:[e.jsx(re,{size:10})," ",x.timing]}),e.jsx("span",{className:`rounded px-1.5 py-0.5 ${x.price_type==="free"?"bg-emerald-100 text-emerald-600":"bg-amber-100 text-amber-600"}`,children:x.price_type==="free"?"Free":`â‚¹${x.price_amount}`})]}),e.jsxs("p",{className:"mt-2 text-[10px] text-slate-400 italic",children:['"',x.menu_items,'"']})]},x.id))]})}),m&&e.jsxs("div",{className:"border-t border-slate-100 bg-slate-50 p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between rounded-xl bg-white p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{size:16,className:"text-slate-400"}),e.jsx("span",{className:"text-sm font-bold text-slate-700",children:"No. of Persons"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>b(x=>Math.max(1,x-1)),className:"rounded-lg bg-slate-100 p-1.5 text-slate-600 hover:bg-slate-200",children:e.jsx(ls,{size:14})}),e.jsx("span",{className:"w-6 text-center text-sm font-black text-slate-900",children:R}),e.jsx("button",{type:"button",onClick:()=>b(x=>Math.min(m.available_slots,Math.min(10,x+1))),className:"rounded-lg bg-slate-100 p-1.5 text-slate-600 hover:bg-slate-200",children:e.jsx(De,{size:14})})]})]}),e.jsxs("div",{className:"mb-4 flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-slate-500",children:[u(m.ramzan_day)," Ramzan â€¢ ",m.meal_type]}),e.jsx("span",{className:"font-bold text-slate-900",children:m.price_type==="free"?"Free":`â‚¹${(m.price_amount||0)*R}`})]}),e.jsx("button",{onClick:F,disabled:N,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",children:N?e.jsxs(e.Fragment,{children:[e.jsx(I,{size:16,className:"animate-spin"}),"Booking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{size:16}),"Confirm Booking"]})})]})]})}):e.jsx("div",{className:"fixed inset-0 z-100 flex items-end justify-center bg-slate-900/30 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-10 w-full max-w-md rounded-3xl border border-slate-100 bg-white p-6 shadow-lg",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Book Spot"}),e.jsx("button",{onClick:n,className:"rounded-full p-2 text-slate-400 hover:bg-slate-100",children:e.jsx(Q,{size:18})})]}),e.jsxs("div",{className:"mb-6 rounded-xl bg-emerald-50 p-4",children:[e.jsx("p",{className:"font-black text-emerald-800",children:s.name}),e.jsx("p",{className:"text-xs text-emerald-600",children:s.area})]}),e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:[e.jsx(ve,{size:32,className:"mx-auto mb-3 text-slate-400"}),e.jsx("p",{className:"font-bold text-slate-700",children:"Login Required"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Please login or register to reserve Sehri"}),e.jsx("button",{onClick:()=>{n(),c==null||c()},className:"mt-4 rounded-xl bg-emerald-600 px-6 py-2.5 text-sm font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:"Login / Register"})]})]})})}function Bs({duas:s}){return e.jsxs("div",{className:"space-y-12",children:[e.jsxs("h2",{className:"text-5xl font-black tracking-tighter text-slate-950 md:text-7xl",children:["Daily ",e.jsx("span",{className:"text-emerald-600",children:"Duas."})]}),e.jsx("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2",children:s.map(a=>e.jsx(bs,{dua:a},a.id))}),s.length===0&&e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-lg font-bold text-slate-400",children:"No duas available"})})]})}function Fe({events:s,onInterested:a}){return e.jsxs("div",{className:"space-y-12",children:[e.jsxs("h2",{className:"text-5xl font-black tracking-tighter text-slate-950 md:text-7xl",children:["Community ",e.jsx("span",{className:"text-emerald-600",children:"Events."})]}),e.jsx("div",{className:"space-y-4",children:s.map(t=>e.jsx(js,{event:t,onInterested:a},t.id))}),s.length===0&&e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("p",{className:"text-lg font-bold text-slate-400",children:"No events scheduled"}),e.jsx("p",{className:"text-sm text-slate-300",children:"Check back later for upcoming events"})]})]})}function qs({timings:s,ramzanTiming:a,points:t,onBook:n,availableAreas:o=[],onFilterChange:c,loading:p}){const[i,z]=l.useState(""),[S,d]=l.useState(""),[y,m]=l.useState(!1),C=()=>{const u=new Date,F=new Date("2026-02-19"),x=new Date("2026-03-20");return u>=F&&u<=x},R=t.filter(u=>u.name.toLowerCase().includes(i.toLowerCase())||u.menu.toLowerCase().includes(i.toLowerCase())),b=u=>{d(u),c&&c({area:u})},N=()=>{d(""),z(""),c&&c({})},w=u=>{if(!u)return"--:--";const[F,x]=u.split(":"),_=parseInt(F),A=_>=12?"PM":"AM";return`${_%12||12}:${x} ${A}`};return e.jsxs("div",{className:"space-y-6",children:[a&&C()&&e.jsxs("section",{className:"rounded-2xl bg-gradient-to-br from-emerald-50 to-teal-50 p-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{size:16,className:"text-emerald-600"}),e.jsxs("h2",{className:"text-sm font-black tracking-tight text-slate-900",children:["Day ",a.ramzan_day," - Prayer Times"]})]}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:new Date(a.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"rounded-xl bg-white/80 p-3 text-center shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:"Sehri Ends"}),e.jsx("p",{className:"text-lg font-black text-emerald-700",children:w(a.sehar_time)})]}),e.jsxs("div",{className:"rounded-xl bg-white/80 p-3 text-center shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:"Iftar"}),e.jsx("p",{className:"text-lg font-black text-orange-600",children:w(a.iftar_time)})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2 sm:grid-cols-6",children:[{name:"Fajr",time:a.fajr},{name:"Zohar",time:a.zohar},{name:"Asar",time:a.asar},{name:"Magrib",time:a.magrib},{name:"Isha",time:a.isha},{name:"Taraweeh",time:a.taraweeh}].map(u=>e.jsxs("div",{className:"rounded-lg bg-white/60 px-2 py-1.5 text-center",children:[e.jsx("p",{className:"text-[10px] font-medium text-slate-500",children:u.name}),e.jsx("p",{className:"text-xs font-bold text-slate-700",children:w(u.time)})]},u.name))})]}),!a&&C()&&e.jsxs("section",{children:[e.jsx("h2",{className:"mb-3 text-sm font-black tracking-tight text-slate-900",children:"Today's Timings"}),e.jsx(ws,{timings:s,compact:!0})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rs,{size:16,className:"text-emerald-600"}),e.jsx("h2",{className:"text-sm font-black tracking-tight text-slate-900",children:"Sehri Spots"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"rounded-lg bg-slate-100 px-2 py-0.5 text-xs font-bold text-slate-600",children:p?"...":`${R.length} nearby`}),e.jsxs("button",{onClick:()=>m(!y),className:`flex items-center gap-1 rounded-lg px-2 py-0.5 text-xs font-bold transition-colors ${y||S?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600"}`,children:[e.jsx(ns,{size:12}),"Filter"]})]})]}),y&&e.jsxs("div",{className:"mb-4 rounded-xl border border-slate-200 bg-slate-50 p-3",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-bold text-slate-700",children:"Filter by Area"}),S&&e.jsxs("button",{onClick:N,className:"flex items-center gap-1 text-xs text-slate-500 hover:text-slate-700",children:[e.jsx(Q,{size:12})," Clear"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:o.length>0?o.map(u=>e.jsxs("button",{onClick:()=>b(u===S?"":u),className:`flex items-center gap-1 rounded-full px-3 py-1 text-xs font-medium transition-colors ${S===u?"bg-emerald-600 text-white":"bg-white text-slate-600 hover:bg-emerald-50"}`,children:[e.jsx(X,{size:10}),u]},u)):e.jsx("p",{className:"text-xs text-slate-400",children:"No areas available"})})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(is,{size:16,className:"absolute top-1/2 left-3 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search Sehri Spots...",value:i,onChange:u=>z(u.target.value),className:"w-full rounded-xl border border-slate-200 bg-white py-2.5 pr-4 pl-9 text-sm font-medium text-slate-900 placeholder:text-slate-400 focus:border-emerald-300 focus:ring-2 focus:ring-emerald-100 focus:outline-none"})]}),p?e.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:e.jsx("div",{className:"animate-pulse",children:e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Loading hosts..."})})}):R.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:R.map(u=>e.jsx(ys,{point:u,onBook:n,compact:!0},u.id))}):e.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"No Sehri found"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Try a different search term or clear filters"})]})]})]})}const Gs="ramzania_user";function Us({user:s,onUserUpdate:a}){const[t,n]=l.useState({place_name:"",contact:"",alternate_contact:"",street:"",area:"",city:"",pincode:"",latitude:"",longitude:""}),[o,c]=l.useState(!1),[p,i]=l.useState({type:"",text:""}),[z,S]=l.useState(!1),[d,y]=l.useState(!1);l.useEffect(()=>{s&&n({place_name:s.place_name||"",contact:s.contact||"",alternate_contact:s.alternate_contact||"",street:s.street||"",area:s.area||"",city:s.city||"",pincode:s.pincode||"",latitude:s.latitude||"",longitude:s.longitude||""})},[s]);const m=w=>{const{name:u,value:F}=w.target;n(x=>({...x,[u]:F}))},C=l.useCallback(()=>{if(!navigator.geolocation){i({type:"error",text:"Geolocation not supported by your browser"});return}i({type:"info",text:"Getting your location..."}),navigator.geolocation.getCurrentPosition(w=>{n(u=>({...u,latitude:w.coords.latitude.toFixed(6),longitude:w.coords.longitude.toFixed(6)})),i({type:"success",text:"Location updated!"}),setTimeout(()=>i({type:"",text:""}),2e3)},w=>{i({type:"error",text:"Failed to get location: "+w.message})},{enableHighAccuracy:!0,timeout:1e4})},[]),R=()=>{const w=t.latitude||19.076,u=t.longitude||72.8777;window.open(`https://www.google.com/maps/search/?api=1&query=${w},${u}`,"_blank"),i({type:"info",text:"Copy the coordinates from Google Maps URL and paste them in the fields above"})},b=async w=>{var u,F;w.preventDefault(),c(!0),i({type:"",text:""});try{const x=await V.updateProfile({user_id:s.id,place_name:t.place_name,contact:t.contact,alternate_contact:t.alternate_contact||null,street:t.street,area:t.area,city:t.city,pincode:t.pincode,latitude:t.latitude?parseFloat(t.latitude):null,longitude:t.longitude?parseFloat(t.longitude):null});if(x.data.success){i({type:"success",text:"Profile updated successfully!"});const _={...s,...x.data.user};localStorage.setItem(Gs,JSON.stringify(_)),a&&a(_)}else i({type:"error",text:x.data.message||"Update failed"})}catch(x){console.error("Profile update error:",x),i({type:"error",text:((F=(u=x.response)==null?void 0:u.data)==null?void 0:F.message)||"Failed to update profile"})}finally{c(!1)}},N=()=>{t.latitude&&t.longitude&&window.open(`https://www.google.com/maps?q=${t.latitude},${t.longitude}`,"_blank")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Host Settings"}),e.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Update your place details and contact information"})]}),p.text&&e.jsx("div",{className:`rounded-lg p-3 text-sm ${p.type==="success"?"border border-emerald-200 bg-emerald-50 text-emerald-700":p.type==="error"?"border border-red-200 bg-red-50 text-red-700":"border border-blue-200 bg-blue-50 text-blue-700"}`,children:p.text}),e.jsxs("form",{onSubmit:b,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Place Name"}),e.jsx("input",{type:"text",name:"place_name",value:t.place_name,onChange:m,placeholder:"e.g., Shah's Kitchen",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"This name will be shown to guests"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Primary Contact"}),e.jsx("input",{type:"tel",name:"contact",value:t.contact,onChange:m,placeholder:"+91 98765 43210",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Alternate Number"}),e.jsx("input",{type:"tel",name:"alternate_contact",value:t.alternate_contact,onChange:m,placeholder:"Optional",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Street Address"}),e.jsx("input",{type:"text",name:"street",value:t.street,onChange:m,placeholder:"Building, Street name",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Area"}),e.jsx("input",{type:"text",name:"area",value:t.area,onChange:m,placeholder:"e.g., Bandra West",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"City"}),e.jsx("input",{type:"text",name:"city",value:t.city,onChange:m,placeholder:"e.g., Mumbai",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Pincode"}),e.jsx("input",{type:"text",name:"pincode",value:t.pincode,onChange:m,placeholder:"e.g., 400050",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700",children:"Location Coordinates"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Helps guests navigate to your place"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:C,className:"rounded-lg bg-emerald-50 px-3 py-1.5 text-xs font-medium text-emerald-600 transition-colors hover:bg-emerald-100",children:"ðŸ“ Use GPS"}),e.jsx("button",{type:"button",onClick:R,className:"rounded-lg bg-blue-50 px-3 py-1.5 text-xs font-medium text-blue-600 transition-colors hover:bg-blue-100",children:"ðŸ—ºï¸ Open Maps"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-500",children:"Latitude"}),e.jsx("input",{type:"number",name:"latitude",value:t.latitude,onChange:m,placeholder:"e.g., 19.0760",step:"0.000001",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-500",children:"Longitude"}),e.jsx("input",{type:"number",name:"longitude",value:t.longitude,onChange:m,placeholder:"e.g., 72.8777",step:"0.000001",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]})]}),t.latitude&&t.longitude&&e.jsxs("button",{type:"button",onClick:N,className:"mt-3 flex w-full items-center justify-center gap-2 rounded-xl bg-slate-50 py-2 text-sm font-medium text-slate-600 transition-colors hover:bg-slate-100",children:[e.jsxs("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"View Current Location on Map"]})]}),e.jsx("button",{type:"submit",disabled:o,className:"mt-6 w-full rounded-xl bg-emerald-600 py-3 font-bold text-white transition-all hover:bg-emerald-700 focus:ring-4 focus:ring-emerald-100 disabled:cursor-not-allowed disabled:opacity-50",children:o?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})]})]})}function Hs(){const[s,a]=l.useState([]),[t,n]=l.useState(!0),[o,c]=l.useState(null),p=d=>{const y=["th","st","nd","rd"],m=d%100;return d+(y[(m-20)%10]||y[m]||y[0])},i=async()=>{n(!0);try{const d=await Fs();d.success?a(d.bookings||[]):f.error(d.message||"Failed to load bookings")}catch{f.error("Failed to load bookings")}finally{n(!1)}};l.useEffect(()=>{i()},[]);const z=async d=>{if(globalThis.confirm("Are you sure you want to cancel this booking?")){c(d);try{const y=await Os(d);y.success?(f.success("Booking cancelled"),a(m=>m.map(C=>C.id===d?{...C,status:"cancelled"}:C))):f.error(y.message||"Failed to cancel")}catch{f.error("Failed to cancel booking")}finally{c(null)}}},S=d=>{switch(d){case"confirmed":return"bg-emerald-100 text-emerald-700";case"completed":return"bg-blue-100 text-blue-700";case"cancelled":return"bg-red-100 text-red-700";default:return"bg-slate-100 text-slate-700"}};return t?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(I,{size:32,className:"animate-spin text-emerald-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-slate-900",children:"My Reservations"}),e.jsxs("p",{className:"text-xs text-slate-500",children:[s.length," Sehri reservation(s)"]})]}),e.jsx("button",{onClick:i,className:"rounded-lg bg-slate-100 p-2 text-slate-600 transition-all hover:bg-slate-200 active:scale-95",children:e.jsx($e,{size:16})})]}),s.length===0?e.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-16 text-center",children:[e.jsx(Ee,{size:48,className:"mx-auto mb-4 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-600",children:"No Sehri reservations yet"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Browse hosts & reserve your Sehri from Home"})]}):e.jsx("div",{className:"space-y-4",children:s.map(d=>e.jsxs("div",{className:`rounded-2xl border bg-white p-4 shadow-sm ${d.status==="cancelled"?"border-slate-200 opacity-60":"border-slate-100"}`,children:[e.jsxs("div",{className:"mb-3 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-black text-slate-900",children:d.provider_name}),e.jsxs("div",{className:"mt-1 flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(X,{size:12}),d.area]})]}),e.jsx("span",{className:`rounded-lg px-2 py-1 text-[10px] font-bold uppercase ${S(d.status)}`,children:d.status})]}),e.jsxs("div",{className:"rounded-xl bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 font-bold text-emerald-700",children:[p(d.ramzan_day)," Ramzan"]}),e.jsxs("span",{className:"flex items-center gap-1 text-slate-500",children:[e.jsx(de,{size:12}),d.formatted_date]}),e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5 text-[10px] font-bold text-slate-600",children:d.meal_type})]}),d.timing&&e.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-slate-500",children:[e.jsx(re,{size:12}),d.timing]}),e.jsxs("p",{className:"mt-2 text-xs text-slate-500 italic",children:['"',d.menu_items,'"']})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-600",children:[e.jsxs("span",{className:"font-bold",children:["ðŸ‘¥ ",d.quantity," person(s)"]}),e.jsx("span",{className:"font-bold",children:d.price_type==="free"||d.total_amount===0?"ðŸ†“ Free":`ðŸ’° â‚¹${d.total_amount}`})]}),e.jsx("span",{className:"rounded bg-slate-100 px-2 py-1 font-mono text-[10px] text-slate-500",children:d.booking_code})]}),d.status==="confirmed"&&e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs("a",{href:`tel:${d.provider_phone}`,className:"flex flex-1 items-center justify-center gap-1.5 rounded-xl border border-slate-200 bg-white py-2 text-xs font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-95",children:[e.jsx(we,{size:14})," Call Host"]}),e.jsxs("button",{onClick:()=>z(d.id),disabled:o===d.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-xs font-bold text-red-600 transition-all hover:bg-red-100 active:scale-95 disabled:opacity-50",children:[o===d.id?e.jsx(I,{size:14,className:"animate-spin"}):e.jsx(Q,{size:14}),"Cancel"]})]}),e.jsxs("p",{className:"mt-3 text-[10px] text-slate-400",children:["Booked on ",d.booked_at]})]},d.id))})]})}const ae={LIST:"/offerings",CREATE:"/offerings",BULK_CREATE:"/offerings/bulk",UPDATE:s=>`/offerings/${s}`,DELETE:s=>`/offerings/${s}`,STATS:"/offerings/stats"},le={getAll:async()=>q.get(ae.LIST),create:async s=>q.post(ae.CREATE,s),bulkCreate:async s=>q.post(ae.BULK_CREATE,{offerings:s}),update:async(s,a)=>q.put(ae.UPDATE(s),a),delete:async s=>q.delete(ae.DELETE(s)),getStats:async()=>q.get(ae.STATS)},pe=30,Vs=new Date("2026-02-19"),Ys=()=>Array.from({length:pe},(s,a)=>{const t=a+1,n=new Date(Vs);return n.setDate(n.getDate()+a),{day:t,date:n,dateStr:n.toLocaleDateString("en-IN",{day:"numeric",month:"short"}),fullDate:n.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})}}),ye=Ys();function Ks({onClose:s,onSave:a,editingPoint:t,loading:n}){var T,Y,K,W;const[o,c]=l.useState("single"),[p,i]=l.useState(t?[t.ramzan_day]:[1]),[z]=l.useState("sehar"),[S,d]=l.useState((t==null?void 0:t.menu_items)||""),[y,m]=l.useState(((T=t==null?void 0:t.capacity)==null?void 0:T.toString())||"50"),[C,R]=l.useState((t==null?void 0:t.price_type)||"free"),[b,N]=l.useState(((Y=t==null?void 0:t.price_amount)==null?void 0:Y.toString())||""),[w,u]=l.useState(((K=t==null?void 0:t.timing_from)==null?void 0:K.slice(0,5))||"04:00"),[F,x]=l.useState(((W=t==null?void 0:t.timing_to)==null?void 0:W.slice(0,5))||"05:30"),[_,A]=l.useState((t==null?void 0:t.message)||""),M="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",E="w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",$=v=>{i(o==="single"?[v]:G=>G.includes(v)?G.filter(J=>J!==v):[...G,v])},B=()=>{p.length===pe?i([]):i(Array.from({length:pe},(v,G)=>G+1))},P=v=>{if(v.preventDefault(),p.length===0){f.error("Please select at least one day");return}if(!S.trim()){f.error("Please enter menu items");return}const G={meal_type:z,menu_items:S.trim(),capacity:Number.parseInt(y)||50,price_type:C,price_amount:C==="paid"?Number.parseFloat(b)||0:null,timing_from:w,timing_to:F,message:_.trim()||null};if(t)a({...G,id:t.id});else if(o==="single")a({...G,ramzan_day:p[0]});else{const J=p.map(ee=>({...G,ramzan_day:ee}));a({bulk:!0,offerings:J})}};return e.jsx("div",{className:"fixed inset-0 z-100 flex items-start justify-center overflow-y-auto bg-slate-900/40 px-4 pt-4 pb-24 backdrop-blur-sm sm:items-center sm:pb-4",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-4 sm:slide-in-from-bottom-0 sm:zoom-in-95 w-full max-w-lg rounded-2xl bg-white p-6 shadow-xl sm:my-auto",children:[e.jsxs("div",{className:"mb-5 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-black text-slate-900",children:[t?"Edit":"Add"," Sehar Offering"]}),e.jsx("button",{onClick:s,className:"rounded-full p-1.5 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(Q,{size:18})})]}),e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[!t&&e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{type:"button",onClick:()=>{c("single"),i([1])},className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${o==="single"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Single Day"}),e.jsx("button",{type:"button",onClick:()=>c("bulk"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${o==="bulk"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Multiple Days"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsxs("label",{className:"block text-xs font-bold text-slate-500",children:[e.jsx(de,{size:12,className:"mr-1 inline"}),o==="single"?"Select Ramzan Day":"Select Days"]}),o==="bulk"&&!t&&e.jsx("button",{type:"button",onClick:B,className:"text-[10px] font-bold text-emerald-600 hover:underline",children:p.length===pe?"Deselect All":"Select All"})]}),o==="single"||t?e.jsx("select",{value:p[0],onChange:v=>i([Number.parseInt(v.target.value)]),className:M,disabled:!!t,children:ye.map(v=>e.jsxs("option",{value:v.day,children:["Day ",v.day," - ",v.fullDate]},v.day))}):e.jsx("div",{className:"grid max-h-32 grid-cols-5 gap-1.5 overflow-y-auto rounded-xl border border-slate-200 bg-slate-50 p-2",children:ye.map(v=>e.jsx("button",{type:"button",onClick:()=>$(v.day),className:`rounded-lg px-2 py-1.5 text-[10px] font-bold transition-all ${p.includes(v.day)?"bg-emerald-600 text-white":"bg-white text-slate-600 hover:bg-emerald-50"}`,children:v.day},v.day))}),o==="bulk"&&p.length>0&&e.jsxs("p",{className:"mt-1 text-[10px] text-emerald-600",children:[p.length," days selected"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(fe,{size:12,className:"mr-1 inline"}),"Meal Type"]}),e.jsx("div",{className:"rounded-xl border border-slate-200 bg-emerald-50 px-4 py-3 text-sm font-bold text-emerald-700",children:"Sehar (Pre-dawn meal)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Menu Items *"}),e.jsx("textarea",{required:!0,placeholder:"e.g., Biryani, Kheer, Dates, Rooh Afza, Chai...",className:M+" resize-none",rows:2,value:S,onChange:v=>d(v.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(ce,{size:12,className:"mr-1 inline"}),"Capacity *"]}),e.jsx("input",{type:"number",required:!0,min:"1",max:"10000",placeholder:"No. of people",className:E,value:y,onChange:v=>m(v.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(xs,{size:12,className:"mr-1 inline"}),"Price Type"]}),e.jsxs("select",{value:C,onChange:v=>R(v.target.value),className:E,children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"paid",children:"Paid"})]})]})]}),C==="paid"&&e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Amount per person (â‚¹)"}),e.jsx("input",{type:"number",required:!0,min:"1",placeholder:"Enter amount",className:E,value:b,onChange:v=>N(v.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(re,{size:12,className:"mr-1 inline"}),"Service Timings"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"time",className:E,value:w,onChange:v=>u(v.target.value)}),e.jsx("input",{type:"time",className:E,value:F,onChange:v=>x(v.target.value)})]}),e.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"From - To (e.g., 4:00 AM - 5:30 AM)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(ms,{size:12,className:"mr-1 inline"}),"Additional Message (Optional)"]}),e.jsx("textarea",{placeholder:"Any special instructions or notes...",className:M+" resize-none",rows:2,value:_,onChange:v=>A(v.target.value)})]}),e.jsx("button",{type:"submit",disabled:n,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",children:n?e.jsxs(e.Fragment,{children:[e.jsx(I,{size:16,className:"animate-spin"}),"Saving..."]}):t?"Update Offering":o==="bulk"?`Add ${p.length} Offering${p.length>1?"s":""}`:"Add Offering"})]})]})})}function Ws({user:s}){const[a,t]=l.useState("offerings"),[n,o]=l.useState(!1),[c,p]=l.useState(null),[i,z]=l.useState([]),[S,d]=l.useState([]),[y,m]=l.useState({total:0,confirmed:0,completed:0,cancelled:0}),[C,R]=l.useState("all"),[b,N]=l.useState(!1),[w,u]=l.useState(!1),[F,x]=l.useState(!1),[_,A]=l.useState(null),[M,E]=l.useState({total_offerings:0,total_capacity:0,total_booked:0});l.useEffect(()=>{$(),B(),P()},[]),l.useEffect(()=>{P()},[C]);const $=async()=>{N(!0);try{const r=await le.getAll();r.success&&z(r.offerings||[])}catch{f.error("Failed to load offerings")}finally{N(!1)}},B=async()=>{try{const r=await le.getStats();r.success&&E(r.stats)}catch(r){console.error("Failed to load stats",r)}},P=async()=>{u(!0);try{const r=await Es(C);r.success&&(d(r.bookings||[]),r.stats&&m(r.stats))}catch{f.error("Failed to load bookings")}finally{u(!1)}},T=async(r,k)=>{A(r);try{const D=await Ps(r,k);D.success?(f.success("Status updated"),d(Z=>Z.map(U=>U.id===r?{...U,status:k}:U)),await P(),await B()):f.error(D.message||"Failed to update status")}catch{f.error("Failed to update status")}finally{A(null)}},Y=M.total_offerings||i.length,K=y.total||0,W=y.confirmed||0,v=async r=>{x(!0);try{if(r.bulk){const k=await le.bulkCreate(r.offerings);k.success?(f.success(`${k.created_count} offerings created successfully!`),await $(),await B(),o(!1)):f.error(k.message||"Failed to create offerings")}else if(r.id){const k=await le.update(r.id,r);k.success?(f.success("Offering updated successfully"),await $(),await B(),o(!1)):f.error(k.message||"Failed to update offering")}else{const k=await le.create(r);k.success?(f.success("Offering created successfully"),await $(),await B(),o(!1)):f.error(k.message||"Failed to create offering")}}catch(k){f.error(k.message||"An error occurred")}finally{x(!1),p(null)}},G=async r=>{if(window.confirm("Delete this food offering?"))try{const k=await le.delete(r);k.success?(f.success("Offering deleted"),await $(),await B()):f.error(k.message||"Failed to delete")}catch{f.error("Failed to delete offering")}},J=r=>{switch(r){case"confirmed":return"bg-emerald-50 text-emerald-600";case"completed":return"bg-blue-50 text-blue-600";case"cancelled":return"bg-red-50 text-red-500";default:return"bg-slate-100 text-slate-500"}},ee=r=>{const k=["th","st","nd","rd"],D=r%100;return r+(k[(D-20)%10]||k[D]||k[0])};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-slate-900",children:"Host Dashboard"}),e.jsx("p",{className:"text-xs font-medium text-slate-500",children:(s==null?void 0:s.place_name)||"Manage your Sehri distribution"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"rounded-xl bg-emerald-50 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-emerald-600",children:Y}),e.jsx("p",{className:"text-[10px] font-bold text-emerald-700 uppercase",children:"Offerings"})]}),e.jsxs("div",{className:"rounded-xl bg-slate-100 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-slate-700",children:K}),e.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:"Bookings"})]}),e.jsxs("div",{className:"rounded-xl bg-blue-50 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-blue-600",children:W}),e.jsx("p",{className:"text-[10px] font-bold text-blue-700 uppercase",children:"Confirmed"})]})]}),e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{onClick:()=>t("offerings"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${a==="offerings"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Food Offerings"}),e.jsx("button",{onClick:()=>t("bookings"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${a==="bookings"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Bookings"})]}),a==="offerings"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-bold text-slate-700",children:"My Offerings"}),e.jsxs("button",{onClick:()=>{p(null),o(!0)},className:"flex items-center gap-1.5 rounded-lg bg-emerald-600 px-3 py-2 text-xs font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:[e.jsx(De,{size:14}),"Add Day"]})]}),b?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(I,{size:24,className:"animate-spin text-emerald-600"})}):e.jsx("div",{className:"space-y-3",children:i.length>0?i.sort((r,k)=>r.ramzan_day-k.ramzan_day).map(r=>{var D,Z;const k=ye.find(U=>U.day===r.ramzan_day);return e.jsxs("div",{className:"rounded-xl border border-slate-100 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 text-xs font-black text-emerald-700",children:[ee(r.ramzan_day)," Ramzan"]}),e.jsx("span",{className:"text-[10px] text-slate-400",children:k==null?void 0:k.fullDate}),e.jsx("span",{className:"rounded bg-slate-100 px-1.5 py-0.5 text-[9px] font-bold text-slate-600 uppercase",children:r.meal_type})]}),e.jsx("span",{className:`rounded-lg px-2 py-0.5 text-[9px] font-black uppercase ${r.price_type==="free"?"bg-emerald-50 text-emerald-600":"bg-amber-50 text-amber-600"}`,children:r.price_type==="free"?"Free":`â‚¹${r.price_amount}`})]}),e.jsxs("p",{className:"mt-2 text-xs text-slate-600 italic",children:['"',r.menu_items,'"']}),r.message&&e.jsxs("p",{className:"mt-1 text-[10px] text-slate-400",children:["ðŸ’¬ ",r.message]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-3 text-[10px] text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ce,{size:10}),r.booked_count||0,"/",r.capacity]}),e.jsx("span",{className:`${(r.booked_count||0)>=r.capacity?"text-red-500":"text-emerald-600"}`,children:(r.booked_count||0)>=r.capacity?"Full":`${r.capacity-(r.booked_count||0)} left`}),r.timing_from&&r.timing_to&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(re,{size:10}),(D=r.timing_from)==null?void 0:D.slice(0,5)," - ",(Z=r.timing_to)==null?void 0:Z.slice(0,5)]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between border-t border-slate-50 pt-3",children:[e.jsx("span",{className:`rounded px-1.5 py-0.5 text-[9px] font-bold uppercase ${r.status==="active"?"bg-emerald-50 text-emerald-600":"bg-slate-100 text-slate-500"}`,children:r.status}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>{p(r),o(!0)},className:"rounded-lg p-1.5 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(os,{size:14})}),e.jsx("button",{onClick:()=>G(r.id),className:"rounded-lg p-1.5 text-slate-400 hover:bg-red-50 hover:text-red-500",children:e.jsx(cs,{size:14})})]})]})]},r.id)}):e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-12 text-center",children:[e.jsx(fe,{size:32,className:"mx-auto mb-3 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-500",children:"No offerings yet"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Add food offerings for specific Ramzan days"})]})})]}),a==="bookings"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-bold text-slate-700",children:"Manage Bookings"}),e.jsxs("button",{onClick:P,disabled:w,className:"flex items-center gap-1.5 rounded-lg bg-slate-100 px-3 py-2 text-xs font-bold text-slate-600 transition-all hover:bg-slate-200 active:scale-95 disabled:opacity-50",children:[e.jsx($e,{size:14,className:w?"animate-spin":""}),"Refresh"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"all",label:"All",count:y.total},{value:"confirmed",label:"Confirmed",count:y.confirmed},{value:"completed",label:"Completed",count:y.completed},{value:"cancelled",label:"Cancelled",count:y.cancelled}].map(r=>e.jsxs("button",{onClick:()=>R(r.value),className:`rounded-lg px-3 py-1.5 text-[10px] font-bold transition-all ${C===r.value?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[r.label," (",r.count||0,")"]},r.value))}),w?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(I,{size:24,className:"animate-spin text-emerald-600"})}):e.jsx("div",{className:"space-y-3",children:S.length>0?S.map(r=>{var k,D;return e.jsxs("div",{className:`rounded-xl border bg-white p-4 transition-all ${r.status==="cancelled"?"border-slate-200 opacity-70":"border-slate-100"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900",children:r.seeker_name}),e.jsxs("div",{className:"mt-1 flex flex-col gap-1 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{size:12}),e.jsx("a",{href:`tel:${r.seeker_phone}`,className:"hover:text-emerald-600",children:r.seeker_phone})]}),r.seeker_email&&e.jsx("span",{className:"text-[10px] text-slate-400",children:r.seeker_email})]})]}),e.jsx("span",{className:`rounded-lg px-2 py-1 text-[10px] font-bold uppercase ${J(r.status)}`,children:r.status})]}),r.menu_items&&e.jsxs("p",{className:"mt-2 text-xs text-slate-500 italic",children:['"',r.menu_items,'"']}),e.jsxs("div",{className:"mt-3 rounded-lg bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 font-bold text-emerald-700",children:[ee(r.ramzan_day)," Ramzan"]}),e.jsxs("span",{className:"flex items-center gap-1 text-slate-500",children:[e.jsx(de,{size:12}),r.formatted_date]}),e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5 text-[10px] font-bold text-slate-600 uppercase",children:r.meal_type})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs text-slate-600",children:[e.jsxs("span",{className:"flex items-center gap-1 font-bold",children:[e.jsx(ce,{size:12}),r.quantity," person(s)"]}),e.jsx("span",{className:"font-bold",children:r.total_amount>0?`â‚¹${r.total_amount}`:"Free"}),r.timing_from&&r.timing_to&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(re,{size:12}),(k=r.timing_from)==null?void 0:k.slice(0,5)," - ",(D=r.timing_to)==null?void 0:D.slice(0,5)]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsx("span",{className:"rounded bg-slate-100 px-2 py-1 font-mono text-[10px] text-slate-500",children:r.booking_code}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:["Booked: ",new Date(r.created_at).toLocaleDateString("en-IN")]})]}),r.status==="confirmed"&&e.jsxs("div",{className:"mt-4 flex gap-2 border-t border-slate-100 pt-4",children:[e.jsxs("button",{onClick:()=>T(r.id,"completed"),disabled:_===r.id,className:"flex flex-1 items-center justify-center gap-1.5 rounded-xl bg-emerald-600 py-2 text-xs font-bold text-white transition-all hover:bg-emerald-700 active:scale-95 disabled:opacity-50",children:[_===r.id?e.jsx(I,{size:14,className:"animate-spin"}):e.jsx(Te,{size:14}),"Mark Completed"]}),e.jsxs("button",{onClick:()=>T(r.id,"cancelled"),disabled:_===r.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-xs font-bold text-red-600 transition-all hover:bg-red-100 active:scale-95 disabled:opacity-50",children:[e.jsx(ds,{size:14}),"Cancel"]})]}),r.status==="cancelled"&&e.jsx("div",{className:"mt-3 border-t border-slate-100 pt-3",children:e.jsxs("button",{onClick:()=>T(r.id,"confirmed"),disabled:_===r.id,className:"flex items-center gap-1.5 text-xs font-bold text-emerald-600 hover:text-emerald-700",children:[_===r.id?e.jsx(I,{size:12,className:"animate-spin"}):e.jsx(Me,{size:12}),"Restore Booking"]})})]},r.id)}):e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-12 text-center",children:[e.jsx(ce,{size:32,className:"mx-auto mb-3 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-500",children:C==="all"?"No bookings yet":`No ${C} bookings`}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Guest reservations will appear here"})]})})]}),n&&e.jsx(Ks,{onClose:()=>{o(!1),p(null)},onSave:v,editingPoint:c,loading:F})]})}function Js({message:s,onClose:a}){return s?e.jsxs("div",{className:"animate-in fade-in slide-in-from-top-10 fixed top-8 left-1/2 z-[200] flex -translate-x-1/2 items-center gap-3 rounded-full bg-slate-950 px-8 py-4 text-white shadow-2xl",children:[e.jsx(Te,{className:"text-emerald-400",size:18}),e.jsx("span",{className:"text-sm font-black tracking-tight",children:s}),e.jsx("button",{onClick:a,className:"text-slate-500 transition-colors hover:text-white",children:e.jsx(Q,{size:16})})]}):null}const he="ramzania_user_location";async function Zs(s,a){try{const n=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${a}&zoom=14&addressdetails=1`,{headers:{"Accept-Language":"en"}})).json();if(n&&n.address){const{suburb:o,neighbourhood:c,city:p,town:i,village:z,state_district:S,state:d,country:y}=n.address;return{raw:n,area:o||c||p||i||z||S||""||"Unknown Area",fullAddress:n.display_name||"",city:p||i||z||S||"",state:d||"",country:y||"",addressDetails:n.address}}return null}catch(t){return console.error("Reverse geocoding failed:",t),null}}function Qs(){const[s,a]=l.useState(null),[t,n]=l.useState(null),[o,c]=l.useState(!1),[p,i]=l.useState(null),[z,S]=l.useState("prompt");l.useEffect(()=>{navigator.permissions&&navigator.permissions.query({name:"geolocation"}).then(b=>{S(b.state),b.onchange=()=>{S(b.state)}})},[]),l.useEffect(()=>{const b=localStorage.getItem(he);if(b)try{const N=JSON.parse(b);N.lat&&N.lng&&a({lat:N.lat,lng:N.lng}),N.address&&n(N.address)}catch{localStorage.removeItem(he)}},[]),l.useEffect(()=>{z==="granted"&&!s&&y()},[z]);const d=l.useCallback((b,N)=>{a(b),n(N),localStorage.setItem(he,JSON.stringify({lat:b.lat,lng:b.lng,address:N,timestamp:Date.now()}))},[]),y=l.useCallback(async()=>{if(!navigator.geolocation){i("Geolocation is not supported");return}c(!0),i(null),navigator.geolocation.getCurrentPosition(async b=>{const N={lat:b.coords.latitude,lng:b.coords.longitude},w=await Zs(N.lat,N.lng);d(N,w),c(!1)},b=>{b.code===b.PERMISSION_DENIED?(i("Location permission denied"),S("denied")):b.code===b.POSITION_UNAVAILABLE?i("Location unavailable"):b.code===b.TIMEOUT?i("Location request timed out"):i("Enable GPS to see distance"),c(!1)},{timeout:1e4,enableHighAccuracy:!0})},[d]),m=l.useCallback(()=>{y()},[y]),C=l.useCallback((b,N)=>{if(!s)return null;const w=6371,u=(b-s.lat)*Math.PI/180,F=(N-s.lng)*Math.PI/180,x=Math.sin(u/2)*Math.sin(u/2)+Math.cos(s.lat*Math.PI/180)*Math.cos(b*Math.PI/180)*Math.sin(F/2)*Math.sin(F/2),_=2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x));return w*_},[s]),R=l.useCallback(()=>{a(null),n(null),localStorage.removeItem(he)},[]);return{location:s,address:t,isLocating:o,error:p,permissionStatus:z,requestLocation:m,calculateDistance:C,clearLocation:R}}const Xs=()=>new Date().toISOString().split("T")[0];function et(){const[s,a]=l.useState([]),[t,n]=l.useState([]),[o,c]=l.useState([]),[p,i]=l.useState({sehar:"04:52 AM",iftar:"06:24 PM",area:"Chennai"}),[z,S]=l.useState(null),[d,y]=l.useState(!0),[m,C]=l.useState(null),[R,b]=l.useState([]),[N,w]=l.useState({area:"",place:""}),u=l.useRef(!1),F=l.useCallback(async(A={})=>{var M;try{const E=await te.fetchPoints(A);a(E.providers||[]),b(((M=E.filters)==null?void 0:M.areas)||[])}catch(E){console.error("Failed to fetch offerings:",E)}},[]),x=l.useCallback(async(A={})=>{var M;y(!0),C(null);try{const E=await te.fetchPoints(A);a(E.providers||[]),b(((M=E.filters)==null?void 0:M.areas)||[]),y(!1),Promise.all([te.fetchDuas(),te.fetchEvents(),te.fetchTimings(),te.fetchRamzanTimings(null,Xs())]).then(([$,B,P,T])=>{n($),c(B),i(P),T.success&&T.timing&&S(T.timing)}).catch($=>{console.error("Failed to fetch secondary data:",$)})}catch(E){C(E.message||"Failed to fetch data"),y(!1)}},[]);l.useEffect(()=>{u.current||(u.current=!0,x())},[]);const _=l.useCallback(async A=>{w(A),await F(A)},[F]);return{points:s,duas:t,events:o,timings:p,ramzanTiming:z,loading:d,error:m,availableAreas:R,filters:N,refetch:()=>x(N),refetchWithFilters:_,setFilters:_}}const je="ramzania_user";function it(){const[s,a]=l.useState(null),[t,n]=l.useState(!1),[o,c]=l.useState("home"),[p,i]=l.useState(null),[z,S]=l.useState(null),{points:d,duas:y,events:m,timings:C,ramzanTiming:R,availableAreas:b,refetchWithFilters:N,loading:w}=et(),{location:u,address:F,isLocating:x,requestLocation:_}=Qs();l.useEffect(()=>{const P=localStorage.getItem(je);if(P){const T=JSON.parse(P);a(T),c(T.role==="provider"?"dashboard":"home")}},[]);const A=P=>{a(P),localStorage.setItem(je,JSON.stringify(P)),n(!1),c(P.role==="provider"?"dashboard":"home")},M=()=>{localStorage.removeItem(je),a(null),c("home")},E=P=>{S(P),i(null)},$=P=>{S(`Marked interest for ${P.title}`)},B=()=>{if((s==null?void 0:s.role)==="provider")switch(o){case"events":return e.jsx(Fe,{events:m,onInterested:$});case"settings":return e.jsx(Us,{user:s,onUserUpdate:A});case"dashboard":default:return e.jsx(Ws,{user:s})}switch(o){case"duas":return e.jsx(Bs,{duas:y});case"events":return e.jsx(Fe,{events:m,onInterested:$});case"bookings":return e.jsx(Hs,{});case"home":default:return e.jsx(qs,{timings:C,ramzanTiming:R,points:d,onBook:i,availableAreas:b,onFilterChange:N,loading:w})}};return e.jsxs("div",{className:"min-h-screen bg-white pb-20 font-sans text-slate-900 selection:bg-emerald-100 sm:pb-16",children:[e.jsx(gs,{user:s,onLogout:M,onJoinClick:()=>n(!0),address:F,isLocating:x,onRequestLocation:_}),e.jsx("main",{className:"mx-auto max-w-lg px-4 py-6 sm:max-w-2xl sm:px-6 sm:py-8",children:B()}),e.jsx(fs,{activeView:o,onViewChange:c,userRole:s==null?void 0:s.role,user:s}),t&&e.jsx(Ss,{onClose:()=>n(!1),onSuccess:A}),p&&e.jsx(Is,{point:p,user:s,userLocation:u,onClose:()=>i(null),onSuccess:E,onLoginClick:()=>{i(null),n(!0)}}),e.jsx(Js,{message:z,onClose:()=>S(null)})]})}export{it as default};
