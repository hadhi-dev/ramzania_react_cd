import{j as e}from"./vendor-ui-B2jkoGl9.js";import{h as Qe,g as es,H as Oe,U as ye,T as $e,j as Ee,k as ss,L as q,l as re,f as ts,m as ve,n as ne,o as be,P as we,p as as,q as ls,r as rs,s as ue,X as Z,t as ns,a as Ie,u as le,v as de,w as is,x as Le,y as os,S as cs,z as ds,R as qe,B as xs,D as ms,E as Be,G as us,I as hs,J as ps}from"./vendor-other-JW_fR-Ym.js";import{a}from"./vendor-react-Cc-oBOCu.js";import{a as V,s as Re,t as b,b as I}from"./index-CZcr0QBJ.js";import"./vendor-recharts-LMBWezzC.js";const bs=[{id:"home",label:"Home",icon:Oe},{id:"find",label:"Find",icon:ye},{id:"request",label:"Request",icon:Ee},{id:"join",label:"Join",icon:ss}],fs=[{id:"home",label:"Home",icon:Oe},{id:"find",label:"Find",icon:ye},{id:"bookings",label:"Reserved",icon:$e},{id:"request",label:"Request",icon:Ee}],gs=[{id:"dashboard",label:"Dashboard",icon:Qe},{id:"settings",label:"Settings",icon:es}];function Ae({activeView:s,onViewChange:l,userRole:t="seeker",user:i=null}){let d;return t==="provider"?d=gs:i?d=fs:d=bs,e.jsxs(e.Fragment,{children:[e.jsx("nav",{className:"fixed bottom-0 z-50 flex w-full items-center justify-around border-t border-slate-800 bg-slate-950 px-4 py-3 pb-6 sm:hidden",children:d.map(c=>e.jsxs("button",{onClick:()=>l(c.id),className:`flex flex-col items-center gap-1 rounded-xl px-3 py-2 transition-all ${s===c.id?"text-amber-400":"text-slate-500 hover:text-slate-300"}`,"aria-label":c.label,children:[e.jsx(c.icon,{size:20}),e.jsx("span",{className:"text-[10px] font-bold",children:c.label})]},c.id))}),e.jsx("div",{className:"fixed bottom-6 left-1/2 z-50 hidden -translate-x-1/2 sm:block",children:e.jsx("div",{className:"flex gap-1 rounded-2xl border border-slate-800 bg-slate-950 p-1.5 text-white shadow-2xl shadow-slate-950/50",children:d.map(c=>e.jsx("button",{onClick:()=>l(c.id),className:`rounded-xl px-6 py-2.5 text-[10px] font-black tracking-wider uppercase transition-all ${s===c.id?"bg-amber-500 text-slate-900":"text-slate-400 hover:text-white"}`,children:c.label},c.id))})})]})}function js({user:s,onLogout:l,onJoinClick:t,address:i,isLocating:d,onRequestLocation:c}){return e.jsx("nav",{className:"sticky top-0 z-50 w-full border-b border-slate-100/50 bg-white/70 px-4 py-3 backdrop-blur-xl sm:px-6 sm:py-4",children:e.jsxs("div",{className:"mx-auto flex max-w-6xl items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center overflow-hidden rounded-xl bg-emerald-50 shadow-lg shadow-emerald-100 sm:h-10 sm:w-10 sm:rounded-2xl",children:e.jsx("img",{src:"/icon.svg",alt:"Ramzania",className:"h-7 w-7 sm:h-8 sm:w-8"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-lg leading-none font-black tracking-tighter sm:text-xl",children:["RAMZAN",e.jsx("span",{className:"text-emerald-600",children:"IA"})]}),e.jsx("button",{onClick:c,className:"mt-0.5 flex items-center gap-1 text-[9px] font-bold tracking-wide text-slate-400 transition-colors hover:text-emerald-600",children:d?e.jsxs(e.Fragment,{children:[e.jsx(q,{size:8,className:"animate-spin"}),e.jsx("span",{children:"Locating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{size:8}),e.jsx("span",{className:"max-w-[120px] truncate sm:max-w-[180px]",children:(i==null?void 0:i.city)||(i==null?void 0:i.area)||"Set Location"})]})})]})]}),e.jsx("div",{className:"flex items-center gap-3 sm:gap-4",children:s?e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsxs("div",{className:"hidden text-right sm:block",children:[e.jsx("p",{className:"text-xs font-black text-slate-900",children:s.name}),e.jsx("p",{className:"text-[10px] font-bold text-emerald-600 uppercase",children:s.role==="provider"?"HOST":"GUEST"})]}),e.jsx("button",{onClick:l,className:"flex h-9 w-9 items-center justify-center rounded-xl border border-slate-200 bg-slate-50 text-slate-400 transition-all hover:text-red-500 sm:h-10 sm:w-10 sm:rounded-2xl","aria-label":"Logout",children:e.jsx(ts,{size:16,className:"sm:h-[18px] sm:w-[18px]"})})]}):e.jsxs("button",{onClick:t,className:"flex items-center justify-center gap-1.5 rounded-xl bg-emerald-600 px-4 py-2 text-xs font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-95 sm:gap-2 sm:rounded-2xl sm:px-5 sm:text-sm",children:[e.jsx(ve,{size:14,className:"sm:h-4 sm:w-4"}),"Join"]})})]})})}function Ns({point:s,onBook:l,compact:t=!1}){const i=d=>{const c=["th","st","nd","rd"],x=d%100;return d+(c[(x-20)%10]||c[x]||c[0])};return e.jsxs("div",{className:`flex flex-col border border-t-4 border-slate-100 border-t-emerald-500 bg-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-slate-200/40 ${t?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsxs("div",{className:`flex items-start justify-between ${t?"mb-2":"mb-4"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`leading-tight font-black text-slate-900 ${t?"text-base":"text-xl"}`,children:s.name}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[s.next_available_day&&e.jsxs("span",{className:"rounded-md bg-emerald-100 px-1.5 py-0.5 text-[10px] font-bold text-emerald-700",children:["Next: ",i(s.next_available_day)," Ramzan"]}),s.next_available_date&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-slate-400",children:[e.jsx(ne,{size:10}),s.next_available_date]})]})]}),e.jsx("span",{className:`rounded-lg font-black uppercase ${t?"px-1.5 py-0.5 text-[8px]":"rounded-xl px-2 py-1 text-[9px]"} ${s.price===0?"bg-emerald-50 text-emerald-600":"bg-amber-50 text-amber-600"}`,children:s.price===0?"Free":`From ‚Çπ${s.price}`})]}),e.jsxs("div",{className:`flex-1 bg-slate-50 text-slate-600 ${t?"mb-3 rounded-xl p-3 text-xs leading-relaxed":"mb-6 rounded-2xl p-4 text-sm leading-relaxed"}`,children:[s.menu_items&&e.jsx("p",{className:"font-medium text-slate-700",children:s.menu_items}),s.message&&e.jsxs("p",{className:"mt-1 text-[11px] text-slate-500 italic",children:['"',s.message,'"']}),!s.menu_items&&!s.message&&e.jsx("span",{className:"text-slate-400 italic",children:"Menu details available on booking"})]}),e.jsxs("div",{className:"mb-3 flex flex-wrap items-center gap-2 text-[10px] text-slate-500",children:[s.distance!==null&&s.distance!==void 0&&e.jsxs("span",{className:"flex items-center gap-1 rounded bg-blue-50 px-1.5 py-0.5 font-bold text-blue-600",children:["üìç ",s.distance," km"]}),s.total_offerings&&e.jsxs("span",{className:"flex items-center gap-1 rounded bg-emerald-50 px-1.5 py-0.5 text-emerald-600",children:[e.jsx(be,{size:10})," ",s.total_offerings," days"]}),s.area&&e.jsxs("span",{className:"rounded bg-slate-100 px-1.5 py-0.5",children:["üìç ",s.area]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:`grid gap-2 ${s.latitude&&s.longitude?"grid-cols-3":"grid-cols-2"}`,children:[e.jsxs("button",{onClick:()=>globalThis.open(`tel:${s.phone}`),className:`flex items-center justify-center gap-1.5 rounded-xl border border-slate-200 bg-white font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-95 ${t?"px-2 py-2 text-xs":"px-4 py-3.5 text-sm"}`,children:[e.jsx(we,{size:t?12:16})," Call"]}),e.jsxs("button",{onClick:()=>globalThis.open(`https://wa.me/${s.phone.replaceAll(/\D/g,"")}`),className:`flex items-center justify-center gap-1.5 rounded-xl border border-emerald-100 bg-white font-bold text-emerald-600 transition-all hover:bg-emerald-50 active:scale-95 ${t?"px-2 py-2 text-xs":"px-4 py-3.5 text-sm"}`,children:[e.jsx(as,{size:t?12:16})," Chat"]}),s.latitude&&s.longitude&&e.jsxs("button",{onClick:()=>globalThis.open(`https://www.google.com/maps/dir/?api=1&destination=${s.latitude},${s.longitude}`),className:`flex items-center justify-center gap-1.5 rounded-xl border border-blue-100 bg-white font-bold text-blue-600 transition-all hover:bg-blue-50 active:scale-95 ${t?"px-2 py-2 text-xs":"px-4 py-3.5 text-sm"}`,children:[e.jsx(re,{size:t?12:16})," Map"]})]}),e.jsx("button",{onClick:()=>l(s),disabled:!s.isBookable,className:`flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-95 disabled:bg-emerald-300 disabled:opacity-50 ${t?"px-3 py-2 text-xs":"px-6 py-3.5 text-sm"}`,children:s.isBookable?"Reserve Sehri":"Info Only"})]})]})}function ys({time:s,compact:l=!1}){return e.jsxs("div",{className:`group relative overflow-hidden border-none bg-emerald-600 text-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-emerald-200/40 ${l?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsx(ls,{size:l?60:100,className:"absolute -top-4 -right-4 text-emerald-500/30 transition-transform duration-500 group-hover:scale-110"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("span",{className:`block font-black tracking-wider text-emerald-200 uppercase ${l?"mb-1 text-[8px]":"mb-8 text-[10px]"}`,children:"Imsak (Sehar)"}),e.jsx("h4",{className:`font-black tracking-tight ${l?"text-3xl":"text-5xl"}`,children:s}),!l&&e.jsx("p",{className:"mt-1 text-sm font-medium text-emerald-100/80",children:"Stop eating and intend to fast."})]})]})}function vs({time:s,compact:l=!1}){return e.jsxs("div",{className:`group relative overflow-hidden border-none bg-slate-950 text-white shadow-sm transition-all duration-300 hover:shadow-lg hover:shadow-slate-200/40 ${l?"rounded-2xl p-4":"rounded-[2.5rem] p-6"}`,children:[e.jsx(rs,{size:l?60:100,className:"absolute -top-4 -right-4 text-slate-800/50 transition-transform duration-500 group-hover:rotate-12"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("span",{className:`block font-black tracking-wider text-slate-400 uppercase ${l?"mb-1 text-[8px]":"mb-8 text-[10px]"}`,children:"Maghrib (Iftar)"}),e.jsx("h4",{className:`font-black tracking-tight ${l?"text-3xl":"text-5xl"}`,children:s}),!l&&e.jsx("p",{className:"mt-1 text-sm font-medium text-slate-400/80",children:"Break your fast with the sun's set."})]})]})}function ws({timings:s,compact:l=!1}){return e.jsxs("div",{className:`grid grid-cols-2 ${l?"gap-3":"gap-4"}`,children:[e.jsx(ys,{time:s.sehar,compact:l}),e.jsx(vs,{time:s.iftar,compact:l})]})}async function ks(s,l){try{const i=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${l}&zoom=18&addressdetails=1`,{headers:{"Accept-Language":"en"}})).json();if(i!=null&&i.address){const{road:d,suburb:c,neighbourhood:x,city:o,town:k,village:h,state_district:n,state:p,postcode:m,county:N}=i.address;return{street:d||"",area:c||x||N||"",city:o||k||h||n||"",pincode:m||"",state:p||""}}return null}catch(t){return console.error("Reverse geocoding failed:",t),null}}function Fe({onClose:s,onSuccess:l}){const[t,i]=a.useState("CHOICE"),[d,c]=a.useState(!1),[x,o]=a.useState(""),[k,h]=a.useState(""),[n,p]=a.useState(""),[m,N]=a.useState("seeker"),[R,y]=a.useState(""),[w,S]=a.useState(""),[f,F]=a.useState(""),[u,z]=a.useState(""),[A,D]=a.useState(""),[O,E]=a.useState(""),[M,B]=a.useState(""),[T,U]=a.useState(""),[W,Y]=a.useState(""),[C,G]=a.useState(null),[K,Q]=a.useState(null),[r,_]=a.useState(!1),[$,J]=a.useState(""),[X,ke]=a.useState(""),[fe,Se]=a.useState(""),[Te,Ce]=a.useState(""),[ie,me]=a.useState(["","","","","",""]),[oe,_e]=a.useState(""),ge=a.useRef([]),ze=a.useCallback(async()=>{if(navigator.geolocation){_(!0);try{const g=await new Promise((L,Ze)=>{navigator.geolocation.getCurrentPosition(L,Ze,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),{latitude:j,longitude:v}=g.coords;G(j),Q(v);const P=await ks(j,v);P&&(E(P.street),B(P.area),U(P.city),Y(P.pincode))}catch(g){console.log("Location fetch failed:",g.message)}finally{_(!1)}}},[]);a.useEffect(()=>{t==="REGISTER"&&ze()},[t,ze]);const Ge=(g,j)=>{var L;const v=g.target.value;if(isNaN(v))return;const P=[...ie];P[j]=v.slice(-1),me(P),v&&j<5&&((L=ge.current[j+1])==null||L.focus())},Xe=(g,j)=>{var v;g.key==="Backspace"&&!ie[j]&&j>0&&((v=ge.current[j-1])==null||v.focus())},He=async g=>{var j,v;g.preventDefault(),o(""),c(!0);try{const P=await V.login({email:k,password:n});if(P.success)P.token&&Re.set("auth_token",P.token),b.success("Welcome back!",{description:`Logged in as ${P.user.name}`}),l(P.user);else{const L=P.message||"Login failed";o(L),b.error("Login Failed",{description:L})}}catch(P){const L=P.message||((v=(j=P.errors)==null?void 0:j.email)==null?void 0:v[0])||"Login failed. Please try again.";o(L),b.error("Login Failed",{description:L})}finally{c(!1)}},Ve=async g=>{var j,v;if(g.preventDefault(),o(""),w.length<6){o("Password must be at least 6 characters"),b.error("Validation Error",{description:"Password must be at least 6 characters"});return}c(!0);try{const P=await V.register({email:R,password:w,name:f,contact:u,role:m,place_name:m==="provider"?A:null,street:O,area:M,city:T,pincode:W,latitude:C,longitude:K});if(P.success)b.success("OTP Sent!",{description:"Please check your email for the verification code"}),_e("register"),me(["","","","","",""]),i("OTP");else{const L=P.message||"Registration failed";o(L),b.error("Registration Failed",{description:L})}}catch(P){const L=P.message||((v=(j=P.errors)==null?void 0:j.email)==null?void 0:v[0])||"Registration failed. Please try again.";o(L),b.error("Registration Failed",{description:L})}finally{c(!1)}},Ue=async g=>{if(g.preventDefault(),o(""),!$){o("Please enter your email"),b.error("Email Required",{description:"Please enter your registered email address"});return}c(!0);try{const j=await V.forgotPassword($);if(j.success)b.success("OTP Sent!",{description:"Please check your email for the reset code"}),_e("forgot"),me(["","","","","",""]),i("OTP");else{const v=j.message||"Failed to send OTP";o(v),b.error("Failed",{description:v})}}catch(j){const v=j.message||"Failed to send OTP. Please try again.";o(v),b.error("Failed",{description:v})}finally{c(!1)}},We=async()=>{const g=ie.join("");if(!(g.length<6)){o(""),c(!0);try{if(oe==="register"){const j=await V.verifyRegistrationOtp(R,g);if(j.success)j.token&&Re.set("auth_token",j.token),b.success("Account Verified!",{description:"Welcome to Ramzania!"}),l(j.user);else{const v=j.message||"Invalid OTP";o(v),b.error("Verification Failed",{description:v})}}else if(oe==="forgot"){const j=await V.verifyForgotPasswordOtp($,g);if(j.success)b.success("OTP Verified!",{description:"Now set your new password"}),Ce(j.reset_token),i("RESET_PASSWORD");else{const v=j.message||"Invalid OTP";o(v),b.error("Verification Failed",{description:v})}}}catch(j){const v=j.message||"OTP verification failed. Please try again.";o(v),b.error("Verification Failed",{description:v})}finally{c(!1)}}},Ye=async g=>{if(g.preventDefault(),o(""),X.length<6){o("Password must be at least 6 characters"),b.error("Validation Error",{description:"Password must be at least 6 characters"});return}if(X!==fe){o("Passwords do not match"),b.error("Validation Error",{description:"Passwords do not match"});return}c(!0);try{const j=await V.resetPassword($,Te,X,fe);if(j.success)b.success("Password Reset!",{description:"You can now login with your new password"}),i("LOGIN"),o(""),J(""),ke(""),Se(""),Ce("");else{const v=j.message||"Password reset failed";o(v),b.error("Reset Failed",{description:v})}}catch(j){const v=j.message||"Password reset failed. Please try again.";o(v),b.error("Reset Failed",{description:v})}finally{c(!1)}},Ke=async()=>{c(!0),o("");try{let g;if(oe==="register"?g=await V.resendRegistrationOtp(R):g=await V.forgotPassword($),g.success)b.success("OTP Resent!",{description:"Please check your email for the new code"}),me(["","","","","",""]);else{const j=g.message||"Failed to resend OTP";o(j),b.error("Failed",{description:j})}}catch{const j="Failed to resend OTP. Please try again.";o(j),b.error("Failed",{description:j})}finally{c(!1)}},ce="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",H="w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",ee="flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 px-4 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",Je={CHOICE:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/icon.svg",alt:"Ramzania",className:"h-12 w-12"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black tracking-tight text-slate-900",children:"Join Ramzania"}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Your portal to community Sehar."})]})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("button",{className:ee,onClick:()=>i("LOGIN"),children:"Sign In"}),e.jsx("button",{className:"flex w-full items-center justify-center gap-2 rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-[0.98]",onClick:()=>i("REGISTER"),children:"Create Account"})]})]}),LOGIN:e.jsxs("form",{onSubmit:He,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>i("CHOICE"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ue,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Sign In"})]}),x&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:x}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"email",required:!0,placeholder:"Email address",className:ce,value:k,onChange:g=>h(g.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Password",className:ce,value:n,onChange:g=>p(g.target.value)})]}),e.jsx("button",{type:"submit",disabled:d,className:ee,children:d?e.jsx(q,{className:"animate-spin",size:18}):"Sign In"}),e.jsx("button",{type:"button",onClick:()=>i("FORGOT"),className:"w-full text-center text-[10px] font-bold tracking-wide text-slate-400 uppercase hover:text-emerald-600",children:"Forgot Password?"})]}),REGISTER:e.jsxs("form",{onSubmit:Ve,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>i("CHOICE"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ue,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Create Account"})]}),x&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:x}),e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{type:"button",onClick:()=>N("seeker"),className:`flex-1 rounded-lg py-2.5 text-xs font-bold transition-all ${m==="seeker"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"üçΩÔ∏è Guest"}),e.jsx("button",{type:"button",onClick:()=>N("provider"),className:`flex-1 rounded-lg py-2.5 text-xs font-bold transition-all ${m==="provider"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"üè† Host"})]}),e.jsx("p",{className:"text-[10px] font-medium text-slate-400",children:m==="seeker"?"Find & reserve Sehri near you":"Arrange Sehri for guests in your area"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"email",required:!0,placeholder:"Email address",className:H,value:R,onChange:g=>y(g.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Password (min 6 chars)",className:H,value:w,onChange:g=>S(g.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Full Name",className:H,value:f,onChange:g=>F(g.target.value)}),e.jsx("input",{type:"tel",required:!0,placeholder:"Contact Number",className:H,value:u,onChange:g=>z(g.target.value)})]}),m==="provider"&&e.jsx("input",{type:"text",required:!0,placeholder:"Place Name (e.g., Restaurant, Masjid,..)",className:H,value:A,onChange:g=>D(g.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500",children:"Address Details"}),r&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(q,{size:10,className:"animate-spin"}),"Fetching location..."]}),!r&&T&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600",children:[e.jsx(re,{size:10}),"Auto-filled"]})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Street / Door No",className:H,value:O,onChange:g=>E(g.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Area / Locality",className:H,value:M,onChange:g=>B(g.target.value)}),e.jsx("input",{type:"text",required:!0,placeholder:"City",className:H,value:T,onChange:g=>U(g.target.value)})]}),e.jsx("input",{type:"text",required:!0,placeholder:"Pincode",className:H,value:W,onChange:g=>Y(g.target.value)})]}),e.jsx("button",{type:"submit",disabled:d,className:ee,children:d?e.jsx(q,{className:"animate-spin",size:18}):"Continue ‚Üí"})]}),FORGOT:e.jsxs("form",{onSubmit:Ue,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>i("LOGIN"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ue,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Reset Password"})]}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Enter your email to receive a verification code."}),x&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:x}),e.jsx("input",{type:"email",required:!0,placeholder:"Registered email",className:ce,value:$,onChange:g=>J(g.target.value)}),e.jsx("button",{type:"submit",disabled:d,className:ee,children:d?e.jsx(q,{className:"animate-spin",size:18}):"Send OTP"})]}),OTP:e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>i(oe==="register"?"REGISTER":"FORGOT"),className:"-ml-2 p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ue,{size:18})}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Verify Email"})]}),e.jsxs("p",{className:"text-sm font-medium text-slate-500",children:["Enter the 6-digit code sent to ",e.jsx("span",{className:"font-bold text-slate-700",children:oe==="register"?R:$})]}),x&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:x}),e.jsx("div",{className:"flex justify-between gap-2",children:ie.map((g,j)=>e.jsx("input",{ref:v=>ge.current[j]=v,type:"text",inputMode:"numeric",maxLength:1,className:"h-12 w-full rounded-xl border border-slate-200 bg-slate-50 text-center text-lg font-bold transition-all outline-none focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",value:g,onChange:v=>Ge(v,j),onKeyDown:v=>Xe(v,j)},j))}),e.jsx("button",{type:"button",onClick:We,disabled:d||ie.join("").length<6,className:ee,children:d?e.jsx(q,{className:"animate-spin",size:18}):"Verify"}),e.jsx("button",{type:"button",onClick:Ke,disabled:d,className:"w-full text-center text-[10px] font-bold tracking-wide text-slate-400 uppercase hover:text-emerald-600",children:"Resend Code"})]}),RESET_PASSWORD:e.jsxs("form",{onSubmit:Ye,className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ns,{size:20,className:"text-emerald-600"}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"New Password"})]}),e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Create a new password for your account."}),x&&e.jsx("p",{className:"rounded-lg bg-red-50 px-3 py-2 text-xs font-medium text-red-600",children:x}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"password",required:!0,placeholder:"New Password (min 6 chars)",className:ce,value:X,onChange:g=>ke(g.target.value)}),e.jsx("input",{type:"password",required:!0,placeholder:"Confirm Password",className:ce,value:fe,onChange:g=>Se(g.target.value)})]}),e.jsx("button",{type:"submit",disabled:d,className:ee,children:d?e.jsx(q,{className:"animate-spin",size:18}):"Reset Password"})]})};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-slate-900/40 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-4 w-full max-w-md rounded-2xl border border-slate-100 bg-white p-6 shadow-xl sm:rounded-3xl sm:p-8",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-emerald-50 text-emerald-600",children:e.jsx(ve,{size:20})}),e.jsx("button",{onClick:s,className:"rounded-full p-2 text-slate-300 transition-all hover:bg-slate-100 hover:text-slate-500",children:e.jsx(Z,{size:18})})]}),Je[t]]})})}const xe=s=>new Promise(l=>setTimeout(l,s)),Ss=async(s={})=>{try{const l=new URLSearchParams;s.area&&l.append("area",s.area),s.place&&l.append("place",s.place);const t=l.toString(),i=`/home/offerings${t?`?${t}`:""}`,d=await I.get(i,{auth:!1});return d.success?{providers:d.providers||[],filters:d.filters||{},current_ramzan_day:d.current_ramzan_day,ramzan_start_date:d.ramzan_start_date}:{providers:Me(),filters:{}}}catch(l){return console.error("Failed to fetch providers from API, using mock data:",l),{providers:Me(),filters:{}}}},Cs=async(s=null,l=null)=>{try{const t=new URLSearchParams;s&&t.append("day",s),l&&t.append("date",l);const i=t.toString(),d=i?`/home/timings?${i}`:"/home/timings",c=await I.get(d,{auth:!1});return c.success?c:{success:!1,timing:null}}catch(t){return console.error("Failed to fetch Ramzan timings:",t),{success:!1,timing:null}}},_s=async()=>{try{const s=await I.get("/home/timings/all",{auth:!1});return s.success?s.timings||[]:[]}catch(s){return console.error("Failed to fetch all Ramzan timings:",s),[]}},zs=async(s,l={})=>{try{const t=new URLSearchParams;l.lat&&t.append("lat",l.lat),l.lng&&t.append("lng",l.lng);const i=t.toString(),d=`/home/provider/${s}/offerings${i?`?${i}`:""}`,c=await I.get(d,{auth:!1});return c.success?c:{success:!1,offerings:[]}}catch(t){return console.error("Failed to fetch provider offerings:",t),{success:!1,offerings:[]}}},Rs=async(s,l)=>I.post("/bookings",{offering_id:s,quantity:l}),As=async()=>I.get("/bookings/my"),Fs=async s=>I.post(`/bookings/${s}/cancel`),Ms=async(s="all")=>{const l=s==="all"?"/bookings/provider":`/bookings/provider?status=${s}`;return I.get(l)},Ps=async(s,l)=>I.put(`/bookings/${s}/status`,{status:l}),Me=()=>[],Ds=async()=>(await xe(200),[{id:1,title:"Dua for Suhoor (Intention for Fasting)",arabic:"ŸàŸéÿ®ŸêÿµŸéŸàŸíŸÖŸê ÿ∫ŸéÿØŸç ŸÜŸéŸàŸéŸäŸíÿ™Ÿè ŸÖŸêŸÜŸí ÿ¥ŸéŸáŸíÿ±Ÿê ÿ±ŸéŸÖŸéÿ∂ŸéÿßŸÜŸé",transliteration:"Wa bisawmi ghadin nawaitu min shahri Ramadan",english:"I intend to fast tomorrow for the month of Ramadan."},{id:2,title:"Dua for Iftar (Breaking Fast)",arabic:"ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ•ŸêŸÜŸêŸëŸä ŸÑŸéŸÉŸé ÿµŸèŸÖŸíÿ™Ÿè ŸàŸéÿ®ŸêŸÉŸé ÿ¢ŸÖŸéŸÜŸíÿ™Ÿè ŸàŸéÿπŸéŸÑŸéŸäŸíŸÉŸé ÿ™ŸéŸàŸéŸÉŸéŸëŸÑŸíÿ™Ÿè ŸàŸéÿπŸéŸÑŸéŸâ ÿ±Ÿêÿ≤ŸíŸÇŸêŸÉŸé ÿ£ŸéŸÅŸíÿ∑Ÿéÿ±Ÿíÿ™Ÿè",transliteration:"Allahumma inni laka sumtu wa bika aamantu wa ‚Äòalayka tawakkaltu wa ‚Äòala rizqika aftartu",english:"O Allah, I fasted for You, I believe in You, I trust in You, and I break my fast with Your provision."},{id:3,title:"Dua After Breaking Fast (Authentic)",arabic:"ÿ∞ŸéŸáŸéÿ®Ÿé ÿßŸÑÿ∏ŸéŸëŸÖŸéÿ£Ÿè ŸàŸéÿßÿ®Ÿíÿ™ŸéŸÑŸéŸëÿ™Ÿê ÿßŸÑŸíÿπŸèÿ±ŸèŸàŸÇŸè ŸàŸéÿ´Ÿéÿ®Ÿéÿ™Ÿé ÿßŸÑŸíÿ£Ÿéÿ¨Ÿíÿ±Ÿè ÿ•ŸêŸÜŸí ÿ¥Ÿéÿßÿ°Ÿé ÿßŸÑŸÑŸéŸëŸáŸè",transliteration:"Dhahaba adh-dhama‚Äôu wabtallatil ‚Äòurooq wa thabatal ajru in sha Allah",english:"The thirst is gone, the veins are moistened, and the reward is confirmed, if Allah wills."},{id:4,title:"Dua for Laylatul Qadr",arabic:"ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ•ŸêŸÜŸéŸëŸÉŸé ÿπŸéŸÅŸèŸàŸåŸë ÿ™Ÿèÿ≠Ÿêÿ®ŸèŸë ÿßŸÑŸíÿπŸéŸÅŸíŸàŸé ŸÅŸéÿßÿπŸíŸÅŸè ÿπŸéŸÜŸêŸëŸä",transliteration:"Allahumma innaka afuwwun tuhibbul afwa fa‚Äôfu anni",english:"O Allah, You are Most Forgiving, and You love forgiveness; so forgive me."},{id:5,title:"Dua for Forgiveness",arabic:"ÿ£Ÿéÿ≥Ÿíÿ™Ÿéÿ∫ŸíŸÅŸêÿ±Ÿè ÿßŸÑŸÑŸéŸëŸáŸé",transliteration:"Astaghfirullah",english:"I seek forgiveness from Allah."},{id:6,title:"Dua for Mercy",arabic:"ÿ±Ÿéÿ®ŸêŸë ÿßÿ∫ŸíŸÅŸêÿ±Ÿí ŸàŸéÿßÿ±Ÿíÿ≠ŸéŸÖŸí ŸàŸéÿ£ŸéŸÜŸíÿ™Ÿé ÿÆŸéŸäŸíÿ±Ÿè ÿßŸÑÿ±ŸéŸëÿßÿ≠ŸêŸÖŸêŸäŸÜŸé",transliteration:"Rabbighfir warham wa anta khayrur rahimeen",english:"My Lord, forgive and have mercy, for You are the Best of the merciful."},{id:7,title:"Dua for Guidance",arabic:"ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿßŸáŸíÿØŸêŸÜŸêŸä ŸàŸéÿ≥ŸéÿØŸêŸëÿØŸíŸÜŸêŸä",transliteration:"Allahumma ihdini wa saddidni",english:"O Allah, guide me and keep me steadfast."},{id:8,title:"Dua for Acceptance of Fasting",arabic:"ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ™ŸéŸÇŸéÿ®ŸéŸëŸÑŸí ŸÖŸêŸÜŸéŸëÿß ÿ•ŸêŸÜŸéŸëŸÉŸé ÿ£ŸéŸÜŸíÿ™Ÿé ÿßŸÑÿ≥ŸéŸëŸÖŸêŸäÿπŸè ÿßŸÑŸíÿπŸéŸÑŸêŸäŸÖŸè",transliteration:"Allahumma taqabbal ŸÖŸÜÿß innaka antas-samee‚Äôul aleem",english:"O Allah, accept from us. Indeed, You are the All-Hearing, All-Knowing."}]),Os=async()=>(await xe(200),[]),$s=async(s="Chennai")=>(await xe(100),{sehar:"4:52 AM",iftar:"6:24 PM",area:s}),Es=async(s,l)=>(await xe(1e3),{success:!0,user:{email:s,role:s.includes("admin")?"admin":"seeker",name:s.split("@")[0],token:"token-"+Date.now()}}),Is=async(s,l)=>(await xe(500),{success:!0,bookingId:`BK-${Date.now()}`,message:"Spot booked successfully!"}),se={fetchPoints:Ss,fetchDuas:Ds,fetchEvents:Os,fetchTimings:$s,fetchRamzanTimings:Cs,fetchAllRamzanTimings:_s,login:Es,bookSpot:Is};function Pe({point:s,user:l,userLocation:t,onClose:i,onSuccess:d,onLoginClick:c}){const[x,o]=a.useState(!0),[k,h]=a.useState([]),[n,p]=a.useState(null),[m,N]=a.useState(null),[R,y]=a.useState(1),[w,S]=a.useState(!1);a.useEffect(()=>{(async()=>{o(!0);const z=s.provider_id||s.id,A={};t!=null&&t.lat&&(t!=null&&t.lng)&&(A.lat=t.lat,A.lng=t.lng);const D=await zs(z,A);D.success&&(p(D.provider),h(D.offerings||[])),o(!1)})()},[s,t]);const f=u=>{const z=["th","st","nd","rd"],A=u%100;return u+(z[(A-20)%10]||z[A]||z[0])},F=async()=>{if(!m){b.error("Please select a date");return}S(!0);try{const u=await Rs(m.id,R);u.success?(b.success("Spot Booked!",{description:`Booking code: ${u.booking.booking_code}`}),d==null||d(`Spot booked for ${f(m.ramzan_day)} Ramzan!`)):b.error("Booking Failed",{description:u.message})}catch(u){u.status===401?(b.error("Please login to book"),c==null||c()):b.error("Booking Failed",{description:u.message})}finally{S(!1)}};return l?e.jsx("div",{className:"fixed inset-0 z-100 flex items-end justify-center bg-slate-900/30 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-10 max-h-[90vh] w-full max-w-md overflow-hidden rounded-3xl border border-slate-100 bg-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 p-4",children:[e.jsx("h2",{className:"text-lg font-black text-slate-900",children:"Reserve Sehri"}),e.jsx("button",{onClick:i,className:"rounded-full p-2 text-slate-400 hover:bg-slate-100",children:e.jsx(Z,{size:18})})]}),e.jsxs("div",{className:"bg-emerald-50 px-4 py-3",children:[e.jsx("p",{className:"font-black text-emerald-800",children:(n==null?void 0:n.name)||s.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-emerald-600",children:[e.jsx("span",{children:(n==null?void 0:n.area)||s.area}),(n==null?void 0:n.distance)!==null&&(n==null?void 0:n.distance)!==void 0&&e.jsxs("span",{className:"flex items-center gap-0.5 rounded bg-emerald-100 px-1.5 py-0.5 text-emerald-700",children:[e.jsx(re,{size:10})," ",n.distance," km"]})]})]}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto p-4",children:x?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(q,{size:24,className:"animate-spin text-emerald-600"})}):k.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(be,{size:32,className:"mx-auto mb-2 text-slate-300"}),e.jsx("p",{className:"text-sm text-slate-500",children:"No available dates"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"mb-3 text-xs font-bold text-slate-500",children:"Select a date:"}),k.map(u=>e.jsxs("button",{disabled:!u.is_bookable,onClick:()=>N(u),className:`w-full rounded-xl border p-3 text-left transition-all ${(m==null?void 0:m.id)===u.id?"border-emerald-500 bg-emerald-50 ring-2 ring-emerald-200":u.is_bookable?"border-slate-200 bg-white hover:border-emerald-300 hover:bg-emerald-50/50":"cursor-not-allowed border-slate-100 bg-slate-50 opacity-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 text-xs font-black text-emerald-700",children:f(u.ramzan_day)}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold text-slate-800",children:[u.formatted_date,e.jsxs("span",{className:"ml-1 text-[10px] font-normal text-slate-400",children:["(",u.day_name,")"]})]}),e.jsx("p",{className:"text-[10px] text-slate-500",children:u.meal_type})]})]}),e.jsxs("div",{className:"text-right",children:[(m==null?void 0:m.id)===u.id&&e.jsx(Ie,{size:16,className:"text-emerald-600"}),!m||m.id!==u.id?e.jsx("span",{className:`text-xs font-bold ${u.is_bookable?"text-emerald-600":"text-red-500"}`,children:u.is_bookable?`${u.available_slots} spots`:"Full"}):null]})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-1.5 text-[10px] text-slate-500",children:[u.timing&&e.jsxs("span",{className:"flex items-center gap-0.5 rounded bg-slate-100 px-1.5 py-0.5",children:[e.jsx(le,{size:10})," ",u.timing]}),e.jsx("span",{className:`rounded px-1.5 py-0.5 ${u.price_type==="free"?"bg-emerald-100 text-emerald-600":"bg-amber-100 text-amber-600"}`,children:u.price_type==="free"?"Free":`‚Çπ${u.price_amount}`})]}),e.jsxs("p",{className:"mt-2 text-[10px] text-slate-400 italic",children:['"',u.menu_items,'"']})]},u.id))]})}),m&&e.jsxs("div",{className:"border-t border-slate-100 bg-slate-50 p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between rounded-xl bg-white p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{size:16,className:"text-slate-400"}),e.jsx("span",{className:"text-sm font-bold text-slate-700",children:"No. of Persons"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>y(u=>Math.max(1,u-1)),className:"rounded-lg bg-slate-100 p-1.5 text-slate-600 hover:bg-slate-200",children:e.jsx(is,{size:14})}),e.jsx("span",{className:"w-6 text-center text-sm font-black text-slate-900",children:R}),e.jsx("button",{type:"button",onClick:()=>y(u=>Math.min(m.available_slots,Math.min(10,u+1))),className:"rounded-lg bg-slate-100 p-1.5 text-slate-600 hover:bg-slate-200",children:e.jsx(Le,{size:14})})]})]}),e.jsxs("div",{className:"mb-4 flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-slate-500",children:[f(m.ramzan_day)," Ramzan ‚Ä¢ ",m.meal_type]}),e.jsx("span",{className:"font-bold text-slate-900",children:m.price_type==="free"?"Free":`‚Çπ${(m.price_amount||0)*R}`})]}),e.jsx("button",{onClick:F,disabled:w,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",children:w?e.jsxs(e.Fragment,{children:[e.jsx(q,{size:16,className:"animate-spin"}),"Booking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{size:16}),"Confirm Booking"]})})]})]})}):e.jsx("div",{className:"fixed inset-0 z-100 flex items-end justify-center bg-slate-900/30 p-4 backdrop-blur-sm sm:items-center",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-10 w-full max-w-md rounded-3xl border border-slate-100 bg-white p-6 shadow-lg",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Book Spot"}),e.jsx("button",{onClick:i,className:"rounded-full p-2 text-slate-400 hover:bg-slate-100",children:e.jsx(Z,{size:18})})]}),e.jsxs("div",{className:"mb-6 rounded-xl bg-emerald-50 p-4",children:[e.jsx("p",{className:"font-black text-emerald-800",children:s.name}),e.jsx("p",{className:"text-xs text-emerald-600",children:s.area})]}),e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:[e.jsx(ve,{size:32,className:"mx-auto mb-3 text-slate-400"}),e.jsx("p",{className:"font-bold text-slate-700",children:"Login Required"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Please login or register to reserve Sehri"}),e.jsx("button",{onClick:()=>{i(),c==null||c()},className:"mt-4 rounded-xl bg-emerald-600 px-6 py-2.5 text-sm font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:"Login / Register"})]})]})})}function Ls({timings:s,ramzanTiming:l,points:t,onBook:i,availableAreas:d=[],onFilterChange:c,loading:x}){const[o,k]=a.useState(""),[h,n]=a.useState(""),[p,m]=a.useState(!1),N=()=>{const f=new Date,F=new Date("2026-02-19"),u=new Date("2026-03-20");return f>=F&&f<=u},R=t.filter(f=>f.name.toLowerCase().includes(o.toLowerCase())||f.menu.toLowerCase().includes(o.toLowerCase())),y=f=>{n(f),c&&c({area:f})},w=()=>{n(""),k(""),c&&c({})},S=f=>{if(!f)return"--:--";const[F,u]=f.split(":"),z=parseInt(F),A=z>=12?"PM":"AM";return`${z%12||12}:${u} ${A}`};return e.jsxs("div",{className:"space-y-6",children:[l&&N()&&e.jsxs("section",{className:"rounded-2xl bg-gradient-to-br from-emerald-50 to-teal-50 p-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{size:16,className:"text-emerald-600"}),e.jsxs("h2",{className:"text-sm font-black tracking-tight text-slate-900",children:["Day ",l.ramzan_day," - Prayer Times"]})]}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:new Date(l.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"rounded-xl bg-white/80 p-3 text-center shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:"Sehri Ends"}),e.jsx("p",{className:"text-lg font-black text-emerald-700",children:S(l.sehar_time)})]}),e.jsxs("div",{className:"rounded-xl bg-white/80 p-3 text-center shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:"Iftar"}),e.jsx("p",{className:"text-lg font-black text-orange-600",children:S(l.iftar_time)})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2 sm:grid-cols-6",children:[{name:"Fajr",time:l.fajr},{name:"Zohar",time:l.zohar},{name:"Asar",time:l.asar},{name:"Magrib",time:l.magrib},{name:"Isha",time:l.isha},{name:"Taraweeh",time:l.taraweeh}].map(f=>e.jsxs("div",{className:"rounded-lg bg-white/60 px-2 py-1.5 text-center",children:[e.jsx("p",{className:"text-[10px] font-medium text-slate-500",children:f.name}),e.jsx("p",{className:"text-xs font-bold text-slate-700",children:S(f.time)})]},f.name))})]}),!l&&N()&&e.jsxs("section",{children:[e.jsx("h2",{className:"mb-3 text-sm font-black tracking-tight text-slate-900",children:"Today's Timings"}),e.jsx(ws,{timings:s,compact:!0})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{size:16,className:"text-emerald-600"}),e.jsx("h2",{className:"text-sm font-black tracking-tight text-slate-900",children:"Sehri Spots"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"rounded-lg bg-slate-100 px-2 py-0.5 text-xs font-bold text-slate-600",children:x?"...":`${R.length} nearby`}),e.jsxs("button",{onClick:()=>m(!p),className:`flex items-center gap-1 rounded-lg px-2 py-0.5 text-xs font-bold transition-colors ${p||h?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600"}`,children:[e.jsx(os,{size:12}),"Filter"]})]})]}),p&&e.jsxs("div",{className:"mb-4 rounded-xl border border-slate-200 bg-slate-50 p-3",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-bold text-slate-700",children:"Filter by Area"}),h&&e.jsxs("button",{onClick:w,className:"flex items-center gap-1 text-xs text-slate-500 hover:text-slate-700",children:[e.jsx(Z,{size:12})," Clear"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.length>0?d.map(f=>e.jsxs("button",{onClick:()=>y(f===h?"":f),className:`flex items-center gap-1 rounded-full px-3 py-1 text-xs font-medium transition-colors ${h===f?"bg-emerald-600 text-white":"bg-white text-slate-600 hover:bg-emerald-50"}`,children:[e.jsx(re,{size:10}),f]},f)):e.jsx("p",{className:"text-xs text-slate-400",children:"No areas available"})})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(cs,{size:16,className:"absolute top-1/2 left-3 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search Sehri Spots...",value:o,onChange:f=>k(f.target.value),className:"w-full rounded-xl border border-slate-200 bg-white py-2.5 pr-4 pl-9 text-sm font-medium text-slate-900 placeholder:text-slate-400 focus:border-emerald-300 focus:ring-2 focus:ring-emerald-100 focus:outline-none"})]}),x?e.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:e.jsx("div",{className:"animate-pulse",children:e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Loading hosts..."})})}):R.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:R.map(f=>e.jsx(Ns,{point:f,onBook:i,compact:!0},f.id))}):e.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-8 text-center",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"No Sehri found"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Try a different search term or clear filters"})]})]})]})}const qs="ramzania_user";function Bs({user:s,onUserUpdate:l}){const[t,i]=a.useState({place_name:"",contact:"",alternate_contact:"",street:"",area:"",city:"",pincode:"",latitude:"",longitude:""}),[d,c]=a.useState(!1),[x,o]=a.useState({type:"",text:""}),[k,h]=a.useState(!1),[n,p]=a.useState(!1);a.useEffect(()=>{s&&i({place_name:s.place_name||"",contact:s.contact||"",alternate_contact:s.alternate_contact||"",street:s.street||"",area:s.area||"",city:s.city||"",pincode:s.pincode||"",latitude:s.latitude||"",longitude:s.longitude||""})},[s]);const m=S=>{const{name:f,value:F}=S.target;i(u=>({...u,[f]:F}))},N=a.useCallback(()=>{if(!navigator.geolocation){o({type:"error",text:"Geolocation not supported by your browser"});return}o({type:"info",text:"Getting your location..."}),navigator.geolocation.getCurrentPosition(S=>{i(f=>({...f,latitude:S.coords.latitude.toFixed(6),longitude:S.coords.longitude.toFixed(6)})),o({type:"success",text:"Location updated!"}),setTimeout(()=>o({type:"",text:""}),2e3)},S=>{o({type:"error",text:"Failed to get location: "+S.message})},{enableHighAccuracy:!0,timeout:1e4})},[]),R=()=>{const S=t.latitude||19.076,f=t.longitude||72.8777;window.open(`https://www.google.com/maps/search/?api=1&query=${S},${f}`,"_blank"),o({type:"info",text:"Copy the coordinates from Google Maps URL and paste them in the fields above"})},y=async S=>{var f,F;S.preventDefault(),c(!0),o({type:"",text:""});try{const u=await V.updateProfile({user_id:s.id,place_name:t.place_name,contact:t.contact,alternate_contact:t.alternate_contact||null,street:t.street,area:t.area,city:t.city,pincode:t.pincode,latitude:t.latitude?parseFloat(t.latitude):null,longitude:t.longitude?parseFloat(t.longitude):null});if(u.data.success){o({type:"success",text:"Profile updated successfully!"});const z={...s,...u.data.user};localStorage.setItem(qs,JSON.stringify(z)),l&&l(z)}else o({type:"error",text:u.data.message||"Update failed"})}catch(u){console.error("Profile update error:",u),o({type:"error",text:((F=(f=u.response)==null?void 0:f.data)==null?void 0:F.message)||"Failed to update profile"})}finally{c(!1)}},w=()=>{t.latitude&&t.longitude&&window.open(`https://www.google.com/maps?q=${t.latitude},${t.longitude}`,"_blank")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Host Settings"}),e.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Update your place details and contact information"})]}),x.text&&e.jsx("div",{className:`rounded-lg p-3 text-sm ${x.type==="success"?"border border-emerald-200 bg-emerald-50 text-emerald-700":x.type==="error"?"border border-red-200 bg-red-50 text-red-700":"border border-blue-200 bg-blue-50 text-blue-700"}`,children:x.text}),e.jsxs("form",{onSubmit:y,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Place Name"}),e.jsx("input",{type:"text",name:"place_name",value:t.place_name,onChange:m,placeholder:"e.g., Shah's Kitchen",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"This name will be shown to guests"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Primary Contact"}),e.jsx("input",{type:"tel",name:"contact",value:t.contact,onChange:m,placeholder:"+91 98765 43210",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Alternate Number"}),e.jsx("input",{type:"tel",name:"alternate_contact",value:t.alternate_contact,onChange:m,placeholder:"Optional",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Street Address"}),e.jsx("input",{type:"text",name:"street",value:t.street,onChange:m,placeholder:"Building, Street name",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Area"}),e.jsx("input",{type:"text",name:"area",value:t.area,onChange:m,placeholder:"e.g., Bandra West",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"City"}),e.jsx("input",{type:"text",name:"city",value:t.city,onChange:m,placeholder:"e.g., Mumbai",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-semibold text-slate-700",children:"Pincode"}),e.jsx("input",{type:"text",name:"pincode",value:t.pincode,onChange:m,placeholder:"e.g., 400050",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700",children:"Location Coordinates"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Helps guests navigate to your place"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:N,className:"rounded-lg bg-emerald-50 px-3 py-1.5 text-xs font-medium text-emerald-600 transition-colors hover:bg-emerald-100",children:"üìç Use GPS"}),e.jsx("button",{type:"button",onClick:R,className:"rounded-lg bg-blue-50 px-3 py-1.5 text-xs font-medium text-blue-600 transition-colors hover:bg-blue-100",children:"üó∫Ô∏è Open Maps"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-500",children:"Latitude"}),e.jsx("input",{type:"number",name:"latitude",value:t.latitude,onChange:m,placeholder:"e.g., 19.0760",step:"0.000001",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-500",children:"Longitude"}),e.jsx("input",{type:"number",name:"longitude",value:t.longitude,onChange:m,placeholder:"e.g., 72.8777",step:"0.000001",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm transition-all outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500"})]})]}),t.latitude&&t.longitude&&e.jsxs("button",{type:"button",onClick:w,className:"mt-3 flex w-full items-center justify-center gap-2 rounded-xl bg-slate-50 py-2 text-sm font-medium text-slate-600 transition-colors hover:bg-slate-100",children:[e.jsxs("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"View Current Location on Map"]})]}),e.jsx("button",{type:"submit",disabled:d,className:"mt-6 w-full rounded-xl bg-emerald-600 py-3 font-bold text-white transition-all hover:bg-emerald-700 focus:ring-4 focus:ring-emerald-100 disabled:cursor-not-allowed disabled:opacity-50",children:d?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})]})]})}const Ts=()=>e.jsx("svg",{className:"h-12 w-12 text-amber-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:e.jsx("path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 002-2V2M7 2v20M21 15V2v0a5 5 0 00-5 5v6c0 1.1.9 2 2 2h3zm0 0v7"})});function Gs({onNavigate:s,onSuccess:l}){const[t,i]=a.useState({organization_name:"",service_type:[],sehri_type:"free",zone:"",area:"",full_address:"",contact_name:"",contact_number:"",alternate_number:"",capacity:"",message:""}),[d,c]=a.useState(!1),x=h=>{const{name:n,value:p}=h.target;i(m=>({...m,[n]:p}))},o=h=>{i(n=>({...n,service_type:n.service_type.includes(h)?n.service_type.filter(p=>p!==h):[...n.service_type,h]}))},k=async h=>{var n,p;if(h.preventDefault(),!t.organization_name||!t.contact_name||!t.contact_number||!t.zone||!t.full_address){b.error("Please fill all required fields");return}if(t.service_type.length===0){b.error("Please select at least one service type");return}c(!0);try{(await I.post("/provider-registrations",{...t,service_type:t.service_type.join(",")})).data.success&&(b.success("Registration submitted!",{description:"We will review and list you shortly."}),i({organization_name:"",service_type:[],sehri_type:"free",zone:"",area:"",full_address:"",contact_name:"",contact_number:"",alternate_number:"",capacity:"",message:""}),l&&l())}catch(m){b.error("Failed to submit",{description:((p=(n=m.response)==null?void 0:n.data)==null?void 0:p.message)||"Please try again"})}finally{c(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-950 via-slate-900 to-slate-950 pb-24 text-white",children:[e.jsxs("div",{className:"px-4 pt-6 pb-6 text-center",children:[e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx("div",{className:"rounded-full border border-amber-400/30 bg-amber-400/10 p-4",children:e.jsx(Ts,{})})}),e.jsx("h1",{className:"mb-2 text-2xl font-black text-amber-400",children:"Join as a Provider"}),e.jsx("p",{className:"mx-auto max-w-sm text-sm text-slate-400",children:"Help us map all Sehri distribution points in your city. Register your Masjid or organization to be listed."})]}),e.jsx("div",{className:"px-4",children:e.jsxs("div",{className:"rounded-2xl border border-slate-700/50 bg-slate-800/50 p-6",children:[e.jsx("h2",{className:"mb-1 text-lg font-bold text-white",children:"Registration Form"}),e.jsx("p",{className:"mb-6 text-xs text-slate-500",children:"All fields are mandatory except where noted. We will review and list you shortly."}),e.jsxs("form",{onSubmit:k,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:["Organization / Masjid Name ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",name:"organization_name",value:t.organization_name,onChange:x,placeholder:"e.g., Masjid-e-Khair",className:"w-full rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white placeholder-slate-500 transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-medium text-slate-300",children:["Type of Service ",e.jsx("span",{className:"text-red-400",children:"*"})," ",e.jsx("span",{className:"text-slate-500",children:"(Select all that apply)"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>o("masjid"),className:`flex items-center justify-center gap-2 rounded-xl border-2 p-3 transition-all ${t.service_type.includes("masjid")?"border-amber-500 bg-amber-500/10 text-amber-400":"border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 002-2V2M7 2v20M21 15V2v0a5 5 0 00-5 5v6c0 1.1.9 2 2 2h3zm0 0v7"})}),e.jsx("span",{className:"text-sm font-medium",children:"Masjid (Dine-in)"})]}),e.jsxs("button",{type:"button",onClick:()=>o("home_delivery"),className:`flex items-center justify-center gap-2 rounded-xl border-2 p-3 transition-all ${t.service_type.includes("home_delivery")?"border-amber-500 bg-amber-500/10 text-amber-400":"border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[e.jsxs("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"}),e.jsx("polyline",{points:"9,22 9,12 15,12 15,22"})]}),e.jsx("span",{className:"text-sm font-medium",children:"Home Delivery"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-medium text-slate-300",children:["Sehri Type ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>i(h=>({...h,sehri_type:"free"})),className:`flex items-center justify-center gap-2 rounded-xl border-2 p-3 transition-all ${t.sehri_type==="free"?"border-amber-500 bg-amber-500/10 text-amber-400":"border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[e.jsx("span",{className:"text-lg",children:"üéÅ"}),e.jsx("span",{className:"text-sm font-medium",children:"Free Sehri"})]}),e.jsxs("button",{type:"button",onClick:()=>i(h=>({...h,sehri_type:"paid"})),className:`flex items-center justify-center gap-2 rounded-xl border-2 p-3 transition-all ${t.sehri_type==="paid"?"border-amber-500 bg-amber-500/10 text-amber-400":"border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[e.jsx("span",{className:"text-lg",children:"üí∞"}),e.jsx("span",{className:"text-sm font-medium",children:"Paid Sehri"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:["Zone ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{name:"zone",value:t.zone,onChange:x,className:"w-full rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500",required:!0,children:[e.jsx("option",{value:"",children:"Select Zone"}),e.jsx("option",{value:"North",children:"North"}),e.jsx("option",{value:"South",children:"South"}),e.jsx("option",{value:"East",children:"East"}),e.jsx("option",{value:"West",children:"West"}),e.jsx("option",{value:"Central",children:"Central"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:["Area / Locality ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",name:"area",value:t.area,onChange:x,placeholder:"e.g., Indiranagar, Koramangala",className:"w-full rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white placeholder-slate-500 transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:["Full Address ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("textarea",{name:"full_address",value:t.full_address,onChange:x,placeholder:"Complete address for directions...",rows:2,className:"w-full resize-none rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white placeholder-slate-500 transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:["Point of Contact Name ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",name:"contact_name",value:t.contact_name,onChange:x,placeholder:"Full name of contact person",className:"w-full rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white placeholder-slate-500 transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:["Contact Number ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"tel",name:"contact_number",value:t.contact_number,onChange:x,placeholder:"+91 XXXXX XXXXX",className:"w-full rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white placeholder-slate-500 transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:["Additional Contact Number ",e.jsx("span",{className:"text-slate-500",children:"(Optional)"})]}),e.jsx("input",{type:"tel",name:"alternate_number",value:t.alternate_number,onChange:x,placeholder:"+91 XXXXX XXXXX",className:"w-full rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white placeholder-slate-500 transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:["Daily Capacity ",e.jsx("span",{className:"text-slate-500",children:"(Optional)"})]}),e.jsx("input",{type:"text",name:"capacity",value:t.capacity,onChange:x,placeholder:"e.g., 50 people, 100 packets",className:"w-full rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white placeholder-slate-500 transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:["Additional Information ",e.jsx("span",{className:"text-slate-500",children:"(Optional)"})]}),e.jsx("textarea",{name:"message",value:t.message,onChange:x,placeholder:"Menu, timings, any special notes...",rows:3,className:"w-full resize-none rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white placeholder-slate-500 transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500"})]}),e.jsx("button",{type:"submit",disabled:d,className:"w-full rounded-xl bg-amber-400 py-3.5 font-bold text-slate-900 transition-all hover:bg-amber-300 active:scale-[0.98] disabled:cursor-not-allowed disabled:bg-amber-400/50",children:d?"Submitting...":"Register Provider"})]})]})})]})}const Xs=()=>e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 002-2V2M7 2v20M21 15V2v0a5 5 0 00-5 5v6c0 1.1.9 2 2 2h3zm0 0v7"})}),Hs=()=>e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"})});function Vs({ramzanTiming:s,onNavigate:l,city:t="Chennai"}){const[i,d]=a.useState({hours:0,minutes:0}),[c,x]=a.useState([]);a.useEffect(()=>{if(s!=null&&s.sehar_time&&(s!=null&&s.iftar_time)){const[h,n]=s.sehar_time.split(":").map(Number),[p,m]=s.iftar_time.split(":").map(Number);let N=p*60+m-(h*60+n);N<0&&(N+=1440),d({hours:Math.floor(N/60),minutes:N%60})}},[s]),a.useEffect(()=>{if(s){const h=new Date("2026-02-19"),p=Math.max(1,Math.ceil((new Date-h)/(1e3*60*60*24))+1),m=[];for(let N=0;N<3;N++){const R=new Date(h);R.setDate(h.getDate()+p-1+N),m.push({date:R.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),sehri:s.sehar_time,iftar:s.iftar_time,day:p+N})}x(m)}},[s]);const o=h=>{if(!h)return"--:--";const[n,p]=h.split(":"),m=parseInt(n);return`${m>12?m-12:m}:${p} ${m>=12?"PM":"AM"}`},k=()=>s!=null&&s.ramzan_day?`${s.ramzan_day} Ramadan 1447 AH`:"Sha'ban 1447 AH";return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-950 via-slate-900 to-slate-950 text-white",children:[e.jsxs("div",{className:"relative overflow-hidden px-4 pt-6 pb-8 sm:px-8 sm:pt-10 sm:pb-12",children:[e.jsx("div",{className:"absolute top-0 right-0 h-64 w-64 rounded-full bg-amber-500/5 blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 h-48 w-48 rounded-full bg-amber-500/5 blur-3xl"}),e.jsxs("div",{className:"mb-6 inline-flex items-center gap-2 rounded-full bg-amber-500/20 px-4 py-1.5",children:[e.jsx(ds,{size:14,className:"fill-amber-400 text-amber-400"}),e.jsx("span",{className:"text-sm font-bold text-amber-400",children:"Ramadan 2026"})]}),e.jsxs("h1",{className:"mb-4 text-4xl leading-tight font-black sm:text-5xl",children:["Community ",e.jsx("span",{className:"text-amber-400",children:"Sehri"}),e.jsx("br",{}),"Distribution"]}),e.jsxs("p",{className:"mb-8 max-w-md text-base text-slate-400 sm:text-lg",children:["Connecting those in need with generous providers across ",t,". Find a nearby Sehri location."]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>l("find"),className:"flex items-center gap-2 rounded-xl bg-amber-400 px-6 py-3 font-bold text-slate-900 transition-all hover:bg-amber-300 active:scale-95",children:[e.jsx(Xs,{}),"Find Sehri"]}),e.jsxs("button",{onClick:()=>l("request"),className:"flex items-center gap-2 rounded-xl border-2 border-slate-600 bg-transparent px-6 py-3 font-bold text-white transition-all hover:border-slate-500 active:scale-95",children:[e.jsx(Hs,{}),"Request Support"]})]})]}),e.jsx("div",{className:"px-4 pb-8 sm:px-8",children:e.jsxs("div",{className:"relative overflow-hidden rounded-3xl border border-slate-700/50 bg-slate-800/50 p-6",children:[e.jsx("div",{className:"absolute -top-10 right-8 h-32 w-32",children:e.jsxs("div",{className:"relative h-full w-full",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-amber-500/30",style:{background:"conic-gradient(from 90deg, transparent 0deg, rgba(251,191,36,0.3) 180deg, transparent 360deg)"}}),e.jsx("div",{className:"absolute top-4 left-4 h-24 w-24 rounded-full bg-gradient-to-br from-amber-200/20 to-transparent blur-sm"}),e.jsx("div",{className:"absolute top-6 left-8 h-16 w-16 rounded-full bg-slate-800/90"})]})}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"mb-1 text-xs font-medium text-slate-500",children:"Sehri"}),e.jsx("p",{className:"text-lg font-black text-amber-400 sm:text-xl",children:o(s==null?void 0:s.sehar_time)})]}),e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsx("p",{className:"mb-1 text-[10px] font-bold tracking-wider text-amber-400/70 uppercase",children:"Roza Duration"}),e.jsxs("p",{className:"text-2xl font-black text-white sm:text-3xl",children:[i.hours,"h ",i.minutes,"m"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"mb-1 text-xs font-medium text-slate-500",children:"Iftar"}),e.jsx("p",{className:"text-lg font-black text-amber-400 sm:text-xl",children:o(s==null?void 0:s.iftar_time)})]})]}),e.jsx("p",{className:"mt-4 text-center text-xs text-slate-500",children:k()})]})}),e.jsxs("div",{className:"px-4 pb-8 sm:px-8",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(ne,{size:16,className:"text-amber-400"}),e.jsx("h3",{className:"text-sm font-bold tracking-wider text-amber-400 uppercase",children:"Next 3 Days"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:c.map((h,n)=>e.jsxs("div",{className:"rounded-xl border border-slate-700/50 bg-slate-800/30 p-3 text-center",children:[e.jsx("p",{className:"mb-2 text-xs font-medium text-slate-400",children:h.date}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-slate-500 uppercase",children:"Sehri"}),e.jsx("p",{className:"text-sm font-bold text-amber-400",children:o(h.sehri)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-slate-500 uppercase",children:"Iftar"}),e.jsx("p",{className:"text-sm font-bold text-amber-400",children:o(h.iftar)})]})]})]},n))})]}),e.jsx("div",{className:"px-4 pb-8 sm:px-8",children:e.jsxs("div",{className:"rounded-2xl border border-slate-700/50 bg-slate-800/30 p-6",children:[e.jsx("p",{className:"mb-2 text-xs text-slate-500",children:"Ramzania is an initiative of"}),e.jsx("h3",{className:"mb-4 text-lg font-black text-amber-400",children:"Community Volunteers"}),e.jsx("h4",{className:"mb-2 text-sm font-bold text-white",children:"Our Mission & Purpose"}),e.jsx("p",{className:"text-sm leading-relaxed text-slate-400",children:"Ramadan is a month of giving and community. While Iftar is often a communal affair, Sehri (the pre-dawn meal) can be challenging for students, travelers, and those living in hostels or PG accommodations."})]})}),e.jsx("div",{className:"px-4 pb-8 sm:px-8",children:e.jsxs("div",{className:"rounded-2xl border border-amber-500/30 bg-gradient-to-r from-amber-500/10 to-amber-600/10 p-6 text-center",children:[e.jsx("h3",{className:"mb-2 text-lg font-bold text-white",children:"Are you a provider?"}),e.jsx("p",{className:"mb-4 text-sm text-slate-400",children:"If your Masjid or organization is distributing Sehri this Ramadan, please list your details to help us guide people to you."}),e.jsx("button",{onClick:()=>l("join"),className:"rounded-xl bg-amber-400 px-6 py-2.5 font-bold text-slate-900 transition-all hover:bg-amber-300 active:scale-95",children:"Register as Provider"})]})}),e.jsx("footer",{className:"px-4 pb-24 sm:px-8 sm:pb-20",children:e.jsx("div",{className:"border-t border-slate-800 pt-6 text-center",children:e.jsx("p",{className:"text-xs text-slate-600",children:"¬© 2026 Ramzania.com | The Last Meal Before Dawn"})})})]})}function Us(){const[s,l]=a.useState([]),[t,i]=a.useState(!0),[d,c]=a.useState(null),x=n=>{const p=["th","st","nd","rd"],m=n%100;return n+(p[(m-20)%10]||p[m]||p[0])},o=async()=>{i(!0);try{const n=await As();n.success?l(n.bookings||[]):b.error(n.message||"Failed to load bookings")}catch{b.error("Failed to load bookings")}finally{i(!1)}};a.useEffect(()=>{o()},[]);const k=async n=>{if(globalThis.confirm("Are you sure you want to cancel this booking?")){c(n);try{const p=await Fs(n);p.success?(b.success("Booking cancelled"),l(m=>m.map(N=>N.id===n?{...N,status:"cancelled"}:N))):b.error(p.message||"Failed to cancel")}catch{b.error("Failed to cancel booking")}finally{c(null)}}},h=n=>{switch(n){case"confirmed":return"bg-emerald-100 text-emerald-700";case"completed":return"bg-blue-100 text-blue-700";case"cancelled":return"bg-red-100 text-red-700";default:return"bg-slate-100 text-slate-700"}};return t?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(q,{size:32,className:"animate-spin text-emerald-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-slate-900",children:"My Reservations"}),e.jsxs("p",{className:"text-xs text-slate-500",children:[s.length," Sehri reservation(s)"]})]}),e.jsx("button",{onClick:o,className:"rounded-lg bg-slate-100 p-2 text-slate-600 transition-all hover:bg-slate-200 active:scale-95",children:e.jsx(qe,{size:16})})]}),s.length===0?e.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 py-16 text-center",children:[e.jsx($e,{size:48,className:"mx-auto mb-4 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-600",children:"No Sehri reservations yet"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Browse hosts & reserve your Sehri from Home"})]}):e.jsx("div",{className:"space-y-4",children:s.map(n=>e.jsxs("div",{className:`rounded-2xl border bg-white p-4 shadow-sm ${n.status==="cancelled"?"border-slate-200 opacity-60":"border-slate-100"}`,children:[e.jsxs("div",{className:"mb-3 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-black text-slate-900",children:n.provider_name}),e.jsxs("div",{className:"mt-1 flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(re,{size:12}),n.area]})]}),e.jsx("span",{className:`rounded-lg px-2 py-1 text-[10px] font-bold uppercase ${h(n.status)}`,children:n.status})]}),e.jsxs("div",{className:"rounded-xl bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 font-bold text-emerald-700",children:[x(n.ramzan_day)," Ramzan"]}),e.jsxs("span",{className:"flex items-center gap-1 text-slate-500",children:[e.jsx(ne,{size:12}),n.formatted_date]}),e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5 text-[10px] font-bold text-slate-600",children:n.meal_type})]}),n.timing&&e.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-slate-500",children:[e.jsx(le,{size:12}),n.timing]}),e.jsxs("p",{className:"mt-2 text-xs text-slate-500 italic",children:['"',n.menu_items,'"']})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-600",children:[e.jsxs("span",{className:"font-bold",children:["üë• ",n.quantity," person(s)"]}),e.jsx("span",{className:"font-bold",children:n.price_type==="free"||n.total_amount===0?"üÜì Free":`üí∞ ‚Çπ${n.total_amount}`})]}),e.jsx("span",{className:"rounded bg-slate-100 px-2 py-1 font-mono text-[10px] text-slate-500",children:n.booking_code})]}),n.status==="confirmed"&&e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs("a",{href:`tel:${n.provider_phone}`,className:"flex flex-1 items-center justify-center gap-1.5 rounded-xl border border-slate-200 bg-white py-2 text-xs font-bold text-slate-700 transition-all hover:bg-slate-50 active:scale-95",children:[e.jsx(we,{size:14})," Call Host"]}),e.jsxs("button",{onClick:()=>k(n.id),disabled:d===n.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-xs font-bold text-red-600 transition-all hover:bg-red-100 active:scale-95 disabled:opacity-50",children:[d===n.id?e.jsx(q,{size:14,className:"animate-spin"}):e.jsx(Z,{size:14}),"Cancel"]})]}),e.jsxs("p",{className:"mt-3 text-[10px] text-slate-400",children:["Booked on ",n.booked_at]})]},n.id))})]})}const te={LIST:"/offerings",CREATE:"/offerings",BULK_CREATE:"/offerings/bulk",UPDATE:s=>`/offerings/${s}`,DELETE:s=>`/offerings/${s}`,STATS:"/offerings/stats"},ae={getAll:async()=>I.get(te.LIST),create:async s=>I.post(te.CREATE,s),bulkCreate:async s=>I.post(te.BULK_CREATE,{offerings:s}),update:async(s,l)=>I.put(te.UPDATE(s),l),delete:async s=>I.delete(te.DELETE(s)),getStats:async()=>I.get(te.STATS)},pe=30,Ws=new Date("2026-02-19"),Ys=()=>Array.from({length:pe},(s,l)=>{const t=l+1,i=new Date(Ws);return i.setDate(i.getDate()+l),{day:t,date:i,dateStr:i.toLocaleDateString("en-IN",{day:"numeric",month:"short"}),fullDate:i.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})}}),Ne=Ys();function Ks({onClose:s,onSave:l,editingPoint:t,loading:i}){var T,U,W,Y;const[d,c]=a.useState("single"),[x,o]=a.useState(t?[t.ramzan_day]:[1]),[k]=a.useState("sehar"),[h,n]=a.useState((t==null?void 0:t.menu_items)||""),[p,m]=a.useState(((T=t==null?void 0:t.capacity)==null?void 0:T.toString())||"50"),[N,R]=a.useState((t==null?void 0:t.price_type)||"free"),[y,w]=a.useState(((U=t==null?void 0:t.price_amount)==null?void 0:U.toString())||""),[S,f]=a.useState(((W=t==null?void 0:t.timing_from)==null?void 0:W.slice(0,5))||"04:00"),[F,u]=a.useState(((Y=t==null?void 0:t.timing_to)==null?void 0:Y.slice(0,5))||"05:30"),[z,A]=a.useState((t==null?void 0:t.message)||""),D="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",O="w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5 text-sm font-medium outline-none transition-all focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100",E=C=>{o(d==="single"?[C]:G=>G.includes(C)?G.filter(K=>K!==C):[...G,C])},M=()=>{x.length===pe?o([]):o(Array.from({length:pe},(C,G)=>G+1))},B=C=>{if(C.preventDefault(),x.length===0){b.error("Please select at least one day");return}if(!h.trim()){b.error("Please enter menu items");return}const G={meal_type:k,menu_items:h.trim(),capacity:Number.parseInt(p)||50,price_type:N,price_amount:N==="paid"?Number.parseFloat(y)||0:null,timing_from:S,timing_to:F,message:z.trim()||null};if(t)l({...G,id:t.id});else if(d==="single")l({...G,ramzan_day:x[0]});else{const K=x.map(Q=>({...G,ramzan_day:Q}));l({bulk:!0,offerings:K})}};return e.jsx("div",{className:"fixed inset-0 z-100 flex items-start justify-center overflow-y-auto bg-slate-900/40 px-4 pt-4 pb-24 backdrop-blur-sm sm:items-center sm:pb-4",children:e.jsxs("div",{className:"animate-in slide-in-from-bottom-4 sm:slide-in-from-bottom-0 sm:zoom-in-95 w-full max-w-lg rounded-2xl bg-white p-6 shadow-xl sm:my-auto",children:[e.jsxs("div",{className:"mb-5 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-black text-slate-900",children:[t?"Edit":"Add"," Sehar Offering"]}),e.jsx("button",{onClick:s,className:"rounded-full p-1.5 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(Z,{size:18})})]}),e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[!t&&e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{type:"button",onClick:()=>{c("single"),o([1])},className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${d==="single"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Single Day"}),e.jsx("button",{type:"button",onClick:()=>c("bulk"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${d==="bulk"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Multiple Days"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsxs("label",{className:"block text-xs font-bold text-slate-500",children:[e.jsx(ne,{size:12,className:"mr-1 inline"}),d==="single"?"Select Ramzan Day":"Select Days"]}),d==="bulk"&&!t&&e.jsx("button",{type:"button",onClick:M,className:"text-[10px] font-bold text-emerald-600 hover:underline",children:x.length===pe?"Deselect All":"Select All"})]}),d==="single"||t?e.jsx("select",{value:x[0],onChange:C=>o([Number.parseInt(C.target.value)]),className:D,disabled:!!t,children:Ne.map(C=>e.jsxs("option",{value:C.day,children:["Day ",C.day," - ",C.fullDate]},C.day))}):e.jsx("div",{className:"grid max-h-32 grid-cols-5 gap-1.5 overflow-y-auto rounded-xl border border-slate-200 bg-slate-50 p-2",children:Ne.map(C=>e.jsx("button",{type:"button",onClick:()=>E(C.day),className:`rounded-lg px-2 py-1.5 text-[10px] font-bold transition-all ${x.includes(C.day)?"bg-emerald-600 text-white":"bg-white text-slate-600 hover:bg-emerald-50"}`,children:C.day},C.day))}),d==="bulk"&&x.length>0&&e.jsxs("p",{className:"mt-1 text-[10px] text-emerald-600",children:[x.length," days selected"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(be,{size:12,className:"mr-1 inline"}),"Meal Type"]}),e.jsx("div",{className:"rounded-xl border border-slate-200 bg-emerald-50 px-4 py-3 text-sm font-bold text-emerald-700",children:"Sehar (Pre-dawn meal)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Menu Items *"}),e.jsx("textarea",{required:!0,placeholder:"e.g., Biryani, Kheer, Dates, Rooh Afza, Chai...",className:D+" resize-none",rows:2,value:h,onChange:C=>n(C.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(de,{size:12,className:"mr-1 inline"}),"Capacity *"]}),e.jsx("input",{type:"number",required:!0,min:"1",max:"10000",placeholder:"No. of people",className:O,value:p,onChange:C=>m(C.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(hs,{size:12,className:"mr-1 inline"}),"Price Type"]}),e.jsxs("select",{value:N,onChange:C=>R(C.target.value),className:O,children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"paid",children:"Paid"})]})]})]}),N==="paid"&&e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:"Amount per person (‚Çπ)"}),e.jsx("input",{type:"number",required:!0,min:"1",placeholder:"Enter amount",className:O,value:y,onChange:C=>w(C.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(le,{size:12,className:"mr-1 inline"}),"Service Timings"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"time",className:O,value:S,onChange:C=>f(C.target.value)}),e.jsx("input",{type:"time",className:O,value:F,onChange:C=>u(C.target.value)})]}),e.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"From - To (e.g., 4:00 AM - 5:30 AM)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-bold text-slate-500",children:[e.jsx(ps,{size:12,className:"mr-1 inline"}),"Additional Message (Optional)"]}),e.jsx("textarea",{placeholder:"Any special instructions or notes...",className:D+" resize-none",rows:2,value:z,onChange:C=>A(C.target.value)})]}),e.jsx("button",{type:"submit",disabled:i,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-emerald-600 py-3 text-sm font-bold text-white shadow-lg shadow-emerald-100 transition-all hover:bg-emerald-700 active:scale-[0.98] disabled:opacity-50",children:i?e.jsxs(e.Fragment,{children:[e.jsx(q,{size:16,className:"animate-spin"}),"Saving..."]}):t?"Update Offering":d==="bulk"?`Add ${x.length} Offering${x.length>1?"s":""}`:"Add Offering"})]})]})})}function Js({user:s}){const[l,t]=a.useState("offerings"),[i,d]=a.useState(!1),[c,x]=a.useState(null),[o,k]=a.useState([]),[h,n]=a.useState([]),[p,m]=a.useState({total:0,confirmed:0,completed:0,cancelled:0}),[N,R]=a.useState("all"),[y,w]=a.useState(!1),[S,f]=a.useState(!1),[F,u]=a.useState(!1),[z,A]=a.useState(null),[D,O]=a.useState({total_offerings:0,total_capacity:0,total_booked:0});a.useEffect(()=>{E(),M(),B()},[]),a.useEffect(()=>{B()},[N]);const E=async()=>{w(!0);try{const r=await ae.getAll();r.success&&k(r.offerings||[])}catch{b.error("Failed to load offerings")}finally{w(!1)}},M=async()=>{try{const r=await ae.getStats();r.success&&O(r.stats)}catch(r){console.error("Failed to load stats",r)}},B=async()=>{f(!0);try{const r=await Ms(N);r.success&&(n(r.bookings||[]),r.stats&&m(r.stats))}catch{b.error("Failed to load bookings")}finally{f(!1)}},T=async(r,_)=>{A(r);try{const $=await Ps(r,_);$.success?(b.success("Status updated"),n(J=>J.map(X=>X.id===r?{...X,status:_}:X)),await B(),await M()):b.error($.message||"Failed to update status")}catch{b.error("Failed to update status")}finally{A(null)}},U=D.total_offerings||o.length,W=p.total||0,Y=p.confirmed||0,C=async r=>{u(!0);try{if(r.bulk){const _=await ae.bulkCreate(r.offerings);_.success?(b.success(`${_.created_count} offerings created successfully!`),await E(),await M(),d(!1)):b.error(_.message||"Failed to create offerings")}else if(r.id){const _=await ae.update(r.id,r);_.success?(b.success("Offering updated successfully"),await E(),await M(),d(!1)):b.error(_.message||"Failed to update offering")}else{const _=await ae.create(r);_.success?(b.success("Offering created successfully"),await E(),await M(),d(!1)):b.error(_.message||"Failed to create offering")}}catch(_){b.error(_.message||"An error occurred")}finally{u(!1),x(null)}},G=async r=>{if(window.confirm("Delete this food offering?"))try{const _=await ae.delete(r);_.success?(b.success("Offering deleted"),await E(),await M()):b.error(_.message||"Failed to delete")}catch{b.error("Failed to delete offering")}},K=r=>{switch(r){case"confirmed":return"bg-emerald-50 text-emerald-600";case"completed":return"bg-blue-50 text-blue-600";case"cancelled":return"bg-red-50 text-red-500";default:return"bg-slate-100 text-slate-500"}},Q=r=>{const _=["th","st","nd","rd"],$=r%100;return r+(_[($-20)%10]||_[$]||_[0])};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-slate-900",children:"Host Dashboard"}),e.jsx("p",{className:"text-xs font-medium text-slate-500",children:(s==null?void 0:s.place_name)||"Manage your Sehri distribution"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"rounded-xl bg-emerald-50 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-emerald-600",children:U}),e.jsx("p",{className:"text-[10px] font-bold text-emerald-700 uppercase",children:"Offerings"})]}),e.jsxs("div",{className:"rounded-xl bg-slate-100 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-slate-700",children:W}),e.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:"Bookings"})]}),e.jsxs("div",{className:"rounded-xl bg-blue-50 p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-blue-600",children:Y}),e.jsx("p",{className:"text-[10px] font-bold text-blue-700 uppercase",children:"Confirmed"})]})]}),e.jsxs("div",{className:"flex rounded-xl bg-slate-100 p-1",children:[e.jsx("button",{onClick:()=>t("offerings"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${l==="offerings"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Food Offerings"}),e.jsx("button",{onClick:()=>t("bookings"),className:`flex-1 rounded-lg py-2 text-xs font-bold transition-all ${l==="bookings"?"bg-white text-emerald-600 shadow-sm":"text-slate-500"}`,children:"Bookings"})]}),l==="offerings"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-bold text-slate-700",children:"My Offerings"}),e.jsxs("button",{onClick:()=>{x(null),d(!0)},className:"flex items-center gap-1.5 rounded-lg bg-emerald-600 px-3 py-2 text-xs font-bold text-white transition-all hover:bg-emerald-700 active:scale-95",children:[e.jsx(Le,{size:14}),"Add Day"]})]}),y?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(q,{size:24,className:"animate-spin text-emerald-600"})}):e.jsx("div",{className:"space-y-3",children:o.length>0?o.sort((r,_)=>r.ramzan_day-_.ramzan_day).map(r=>{var $,J;const _=Ne.find(X=>X.day===r.ramzan_day);return e.jsxs("div",{className:"rounded-xl border border-slate-100 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 text-xs font-black text-emerald-700",children:[Q(r.ramzan_day)," Ramzan"]}),e.jsx("span",{className:"text-[10px] text-slate-400",children:_==null?void 0:_.fullDate}),e.jsx("span",{className:"rounded bg-slate-100 px-1.5 py-0.5 text-[9px] font-bold text-slate-600 uppercase",children:r.meal_type})]}),e.jsx("span",{className:`rounded-lg px-2 py-0.5 text-[9px] font-black uppercase ${r.price_type==="free"?"bg-emerald-50 text-emerald-600":"bg-amber-50 text-amber-600"}`,children:r.price_type==="free"?"Free":`‚Çπ${r.price_amount}`})]}),e.jsxs("p",{className:"mt-2 text-xs text-slate-600 italic",children:['"',r.menu_items,'"']}),r.message&&e.jsxs("p",{className:"mt-1 text-[10px] text-slate-400",children:["üí¨ ",r.message]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-3 text-[10px] text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(de,{size:10}),r.booked_count||0,"/",r.capacity]}),e.jsx("span",{className:`${(r.booked_count||0)>=r.capacity?"text-red-500":"text-emerald-600"}`,children:(r.booked_count||0)>=r.capacity?"Full":`${r.capacity-(r.booked_count||0)} left`}),r.timing_from&&r.timing_to&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(le,{size:10}),($=r.timing_from)==null?void 0:$.slice(0,5)," - ",(J=r.timing_to)==null?void 0:J.slice(0,5)]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between border-t border-slate-50 pt-3",children:[e.jsx("span",{className:`rounded px-1.5 py-0.5 text-[9px] font-bold uppercase ${r.status==="active"?"bg-emerald-50 text-emerald-600":"bg-slate-100 text-slate-500"}`,children:r.status}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>{x(r),d(!0)},className:"rounded-lg p-1.5 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(xs,{size:14})}),e.jsx("button",{onClick:()=>G(r.id),className:"rounded-lg p-1.5 text-slate-400 hover:bg-red-50 hover:text-red-500",children:e.jsx(ms,{size:14})})]})]})]},r.id)}):e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-12 text-center",children:[e.jsx(be,{size:32,className:"mx-auto mb-3 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-500",children:"No offerings yet"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Add food offerings for specific Ramzan days"})]})})]}),l==="bookings"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-bold text-slate-700",children:"Manage Bookings"}),e.jsxs("button",{onClick:B,disabled:S,className:"flex items-center gap-1.5 rounded-lg bg-slate-100 px-3 py-2 text-xs font-bold text-slate-600 transition-all hover:bg-slate-200 active:scale-95 disabled:opacity-50",children:[e.jsx(qe,{size:14,className:S?"animate-spin":""}),"Refresh"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"all",label:"All",count:p.total},{value:"confirmed",label:"Confirmed",count:p.confirmed},{value:"completed",label:"Completed",count:p.completed},{value:"cancelled",label:"Cancelled",count:p.cancelled}].map(r=>e.jsxs("button",{onClick:()=>R(r.value),className:`rounded-lg px-3 py-1.5 text-[10px] font-bold transition-all ${N===r.value?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[r.label," (",r.count||0,")"]},r.value))}),S?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(q,{size:24,className:"animate-spin text-emerald-600"})}):e.jsx("div",{className:"space-y-3",children:h.length>0?h.map(r=>{var _,$;return e.jsxs("div",{className:`rounded-xl border bg-white p-4 transition-all ${r.status==="cancelled"?"border-slate-200 opacity-70":"border-slate-100"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900",children:r.seeker_name}),e.jsxs("div",{className:"mt-1 flex flex-col gap-1 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{size:12}),e.jsx("a",{href:`tel:${r.seeker_phone}`,className:"hover:text-emerald-600",children:r.seeker_phone})]}),r.seeker_email&&e.jsx("span",{className:"text-[10px] text-slate-400",children:r.seeker_email})]})]}),e.jsx("span",{className:`rounded-lg px-2 py-1 text-[10px] font-bold uppercase ${K(r.status)}`,children:r.status})]}),r.menu_items&&e.jsxs("p",{className:"mt-2 text-xs text-slate-500 italic",children:['"',r.menu_items,'"']}),e.jsxs("div",{className:"mt-3 rounded-lg bg-slate-50 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsxs("span",{className:"rounded-lg bg-emerald-100 px-2 py-1 font-bold text-emerald-700",children:[Q(r.ramzan_day)," Ramzan"]}),e.jsxs("span",{className:"flex items-center gap-1 text-slate-500",children:[e.jsx(ne,{size:12}),r.formatted_date]}),e.jsx("span",{className:"rounded bg-slate-200 px-1.5 py-0.5 text-[10px] font-bold text-slate-600 uppercase",children:r.meal_type})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs text-slate-600",children:[e.jsxs("span",{className:"flex items-center gap-1 font-bold",children:[e.jsx(de,{size:12}),r.quantity," person(s)"]}),e.jsx("span",{className:"font-bold",children:r.total_amount>0?`‚Çπ${r.total_amount}`:"Free"}),r.timing_from&&r.timing_to&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(le,{size:12}),(_=r.timing_from)==null?void 0:_.slice(0,5)," - ",($=r.timing_to)==null?void 0:$.slice(0,5)]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsx("span",{className:"rounded bg-slate-100 px-2 py-1 font-mono text-[10px] text-slate-500",children:r.booking_code}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:["Booked: ",new Date(r.created_at).toLocaleDateString("en-IN")]})]}),r.status==="confirmed"&&e.jsxs("div",{className:"mt-4 flex gap-2 border-t border-slate-100 pt-4",children:[e.jsxs("button",{onClick:()=>T(r.id,"completed"),disabled:z===r.id,className:"flex flex-1 items-center justify-center gap-1.5 rounded-xl bg-emerald-600 py-2 text-xs font-bold text-white transition-all hover:bg-emerald-700 active:scale-95 disabled:opacity-50",children:[z===r.id?e.jsx(q,{size:14,className:"animate-spin"}):e.jsx(Be,{size:14}),"Mark Completed"]}),e.jsxs("button",{onClick:()=>T(r.id,"cancelled"),disabled:z===r.id,className:"flex items-center justify-center gap-1.5 rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-xs font-bold text-red-600 transition-all hover:bg-red-100 active:scale-95 disabled:opacity-50",children:[e.jsx(us,{size:14}),"Cancel"]})]}),r.status==="cancelled"&&e.jsx("div",{className:"mt-3 border-t border-slate-100 pt-3",children:e.jsxs("button",{onClick:()=>T(r.id,"confirmed"),disabled:z===r.id,className:"flex items-center gap-1.5 text-xs font-bold text-emerald-600 hover:text-emerald-700",children:[z===r.id?e.jsx(q,{size:12,className:"animate-spin"}):e.jsx(Ie,{size:12}),"Restore Booking"]})})]},r.id)}):e.jsxs("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 py-12 text-center",children:[e.jsx(de,{size:32,className:"mx-auto mb-3 text-slate-300"}),e.jsx("p",{className:"font-bold text-slate-500",children:N==="all"?"No bookings yet":`No ${N} bookings`}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Guest reservations will appear here"})]})})]}),i&&e.jsx(Ks,{onClose:()=>{d(!1),x(null)},onSave:C,editingPoint:c,loading:F})]})}function Zs({user:s,onNavigate:l}){const[t,i]=a.useState({name:(s==null?void 0:s.name)||"",phone:(s==null?void 0:s.contact)||"",email:"",area:"",address:"",family_size:"1",days_needed:"",message:""}),[d,c]=a.useState(!1),x=k=>{const{name:h,value:n}=k.target;i(p=>({...p,[h]:n}))},o=async k=>{var h,n;if(k.preventDefault(),!t.name||!t.phone||!t.area){b.error("Please fill all required fields");return}c(!0);try{(await I.post("/support-requests",{...t,user_id:(s==null?void 0:s.id)||null})).data.success&&(b.success("Request submitted!",{description:"Our volunteers will reach out soon."}),i({name:(s==null?void 0:s.name)||"",phone:(s==null?void 0:s.contact)||"",email:"",area:"",address:"",family_size:"1",days_needed:"",message:""}))}catch(p){b.error("Failed to submit request",{description:((n=(h=p.response)==null?void 0:h.data)==null?void 0:n.message)||"Please try again"})}finally{c(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-950 via-slate-900 to-slate-950 pb-24 text-white",children:[e.jsxs("div",{className:"px-4 pt-6 pb-6 text-center",children:[e.jsx("h1",{className:"mb-2 text-2xl font-black text-amber-400",children:"Request Sehri Support"}),e.jsxs("p",{className:"mx-auto max-w-sm text-sm text-slate-400",children:["If you don't find a Sehri provider near you in our"," ",e.jsx("button",{onClick:()=>l("find"),className:"font-bold text-amber-400",children:"Find Sehri"})," ","section, please fill this form. Our community volunteers will try to reach you."]})]}),e.jsx("div",{className:"px-4",children:e.jsxs("div",{className:"rounded-2xl border border-slate-700/50 bg-slate-800/50 p-6",children:[e.jsx("h2",{className:"mb-1 text-lg font-bold text-white",children:"Assistance Form"}),e.jsxs("p",{className:"mb-6 text-xs text-slate-500",children:["Fields marked with ",e.jsx("span",{className:"text-red-400",children:"*"})," are required."]}),e.jsxs("form",{onSubmit:o,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:["Full Name ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",name:"name",value:t.name,onChange:x,placeholder:"Enter your name",className:"w-full rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white placeholder-slate-500 transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:["Contact Number ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"tel",name:"phone",value:t.phone,onChange:x,placeholder:"+91 XXXXX XXXXX",className:"w-full rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white placeholder-slate-500 transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:["Email ",e.jsx("span",{className:"text-slate-500",children:"(Optional)"})]}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:x,placeholder:"your@email.com",className:"w-full rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white placeholder-slate-500 transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:["Area / Locality ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",name:"area",value:t.area,onChange:x,placeholder:"e.g., T. Nagar, Anna Nagar",className:"w-full rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white placeholder-slate-500 transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:["Full Address ",e.jsx("span",{className:"text-slate-500",children:"(Optional)"})]}),e.jsx("textarea",{name:"address",value:t.address,onChange:x,placeholder:"Complete address for directions...",rows:2,className:"w-full resize-none rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white placeholder-slate-500 transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:"Number of People"}),e.jsxs("select",{name:"family_size",value:t.family_size,onChange:x,className:"w-full rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500",children:[e.jsx("option",{value:"1",children:"1 Person"}),e.jsx("option",{value:"2",children:"2 People"}),e.jsx("option",{value:"3",children:"3 People"}),e.jsx("option",{value:"4",children:"4 People"}),e.jsx("option",{value:"5+",children:"5+ People"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:["Days Needed ",e.jsx("span",{className:"text-slate-500",children:"(Optional)"})]}),e.jsx("input",{type:"text",name:"days_needed",value:t.days_needed,onChange:x,placeholder:"e.g., Entire Ramadan, or specific dates",className:"w-full rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white placeholder-slate-500 transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1.5 block text-sm font-medium text-slate-300",children:["Additional Message ",e.jsx("span",{className:"text-slate-500",children:"(Optional)"})]}),e.jsx("textarea",{name:"message",value:t.message,onChange:x,placeholder:"Any special requirements or notes...",rows:3,className:"w-full resize-none rounded-xl border border-slate-700 bg-slate-900/50 px-4 py-3 text-white placeholder-slate-500 transition-all outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500"})]}),e.jsx("button",{type:"submit",disabled:d,className:"w-full rounded-xl bg-amber-400 py-3.5 font-bold text-slate-900 transition-all hover:bg-amber-300 active:scale-[0.98] disabled:cursor-not-allowed disabled:bg-amber-400/50",children:d?"Submitting...":"Submit Request"})]})]})})]})}function De({message:s,onClose:l}){return s?e.jsxs("div",{className:"animate-in fade-in slide-in-from-top-10 fixed top-8 left-1/2 z-[200] flex -translate-x-1/2 items-center gap-3 rounded-full bg-slate-950 px-8 py-4 text-white shadow-2xl",children:[e.jsx(Be,{className:"text-emerald-400",size:18}),e.jsx("span",{className:"text-sm font-black tracking-tight",children:s}),e.jsx("button",{onClick:l,className:"text-slate-500 transition-colors hover:text-white",children:e.jsx(Z,{size:16})})]}):null}const he="ramzania_user_location";async function Qs(s,l){try{const i=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${l}&zoom=14&addressdetails=1`,{headers:{"Accept-Language":"en"}})).json();if(i&&i.address){const{suburb:d,neighbourhood:c,city:x,town:o,village:k,state_district:h,state:n,country:p}=i.address;return{raw:i,area:d||c||x||o||k||h||""||"Unknown Area",fullAddress:i.display_name||"",city:x||o||k||h||"",state:n||"",country:p||"",addressDetails:i.address}}return null}catch(t){return console.error("Reverse geocoding failed:",t),null}}function et(){const[s,l]=a.useState(null),[t,i]=a.useState(null),[d,c]=a.useState(!1),[x,o]=a.useState(null),[k,h]=a.useState("prompt");a.useEffect(()=>{navigator.permissions&&navigator.permissions.query({name:"geolocation"}).then(y=>{h(y.state),y.onchange=()=>{h(y.state)}})},[]),a.useEffect(()=>{const y=localStorage.getItem(he);if(y)try{const w=JSON.parse(y);w.lat&&w.lng&&l({lat:w.lat,lng:w.lng}),w.address&&i(w.address)}catch{localStorage.removeItem(he)}},[]),a.useEffect(()=>{k==="granted"&&!s&&p()},[k]);const n=a.useCallback((y,w)=>{l(y),i(w),localStorage.setItem(he,JSON.stringify({lat:y.lat,lng:y.lng,address:w,timestamp:Date.now()}))},[]),p=a.useCallback(async()=>{if(!navigator.geolocation){o("Geolocation is not supported");return}c(!0),o(null),navigator.geolocation.getCurrentPosition(async y=>{const w={lat:y.coords.latitude,lng:y.coords.longitude},S=await Qs(w.lat,w.lng);n(w,S),c(!1)},y=>{y.code===y.PERMISSION_DENIED?(o("Location permission denied"),h("denied")):y.code===y.POSITION_UNAVAILABLE?o("Location unavailable"):y.code===y.TIMEOUT?o("Location request timed out"):o("Enable GPS to see distance"),c(!1)},{timeout:1e4,enableHighAccuracy:!0})},[n]),m=a.useCallback(()=>{p()},[p]),N=a.useCallback((y,w)=>{if(!s)return null;const S=6371,f=(y-s.lat)*Math.PI/180,F=(w-s.lng)*Math.PI/180,u=Math.sin(f/2)*Math.sin(f/2)+Math.cos(s.lat*Math.PI/180)*Math.cos(y*Math.PI/180)*Math.sin(F/2)*Math.sin(F/2),z=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u));return S*z},[s]),R=a.useCallback(()=>{l(null),i(null),localStorage.removeItem(he)},[]);return{location:s,address:t,isLocating:d,error:x,permissionStatus:k,requestLocation:m,calculateDistance:N,clearLocation:R}}const st=()=>new Date().toISOString().split("T")[0];function tt(){const[s,l]=a.useState([]),[t,i]=a.useState([]),[d,c]=a.useState([]),[x,o]=a.useState({sehar:"04:52 AM",iftar:"06:24 PM",area:"Chennai"}),[k,h]=a.useState(null),[n,p]=a.useState(!0),[m,N]=a.useState(null),[R,y]=a.useState([]),[w,S]=a.useState({area:"",place:""}),f=a.useRef(!1),F=a.useCallback(async(A={})=>{var D;try{const O=await se.fetchPoints(A);l(O.providers||[]),y(((D=O.filters)==null?void 0:D.areas)||[])}catch(O){console.error("Failed to fetch offerings:",O)}},[]),u=a.useCallback(async(A={})=>{var D;p(!0),N(null);try{const O=await se.fetchPoints(A);l(O.providers||[]),y(((D=O.filters)==null?void 0:D.areas)||[]),p(!1),Promise.all([se.fetchDuas(),se.fetchEvents(),se.fetchTimings(),se.fetchRamzanTimings(null,st())]).then(([E,M,B,T])=>{i(E),c(M),o(B),T.success&&T.timing&&h(T.timing)}).catch(E=>{console.error("Failed to fetch secondary data:",E)})}catch(O){N(O.message||"Failed to fetch data"),p(!1)}},[]);a.useEffect(()=>{f.current||(f.current=!0,u())},[]);const z=a.useCallback(async A=>{S(A),await F(A)},[F]);return{points:s,duas:t,events:d,timings:x,ramzanTiming:k,loading:n,error:m,availableAreas:R,filters:w,refetch:()=>u(w),refetchWithFilters:z,setFilters:z}}const je="ramzania_user";function ct(){const[s,l]=a.useState(null),[t,i]=a.useState(!1),[d,c]=a.useState("home"),[x,o]=a.useState(null),[k,h]=a.useState(null),{points:n,timings:p,ramzanTiming:m,availableAreas:N,refetchWithFilters:R,loading:y}=tt(),{location:w,address:S,isLocating:f,requestLocation:F}=et();a.useEffect(()=>{const M=localStorage.getItem(je);if(M){const B=JSON.parse(M);l(B),c(B.role==="provider"?"dashboard":"home")}},[]);const u=M=>{l(M),localStorage.setItem(je,JSON.stringify(M)),i(!1),c(M.role==="provider"?"dashboard":"home")},z=()=>{localStorage.removeItem(je),l(null),c("home")},A=M=>{h(M),o(null)},D=M=>{c(M)},O=["home","request","join"].includes(d)&&(s==null?void 0:s.role)!=="provider",E=()=>{if((s==null?void 0:s.role)==="provider")switch(d){case"settings":return e.jsx(Bs,{user:s,onUserUpdate:u});case"dashboard":default:return e.jsx(Js,{user:s})}switch(d){case"find":return e.jsx(Ls,{timings:p,ramzanTiming:m,points:n,onBook:o,availableAreas:N,onFilterChange:R,loading:y});case"request":return e.jsx(Zs,{user:s,onNavigate:D});case"join":return e.jsx(Gs,{onNavigate:D,onSuccess:()=>c("home")});case"bookings":return e.jsx(Us,{});case"home":default:return e.jsx(Vs,{ramzanTiming:m,onNavigate:D,city:(S==null?void 0:S.city)||"Chennai"})}};return O?e.jsxs("div",{className:"min-h-screen bg-slate-950 font-sans",children:[e.jsx("main",{children:E()}),e.jsx(Ae,{activeView:d,onViewChange:c,userRole:s==null?void 0:s.role,user:s}),t&&e.jsx(Fe,{onClose:()=>i(!1),onSuccess:u}),x&&e.jsx(Pe,{point:x,user:s,userLocation:w,onClose:()=>o(null),onSuccess:A,onLoginClick:()=>{o(null),i(!0)}}),e.jsx(De,{message:k,onClose:()=>h(null)})]}):e.jsxs("div",{className:"min-h-screen bg-white pb-20 font-sans text-slate-900 selection:bg-emerald-100 sm:pb-16",children:[e.jsx(js,{user:s,onLogout:z,onJoinClick:()=>i(!0),address:S,isLocating:f,onRequestLocation:F}),e.jsx("main",{className:"mx-auto max-w-lg px-4 py-6 sm:max-w-2xl sm:px-6 sm:py-8",children:E()}),e.jsx(Ae,{activeView:d,onViewChange:c,userRole:s==null?void 0:s.role,user:s}),t&&e.jsx(Fe,{onClose:()=>i(!1),onSuccess:u}),x&&e.jsx(Pe,{point:x,user:s,userLocation:w,onClose:()=>o(null),onSuccess:A,onLoginClick:()=>{o(null),i(!0)}}),e.jsx(De,{message:k,onClose:()=>h(null)})]})}export{ct as default};
